{# TODO documentation #}

{% from "macros/global.html" import T, IF, IFNOT, END with context %}
{% import "macros/utils.html" as utils with context %}



{% set version %}
  <div class="card-description-ver">JP Mining Note: Version {{ VERSION }}</div>
{% endset %}

{% set info_circle %}
  <span class="info-circle" id="info_circle">
    <span class="info-circle-svg-wrapper">
      <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" class="bi bi-info-circle" viewBox="0 0 16 16">
        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
        <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
      </svg>
    </span>

    <span class="info-circle-text-wrapper">
      <span class="info-circle-text" id="info_circle_text">
        <div class="info-circle-text-error" id="info_circle_text_error"></div>
        <div class="info-circle-text-warning" id="info_circle_text_warning"></div>
        <div class="info-circle-text-leech" id="info_circle_text_leech"></div>
        <div class="info-circle-text-info" id="info_circle_text_info">
          <div>
            Need help? View the
            <a href="https://github.com/Aquafina-water-bottle/jp-mining-note/wiki">documentation</a>.
          </div>
          <div>
            Have an issue?
            <a href="https://github.com/Aquafina-water-bottle/jp-mining-note/issues">Report it here</a>.
          </div>
          <div>
            View the
            <a href="https://github.com/Aquafina-water-bottle/jp-mining-note">source code</a>.
          </div>
        </div>
      </span>
    </span>
  </span>
{% endset %}



{% set hint %}

{% call IF("HintNotHidden") %}
  <div class="center-box-1 hint">
    <div class="center-box-2">
      <div class="bold-yellow">{{ T("HintNotHidden") }}</div>
    </div>
  </div>
{% endcall %}

<!-- https://stackoverflow.com/questions/1269589/css-center-block-but-align-contents-to-the-left -->
<!-- tl;dr wrap anything you want centered + left justified with center-box-1 and center-box-2 -->
{% call IF("Hint") %}
  <details class="hint" id="hint_details">
    <summary>Hint</summary>
    <div class="center-box-1">
      <div class="center-box-2">
        <div class="bold-yellow">{{ T("Hint") }}</div>
      </div>
    </div>
  </details>
{% endcall %}

{% endset %}


{% set full_sentence_front %}
<details class="glossary-details" id="full_sentence_front_details">
  <summary>Full Sentence</summary>
  <div class="center-box-1">
    <div class="center-box-2">
      <div class="full-sentence bold-yellow" id="full_sentence_front">
        {{ T("furigana:SentenceReading") }}
      </div>
    </div>
  </div>
</details>
{% endset %}



{% set play_sentence_only_js %}

<script>
  // THIS IS A HACK to play sentence audio first and to not autoplay the word audio
  var elem = document.querySelector("#sentence-audio .soundLink, #sentence-audio .replaybutton");
  if (elem) {
    elem.click();
  }
</script>

{% endset %}



{% set play_silence_only_js %}

<script>
  // THIS IS A HACK: this hack is to not auto-play the audio at the front of the card
  // https://forums.ankiweb.net/t/disabling-audio-autoplay-for-certain-fields/6318/3
  // https://forums.ankiweb.net/t/controlling-display-and-function-of-audio-buttons/10234
  var elem = document.querySelector("#pa-silence-audio .soundLink, #pa-silence-audio .replaybutton");
  if (elem) {
    elem.click();
  }
</script>

{% endset %}


{% set sentence_audio_no_autoplay %}

<span id="pa-silence-audio" style="display:none">{{ T("PASilence") }}</span>

{% call IF("SentenceAudio") %}
  <span id="sentence-audio"> {{ T("SentenceAudio") }} </span>
{% endcall %}

{{ play_silence_only_js }}

{% endset %}









{% set answer_border %}
<center>
  <div class="answer-border"></div>
</center>
{% endset %}


{% set full_sentence %}
<div class="center-box-1">
  <div class="center-box-2">
    <div class="full-sentence bold-yellow" id="full_sentence">
      {{ T("furigana:SentenceReading") }}
    </div>
  </div>
</div>
{% endset %}


{% set primary_definition %}
<blockquote class="glossary-blockquote bold-yellow" id="primary_definition">
  <div class="glossary-text glossary-text--primary-definition">
    {{ T("furigana:PrimaryDefinition") }}
  </div>
</blockquote>
{% endset %}


{% set other_definitions %}
{% call IF("SecondaryDefinition") %}
  <details class="glossary-details" id="secondary_definition_details">
    <summary>Secondary Definition</summary>
    <blockquote class="glossary-blockquote bold-yellow">
      <div class="glossary-text glossary-text--secondary-definition">
        {{ T("SecondaryDefinition") }}
      </div>
    </blockquote>
  </details>
{% endcall %}
{% call IFNOT("SecondaryDefinition") %}
  <div class="glossary-details glossary-details--grey">
    Secondary Definition
  </div>
{% endcall %}


{% call IF("AdditionalNotes") %}
  <details class="glossary-details glossary-details--small" id="additional_notes_details">
    <summary>Additional Notes</summary>
    <blockquote class="glossary-blockquote glossary-blockquote--small bold-yellow">
      <div class="glossary-text glossary-text--additional-notes">
        {{ T("AdditionalNotes") }}
      </div>
    </blockquote>
  </details>
{% endcall %}
{% call IFNOT("AdditionalNotes") %}
  <div class="glossary-details glossary-details--small glossary-details--grey">
    Additional Notes
  </div>
{% endcall %}

{% call IF("ExtraDefinitions") %}
  <details class="glossary-details glossary-details--small" id="extra_definitions_details">
    <summary>Extra Definitions</summary>
    <blockquote class="glossary-blockquote glossary-blockquote--small bold-yellow">
      <div class="glossary-text glossary-text--extra-definitions">
        {{ T("ExtraDefinitions") }}
      </div>
    </blockquote>
  </details>
{% endcall %}
{% call IFNOT("ExtraDefinitions") %}
  <div class="glossary-details glossary-details--small glossary-details--grey">
    Extra Definitions
  </div>
{% endcall %}


{# not sure if I can optimize this away easily... #}
<div class="outer-display1
    {% call utils.none_of('PAGraphs', 'UtilityDictionaries') %}
      outer-display2
    {% endcall %}"
  id="Display">

  <!-- only showed if outer-display2 doesn't exist -->
  <details class="glossary-details glossary-details--small inner-display1" id="extra_info_details">
    <summary>Extra Info</summary>
    <blockquote class="glossary-blockquote glossary-blockquote--small bold-yellow">
      <div class="glossary-text glossary-text--extra-info">

        <div class="pa-graphs">
          {{ T("PAGraphs") }}
        </div>

        <div class="utility-dicts">
          {{ T("UtilityDictionaries") }}
        </div>

      </div>
    </blockquote>
  </details>

  <!-- only showed if outer-display2 exists -->
  <div class="glossary-details glossary-details--small glossary-details--grey inner-display2">
    Extra Info
  </div>

</div>

{% endset %}



{% set all_definitions %}
{{ primary_definition }}
{{ other_definitions }}
{% endset %}




{% macro def_header(border_class="", word_pitch_class="") %}

  <div class="def-header" id="def_header">

    <!-- everything on the left side -->
    {# border_class can be "dh-left--blue-border" #}
    <div class="dh-left {{ border_class }}" id="dh_left">

      <div class="dh-left__reading"> {{ T("furigana:WordReading") }} </div>

      {# word_pitch_class can be "dh-left__word-pitch--big" #}
      <div class="dh-left__word-pitch {{word_pitch_class}}" id="dh_word_pitch">
        {% call IF("WordPitch") %}
          {{ T("WordPitch") }}
        {% endcall %}
        {% call IFNOT("WordPitch") %}
          (N/A)
        {% endcall %}
      </div>

      <div class="dh-left__audio-buttons">
        <span id="word-audio"> {{ T("WordAudio") }} </span>
        <span id="sentence-audio"> {{ T("SentenceAudio") }} </span>
      </div>

    </div>

    <!-- everything on the right side -->
    {% call IF("Picture") %}
    <div class="dh-right" id="dh_right">
      <div class="dh-right__img-container" id="dh_img_container">{{ T("Picture") }}</div>
    </div>
    {% endcall %}

  </div>

{% endmacro %}





