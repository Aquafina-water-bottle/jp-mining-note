<!--
  Listening
  X / Y

  X:
    Word
    Sentence
    Hybrid

  Y:
    Legacy
    None
    Word
    Sentence
-->

{{MAIN_FRONT}}

{{HINT}}



<!-- regular display -->
<!-- displays the audio and show/hide button, used only when testing pitch accent -->
{{^PADoNotShowInfoLegacy}}

  {{^PADoNotTest}} {{^PASeparateWordCard}}

    <!-- if the display is a sentence but we only want to test word pitch accent -->
    {{#IsSentenceCard}}

      <!-- ankified `PASeparateSentenceCard or PATestOnlyWord` -->
      {{#PASeparateSentenceCard}} {{^PATestOnlyWord}}
        <button id="PAButton" oncontextmenu="event.preventDefault();" onclick="logMouseButton()">Show</button>
      {{/PATestOnlyWord}} {{/PASeparateSentenceCard}}
      {{^PASeparateSentenceCard}} {{#PATestOnlyWord}}
        <button id="PAButton" oncontextmenu="event.preventDefault();" onclick="logMouseButton()">Show</button>
      {{/PATestOnlyWord}} {{/PASeparateSentenceCard}}
      {{#PASeparateSentenceCard}} {{#PATestOnlyWord}}
        <button id="PAButton" oncontextmenu="event.preventDefault();" onclick="logMouseButton()">Show</button>
      {{/PATestOnlyWord}} {{/PASeparateSentenceCard}}

      <!-- script here because too lazy to copy/paste -->
      <!-- https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button -->
      <script>
        var paButton = document.getElementById("PAButton");
        var d = document.getElementById("Display");

        function logMouseButton() {
          if (paButton.innerText == "Show") {
            paButton.innerText = "Hide";
            d.classList.add("bold-yellow");
          } else {
            paButton.innerText = "Show";
            d.classList = "expression";
          }
        }
      </script>

    {{/IsSentenceCard}}

  {{/PASeparateWordCard}} {{/PADoNotTest}}


  <!--
    if the display is a word: show sentence preview (spoilered)
  -->
  {{^IsSentenceCard}} {{^IsFallbackCard}} {{^IsTargetedContextCard}} {{^IsHybridCard}}
    {{FULL_SENTENCE_FRONT}}
  {{/IsHybridCard}} {{/IsTargetedContextCard}} {{/IsFallbackCard}} {{/IsSentenceCard}}


  <!-- we include the audio at the front regardless if we test PA or not -->
  <script>
    // =====================
    //  THIS PART IS A HACK
    // =====================
    // this hack is to not auto-play the audio at the front of the card
    // https://forums.ankiweb.net/t/disabling-audio-autoplay-for-certain-fields/6318/3
    // https://forums.ankiweb.net/t/controlling-display-and-function-of-audio-buttons/10234
    var elem = document.querySelector(".soundLink, .replaybutton");
    if (elem) {
      elem.click();
    }
  </script>

  <span id="audio-front-silence" style="display:none">{{PASilence}}</span>
  <span id="audio-front">
    {{#SentenceAudio}}
      {{SentenceAudio}}
    {{/SentenceAudio}}
    {{^SentenceAudio}}
      {{WordAudio}}
    {{/SentenceAudio}}
  </span>


{{/PADoNotShowInfoLegacy}}



<script>
  // Javascript to have hybrid cards show the sentence with "shift"
  // For some reason, this only works on the first document shown (upon javascript refresh).
  // Therefore, this is not included in the backside html;
  // the full sentence is already shown at the back side.
  document.addEventListener("keyup", e => {
    var hSent = document.getElementById("hybrid-sentence");
    var hWord = document.getElementById("hybrid-word");

    if (hSent && hWord) {
      if (e.shiftKey) {
        // if it contains an override value, that means shift has been pressed
        if (hSent.classList.contains("override-display-inline-block")) {
          hWord.classList.remove("override-display-none");
          hSent.classList.remove("override-display-inline-block");
        } else {
          hWord.classList.add("override-display-none");
          hSent.classList.add("override-display-inline-block");
        }
      }
    }
  })
</script>

