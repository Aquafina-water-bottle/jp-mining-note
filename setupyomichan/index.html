
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the jp-mining-note project.">
      
      
      
        <link rel="canonical" href="https://aquafina-water-bottle.github.io/jp-mining-note-prerelease/setupyomichan/">
      
      
        <link rel="prev" href="../setupanki/">
      
      
        <link rel="next" href="../setuptextmedia/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.9">
    
    
      
        <title>Setup: Yomichan - jp-mining-note</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            

<b class="jpmn-highlight">WARNING</b>: This documentation is for the latest pre-release version of jp-mining-note, and is very WIP / incomplete. <br>
If you are looking for the stable release documentation, see <a href="https://aquafina-water-bottle.github.io/jp-mining-note/">here</a>.


          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="jp-mining-note" class="md-header__button md-logo" aria-label="jp-mining-note" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jp-mining-note
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Setup: Yomichan
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Aquafina-water-bottle/jp-mining-note" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    jp-mining-note
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../setup/" class="md-tabs__link md-tabs__link--active">
        Setup
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../updating/" class="md-tabs__link">
        Updating
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../quickstart/" class="md-tabs__link">
        Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../modding/" class="md-tabs__link">
        Dev Docs
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../faq/" class="md-tabs__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../jpresources/" class="md-tabs__link">
        JP Resources
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="jp-mining-note" class="md-nav__button md-logo" aria-label="jp-mining-note" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    jp-mining-note
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Aquafina-water-bottle/jp-mining-note" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    jp-mining-note
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
      
      
      
        <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../preface/" class="md-nav__link">
        Preface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../principles/" class="md-nav__link">
        Philosophy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../alternatives/" class="md-nav__link">
        Alternatives
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        Setup: Installing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupanki/" class="md-nav__link">
        Setup: Anki
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Setup: Yomichan
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Setup: Yomichan
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preliminary-steps" class="md-nav__link">
    Preliminary Steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yomichan-fields" class="md-nav__link">
    Yomichan Fields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yomichan-templates" class="md-nav__link">
    Yomichan Templates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#make-an-example-card" class="md-nav__link">
    Make an example card!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yomichan-templates-options-summary" class="md-nav__link">
    Yomichan Templates Options Summary
  </a>
  
    <nav class="md-nav" aria-label="Yomichan Templates Options Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monolingual-definition" class="md-nav__link">
    Monolingual Definition
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enjoy-your-new-one-click-cards" class="md-nav__link">
    Enjoy your new one-click cards!
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setuptextmedia/" class="md-nav__link">
        Setup: Text & Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
      
      
      
        <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
          Text & Media
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Text & Media
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupmpvacious/" class="md-nav__link">
        mpvacious (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupasbplayer/" class="md-nav__link">
        asbplayer (TODO)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          Extra Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Extra Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupextrayomichan/" class="md-nav__link">
        Extra: Yomichan
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupextraanki/" class="md-nav__link">
        Extra: Anki
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupandroid/" class="md-nav__link">
        Extra: Android
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupios/" class="md-nav__link">
        Extra: iOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupereaders/" class="md-nav__link">
        Extra: eReaders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../importing/" class="md-nav__link">
        Transfer Existing Notes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
          Alternate Card Exporters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Alternate Card Exporters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupjl/" class="md-nav__link">
        JL (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupjidoujisho/" class="md-nav__link">
        jidoujisho (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupgoldendict/" class="md-nav__link">
        goldendict (TODO)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Updating
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Updating
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updating/" class="md-nav__link">
        Updating: Overview (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updatingjpmn/" class="md-nav__link">
        Updating: JPMN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updatingyomichan/" class="md-nav__link">
        Updating: Yomichan
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupchanges/" class="md-nav__link">
        Setup Changes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updatingfinalsteps/" class="md-nav__link">
        Final Steps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/Aquafina-water-bottle/jp-mining-note/blob/dev/CHANGELOG.md" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        Quick Start (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../blockquotes/" class="md-nav__link">
        Blockquotes (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../definitions/" class="md-nav__link">
        Definitions (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sentences/" class="md-nav__link">
        Sentences (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cardtypes/" class="md-nav__link">
        Card Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../changingcardtype/" class="md-nav__link">
        Changing Card Type (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cardtypes2/" class="md-nav__link">
        More on Card Types (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../keybinds/" class="md-nav__link">
        Keybinds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../images/" class="md-nav__link">
        Images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../autopa/" class="md-nav__link">
        Pitch Accent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kanjihover/" class="md-nav__link">
        Kanji Hover (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wordindicators/" class="md-nav__link">
        Word Indicators (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tooltipresults/" class="md-nav__link">
        Tooltip Results (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../infocircle/" class="md-nav__link">
        Info Circle (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../frequencies/" class="md-nav__link">
        Frequencies (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../externallinks/" class="md-nav__link">
        External Links (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fields/" class="md-nav__link">
        Fields (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backfilling/" class="md-nav__link">
        Backfilling (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../batch/" class="md-nav__link">
        Batch Commands (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../other/" class="md-nav__link">
        Other (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_21" >
      
      
      
        <label class="md-nav__link" for="__nav_4_21" id="__nav_4_21_label" tabindex="0">
          Options
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_21_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_21">
          <span class="md-nav__icon md-icon"></span>
          Options
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runtimeoptions/" class="md-nav__link">
        Runtime Options (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../compiletimeoptions/" class="md-nav__link">
        Compile-Time Options (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../yomichantemplates/" class="md-nav__link">
        Yomichan Template Options (TODO)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Dev Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Dev Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modding/" class="md-nav__link">
        Modding Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../building/" class="md-nav__link">
        Building
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../customcss/" class="md-nav__link">
        Custom CSS (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overrides/" class="md-nav__link">
        Custom HTML (Overrides) (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/" class="md-nav__link">
        Custom JS (Modules) (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../themes/" class="md-nav__link">
        Themes (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../moddingtips/" class="md-nav__link">
        Tips & Tricks (TODO)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          FAQ & Troubleshooting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          FAQ & Troubleshooting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/#errors-warnings" class="md-nav__link">
        FAQ: Errors & Warnings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/#troubleshooting" class="md-nav__link">
        FAQ: Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/#card-editing" class="md-nav__link">
        FAQ: Card Editing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/#other-questions" class="md-nav__link">
        FAQ: Other
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          JP Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          JP Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jpresources/" class="md-nav__link">
        JP Resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jpmnhandlebars/" class="md-nav__link">
        JPMN Handlebars Package
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scripts/" class="md-nav__link">
        Anki Scripts (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jpresourcesother/" class="md-nav__link">
        Other
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preliminary-steps" class="md-nav__link">
    Preliminary Steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yomichan-fields" class="md-nav__link">
    Yomichan Fields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yomichan-templates" class="md-nav__link">
    Yomichan Templates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#make-an-example-card" class="md-nav__link">
    Make an example card!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yomichan-templates-options-summary" class="md-nav__link">
    Yomichan Templates Options Summary
  </a>
  
    <nav class="md-nav" aria-label="Yomichan Templates Options Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monolingual-definition" class="md-nav__link">
    Monolingual Definition
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enjoy-your-new-one-click-cards" class="md-nav__link">
    Enjoy your new one-click cards!
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  
    
      
    
    <a href="https://github.com/Aquafina-water-bottle/jp-mining-note/raw/dev/docs/docs/setupyomichan.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>Setup: Yomichan</h1>

<div><h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">¶</a></h2>
<p><a href="https://github.com/FooSoft/yomichan">Yomichan</a>
is the main program that will create the cards. You can download Yomichan as a Firefox extension
or under the Chrome web store.</p>
<p>This section will go over the minimal Yomichan setup to work with this card type.</p>
<p><strong>If you have never used Yomichan before, please see
<a href="https://learnjapanese.moe/yomichan/">this page</a> first to get it working.</strong></p>
<hr>
<h2 id="preliminary-steps">Preliminary Steps<a class="headerlink" href="#preliminary-steps" title="Permanent link">¶</a></h2>
<p>If you have used Yomichan before, please make a
<a href="../faq/#how-do-i-backup-yomichan-settings">backup of your settings</a>
(just in case).</p>
<!--
Additionally, if you downloaded Yomichan from a file, try updating that as well.
Most users should have installed it from their browser's extension page, in which case
nothing has to be done.

!!! warning "Warning for Firefox Users"
    The default version for Yomichan on Firefox
    is [over three years old](https://github.com/FooSoft/yomichan/issues/2295),
    and is not compatible with this note.
    If you are using Firefox, ensure that your Yomichan version is indeed the latest version,
    by clicking on the Yomichan icon and clicking on the question mark.

    If it isn't, you will have to download it
    [manually](https://github.com/FooSoft/yomichan/releases/tag/22.10.23.0)
    (use `a708116f79104891acbd-22.10.23.0.xpi`).

-->

<hr>
<h2 id="yomichan-fields">Yomichan Fields<a class="headerlink" href="#yomichan-fields" title="Permanent link">¶</a></h2>
<p>To edit the fields that Yomichan will automatically fill out, do the following:</p>
<p><div class="video-container"><video style="width:100%;height:100%" controls alt="type:video"><source src="../assets/setupyomichan/yomichan_anki_format.mp4" type="video/mp4"></source></video></div></p>
<ol>
<li>Navigate to Yomichan Settings.</li>
<li>Go to the <code>Anki</code> section.</li>
<li>Select <code>Anki card format...</code>.</li>
<li>Set "Model" as <code>JP Mining Note</code>.</li>
<li>Copy and paste the following values into the fields
   (the custom markers won't be available in the dropdown arrow):</li>
</ol>
<details class="example">
<summary>Click here to see the fields to copy and paste.</summary>
<table>
<thead>
<tr>
<th>Anki Fields</th>
<th>Yomichan Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="smaller-table-row">Key</td>
<td class="smaller-table-row"><code>{expression}</code></td>
</tr>
<tr>
<td class="smaller-table-row">Word</td>
<td class="smaller-table-row"><code>{expression}</code></td>
</tr>
<tr>
<td class="smaller-table-row">WordReading</td>
<td class="smaller-table-row"><code>{furigana-plain}</code></td>
</tr>
<tr>
<td class="smaller-table-row">PAOverride</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">PAOverrideText</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">AJTWordPitch</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">PrimaryDefinition</td>
<td class="smaller-table-row"><code>{jpmn-primary-definition}</code></td>
</tr>
<tr>
<td class="smaller-table-row">PrimaryDefinitionPicture</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">Sentence</td>
<td class="smaller-table-row"><code>{cloze-prefix}&lt;b&gt;{cloze-body}&lt;/b&gt;{cloze-suffix}</code></td>
</tr>
<tr>
<td class="smaller-table-row">SentenceReading</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">AltDisplayWord</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">AltDisplaySentence</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">AltDisplayPASentenceCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">AltDisplayAudioCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">AdditionalNotes</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">Hint</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">HintNotHidden</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*IsSentenceCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*IsTargetedSentenceCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*IsClickCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*IsHoverCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*IsHintCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*IsSentenceFirstCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*IsAudioCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*PAShowInfo</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*PATestOnlyWord</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*PADoNotTest</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*PASeparateWordCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*PASeparateSentenceCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*SeparateAudioCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">*SeparateSentenceAudioCard</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">Picture</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">WordAudio</td>
<td class="smaller-table-row"><code>{audio}</code></td>
</tr>
<tr>
<td class="smaller-table-row">SentenceAudio</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">PAGraphs</td>
<td class="smaller-table-row"><code>{jpmn-pitch-accent-graphs}</code></td>
</tr>
<tr>
<td class="smaller-table-row">PAPositions</td>
<td class="smaller-table-row"><code>{jpmn-pitch-accent-positions}</code></td>
</tr>
<tr>
<td class="smaller-table-row">FrequenciesStylized</td>
<td class="smaller-table-row"><code>{jpmn-frequencies}</code></td>
</tr>
<tr>
<td class="smaller-table-row">FrequencySort</td>
<td class="smaller-table-row"><code>{jpmn-frequency-sort}</code></td>
</tr>
<tr>
<td class="smaller-table-row">PASilence</td>
<td class="smaller-table-row"><code>[sound:_silence.wav]</code></td>
</tr>
<tr>
<td class="smaller-table-row">WordReadingHiragana</td>
<td class="smaller-table-row"><code>{jpmn-word-reading-hiragana}</code></td>
</tr>
<tr>
<td class="smaller-table-row">YomichanWordTags</td>
<td class="smaller-table-row"><code>{tags}</code></td>
</tr>
<tr>
<td class="smaller-table-row">SecondaryDefinition</td>
<td class="smaller-table-row"><code>{jpmn-secondary-definition}</code></td>
</tr>
<tr>
<td class="smaller-table-row">ExtraDefinitions</td>
<td class="smaller-table-row"><code>{jpmn-extra-definitions}</code></td>
</tr>
<tr>
<td class="smaller-table-row">UtilityDictionaries</td>
<td class="smaller-table-row"><code>{jpmn-utility-dictionaries}</code></td>
</tr>
<tr>
<td class="smaller-table-row">CardCache</td>
<td></td>
</tr>
<tr>
<td class="smaller-table-row">Comment</td>
<td></td>
</tr>
</tbody>
</table>
</details>
<p>The above fields will create, by default,
a basic <strong>vocab card</strong> in <strong>bilingual format</strong>,
with all other definitions in collapsable fields.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Anything field marked with <code>*</code> are binary fields, and
<strong>should be configured to each user's personal preferences.</strong></p>
<p>To change the default value of any of the fields, simply fill
the field in within the aforementioned <code>Anki card format...</code> section.</p>
<p>For example, if you want the card to be a sentence card by default,
fill the <code>IsSentenceCard</code> field here.</p>
</div>
<p>The custom markers like <code>{jpmn-primary-definition}</code> is not provided by Yomichan by default.
See the section below to make these markers usable.</p>
<hr>
<h2 id="yomichan-templates">Yomichan Templates<a class="headerlink" href="#yomichan-templates" title="Permanent link">¶</a></h2>
<p>Yomichan supports user inserted template code that allows the automatic
separation of bilingual and monolingual dictionary definitions, custom stylization, etc.
This note type makes heavy use of these custom templates.</p>
<p>To make the new markers usable, do the following:</p>
<p><div class="video-container"><video style="width:100%;height:100%" controls alt="type:video"><source src="../assets/setupyomichan/import_yomichan_templates.mp4" type="video/mp4"></source></video></div></p>
<ol>
<li>Navigate to Yomichan Settings.</li>
<li>Make sure that advanced settings are turned on (bottom left corner).</li>
<li>Go to the <code>Anki</code> section</li>
<li>Select <code>Configure Anki card templates...</code></li>
<li>If you have existing template code already, I highly recommend
   <strong>resetting the templates</strong> (bottom right corner, red button)
   unless you know exactly what you are doing.</li>
</ol>
<p>After resetting the templates,
<strong>without</strong> removing any of the existing template code,
add the following template code as follows:</p>
<ol>
<li>
<p>Copy and paste the code below to the <strong>top</strong> of the default Yomichan template code:</p>
<details class="examplecode">
<summary>Click here to show the template code to copy.</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>                                                                      <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="na">===================</span><span class="o">=</span> <span class="nv">jp-mining-note</span> <span class="nv">handlebars</span> <span class="na">====================</span><span class="o">=</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>                               <span class="nv">v1.0.6</span>                                 <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>                                                                      <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>       <span class="nv">https</span><span class="err">:</span><span class="nv">//aquafina-water-bottle.github.io/jp-mining-note/</span>        <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>       <span class="err">-------------------------------------------------------</span>        <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="na">===============</span><span class="o">=</span> <span class="nv">Dictionary</span> <span class="nv">Categorization</span> <span class="nv">Options</span> <span class="na">================</span><span class="o">=</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">valid</span> <span class="nv">values</span><span class="err">:</span> <span class="s2">"bilingual"</span><span class="err">,</span> <span class="s2">"monolingual"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-first-definition-type"</span> <span class="s2">"bilingual"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">matches</span> <span class="nv">most</span> <span class="nv">JMdict</span> <span class="nv">dictionaries</span><span class="err">,</span> <span class="err">新和英</span> <span class="nv">and</span> <span class="err">日本語文法辞典</span><span class="nv">(全集)</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"bilingual-dict-regex"</span><span class="m">~</span><span class="cp">}}</span><span class="x"> ^(([Jj][Mm][Dd]ict)(.*)|新和英|日本語文法辞典\(全集\)|KireiCake|NEW斎藤和英大辞典|ADD_BILINGUAL_DICTIONARIES_HERE)$ </span><span class="cp">{{</span><span class="m m-Attribute">~/set~</span><span class="cp">}}</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"utility-dict-regex"</span><span class="m">~</span><span class="cp">}}</span><span class="x"> ^(NHK日本語発音アクセント新辞典|シン・漢字遣い参考|[Jj][Mm][Dd]ict( Surface)? Forms|JMedict)$ </span><span class="cp">{{</span><span class="m m-Attribute">~/set~</span><span class="cp">}}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"ignored-dict-regex"</span><span class="m">~</span><span class="cp">}}</span><span class="x"> ^(ADD_IGNORED_DICTIONARIES_HERE)$ </span><span class="cp">{{</span><span class="m m-Attribute">~/set~</span><span class="cp">}}</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="na">=====================</span><span class="o">=</span> <span class="nv">Selected</span> <span class="nv">Text</span> <span class="nv">Options</span> <span class="na">======================</span><span class="o">=</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="cp">{{</span><span class="nv">set</span> <span class="s2">"opt-selection-text-enabled"</span>               <span class="nv">true</span><span class="cp">}}</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="cp">{{</span><span class="nv">set</span> <span class="s2">"opt-selection-text-dictionary"</span>            <span class="nv">true</span><span class="cp">}}</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="cp">{{</span><span class="nv">set</span> <span class="s2">"opt-selection-text-glossary"</span>              <span class="nv">true</span><span class="cp">}}</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="cp">{{</span><span class="nv">set</span> <span class="s2">"opt-selection-text-glossary-attempt-bold"</span> <span class="nv">true</span><span class="cp">}}</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="na">===================</span><span class="o">=</span> <span class="nv">Frequency</span> <span class="nv">Sorting</span> <span class="nv">Options</span> <span class="na">====================</span><span class="o">=</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">See</span> <span class="nv">here</span> <span class="nv">for</span> <span class="nv">the</span> <span class="nv">official</span> <span class="nv">documentation</span> <span class="nv">on</span> <span class="nv">how</span> <span class="nv">these</span> <span class="nv">options</span> <span class="nv">work</span><span class="err">:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="nv">https</span><span class="err">:</span><span class="nv">//github.com/MarvNC/JP-Resources</span><span class="err">#</span><span class="nv">freq-settings</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"opt-ignored-freq-dict-regex"</span><span class="m">~</span><span class="cp">}}</span><span class="x"> ^(JLPT_Level)$ </span><span class="cp">{{</span><span class="m m-Attribute">~/set~</span><span class="cp">}}</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"opt-ignored-freq-value-regex"</span><span class="m">~</span><span class="cp">}}</span><span class="x"> ❌ </span><span class="cp">{{</span><span class="m m-Attribute">~/set~</span><span class="cp">}}</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"opt-keep-freqs-past-first-regex"</span><span class="m">~</span><span class="cp">}}</span><span class="x"> ^()$ </span><span class="cp">{{</span><span class="m m-Attribute">~/set~</span><span class="cp">}}</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-no-freq-default-value"</span> <span class="m">9999999</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-freq-sorting-method"</span> <span class="s2">"harmonic"</span> <span class="m">~</span><span class="cp">}}</span><span class="x"> </span><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="s2">"min"</span><span class="err">,</span> <span class="s2">"first"</span><span class="err">,</span> <span class="s2">"avg"</span><span class="err">,</span> <span class="s2">"harmonic"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-grammar-override"</span> <span class="nv">true</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-grammar-override-value"</span> <span class="m">0</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"opt-grammar-override-dict-regex"</span><span class="m">~</span><span class="cp">}}</span><span class="x"> ^(日本語文法辞典\(全集\)|毎日のんびり日本語教師|JLPT文法解説まとめ|どんなときどう使う 日本語表現文型辞典|絵でわかる日本語)$ </span><span class="cp">{{</span><span class="m m-Attribute">~/set~</span><span class="cp">}}</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="na">=============</span><span class="o">=</span> <span class="nv">Dictionary</span> <span class="nv">First</span> <span class="nv">Line</span> <span class="nv">Removal</span> <span class="nv">Options</span> <span class="na">==============</span><span class="o">=</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-wrap-first-line-spans"</span> <span class="nv">true</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">valid</span> <span class="nv">values</span><span class="err">:</span> <span class="s2">"except"</span><span class="err">,</span> <span class="s2">"only"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-first-line-regex-mode"</span> <span class="s2">"except"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"opt-first-line-dicts-regex"</span><span class="m">~</span><span class="cp">}}</span><span class="x"> ^(JMdict.*|Nico/Pixiv)$ </span><span class="cp">{{</span><span class="m m-Attribute">~/set~</span><span class="cp">}}</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="na">=========================</span><span class="o">=</span> <span class="nv">Other</span> <span class="nv">Options</span> <span class="na">==========================</span><span class="o">=</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-primary-def-one-dict-entry-only"</span> <span class="nv">false</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-jmdict-list-format"</span> <span class="nv">true</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="na">=======================</span><span class="o">=</span> <span class="nv">Plaintext</span> <span class="nv">Options</span> <span class="na">========================</span><span class="o">=</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>    <span class="nv">WARNING</span><span class="err">:</span> <span class="nv">I</span> <span class="nv">recommend</span> <span class="nv">not</span> <span class="nv">changing</span> <span class="nv">these</span> <span class="nv">options</span> <span class="nv">if</span> <span class="nv">you</span> <span class="nv">are</span> <span class="nv">using</span> <span class="nv">the</span>
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>    <span class="nv">jp-mining-note</span> <span class="nv">template</span><span class="err">.</span> <span class="nv">These</span> <span class="nv">options</span> <span class="nv">will</span> <span class="nv">change</span> <span class="nv">the</span> <span class="nv">general</span> <span class="nv">layout</span>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>    <span class="nv">of</span> <span class="nv">the</span> <span class="nv">HTML</span><span class="err">,</span> <span class="nv">which</span> <span class="nv">will</span> <span class="nv">prevent</span> <span class="nv">certain</span> <span class="nv">features</span> <span class="nv">or</span> <span class="nv">stylizations</span>
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>    <span class="nv">from</span> <span class="nv">properly</span> <span class="nv">working</span><span class="err">.</span> <span class="nv">(If</span> <span class="nv">you</span> <span class="nv">aren</span><span class="err">'</span><span class="nv">t</span> <span class="nv">using</span> <span class="nv">jp-mining-note</span><span class="err">,</span> <span class="nv">please</span> <span class="nv">feel</span>
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>    <span class="nv">free</span> <span class="nv">to</span> <span class="nv">change</span> <span class="nv">these</span> <span class="nv">options</span><span class="err">!</span><span class="nv">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>    <span class="nv">Instead</span> <span class="nv">of</span> <span class="nv">using</span> <span class="nv">these</span> <span class="nv">options</span><span class="err">,</span> <span class="nv">see</span> <span class="nv">here</span><span class="err">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>        <span class="nv">https</span><span class="err">:</span><span class="nv">//aquafina-water-bottle.github.io/jp-mining-note/definitions/</span>
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>    <span class="nv">These</span> <span class="nv">hide</span> <span class="nv">specific</span> <span class="nv">elements</span> <span class="nv">using</span> <span class="nv">CSS</span> <span class="nv">instead</span> <span class="nv">of</span> <span class="nv">modifying</span> <span class="nv">the</span> <span class="nv">raw</span> <span class="nv">HTML</span>
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>    <span class="nv">structure</span> <span class="nv">behind</span> <span class="nv">it</span><span class="err">.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt__plaintext__enabled"</span>                     <span class="nv">false</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt__plaintext__one-dict-entry-only-no-list"</span> <span class="nv">false</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt__plaintext__remove-dictionary-tag"</span>       <span class="nv">false</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt__plaintext__remove-first-line-enabled"</span>   <span class="nv">false</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="na">=============</span><span class="o">=</span> <span class="nv">ORIGINAL</span> <span class="nv">YOMICHAN</span> <span class="nv">TEMPLATE</span> <span class="nv">CODE</span> <span class="nv">BELOW</span> <span class="na">=============</span><span class="o">=</span> <span class="m">~</span><span class="cp">}}</span>
</code></pre></div>
</details>
</li>
<li>
<p>Copy and paste the code below to the <strong>bottom</strong> of the default Yomichan template code:</p>
<details class="examplecode">
<summary>Click here to show the template code to copy.</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="na">=============</span><span class="o">=</span> <span class="nv">ORIGINAL</span> <span class="nv">YOMICHAN</span> <span class="nv">TEMPLATE</span> <span class="nv">CODE</span> <span class="nv">ABOVE</span> <span class="na">==============</span><span class="o">=</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>                               <span class="nv">v1.0.6</span>                                 <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="na">=================</span><span class="o">=</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>     <span class="nv">helper</span> <span class="nv">functions</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="na">=================</span><span class="o">=</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="cp">{{</span><span class="m m-Attribute">#*inline</span> <span class="s2">"s"</span><span class="cp">}}{{</span><span class="m m-Attribute">/inline</span><span class="cp">}}</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">categorizes</span> <span class="nv">into</span> <span class="m">4</span> <span class="nv">types</span><span class="err">:</span> <span class="s2">"ignored"</span><span class="err">,</span> <span class="s2">"bilingual"</span><span class="err">,</span> <span class="s2">"utility"</span><span class="err">,</span> <span class="nv">or</span> <span class="s2">"monolingual"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="cp">{{</span><span class="m m-Attribute">~#*inline</span> <span class="s2">"jpmn-get-dict-type"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"rx-match-ignored"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#regexMatch</span> <span class="nv">(get</span> <span class="s2">"ignored-dict-regex"</span><span class="nv">)</span> <span class="s2">"gu"</span><span class="m">~</span><span class="cp">}}{{</span><span class="nv">dictionaryName</span><span class="cp">}}{{</span><span class="m m-Attribute">~/regexMatch~</span><span class="cp">}}</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"rx-match-utility"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#regexMatch</span> <span class="nv">(get</span> <span class="s2">"utility-dict-regex"</span><span class="nv">)</span> <span class="s2">"gu"</span><span class="m">~</span><span class="cp">}}{{</span><span class="nv">dictionaryName</span><span class="cp">}}{{</span><span class="m m-Attribute">~/regexMatch~</span><span class="cp">}}</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"rx-match-bilingual"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#regexMatch</span> <span class="nv">(get</span> <span class="s2">"bilingual-dict-regex"</span><span class="nv">)</span> <span class="s2">"gu"</span><span class="m">~</span><span class="cp">}}{{</span><span class="nv">dictionaryName</span><span class="cp">}}{{</span><span class="m m-Attribute">~/regexMatch~</span><span class="cp">}}</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="na">"!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-ignored</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="s2">            ignored</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="s2">        {{~else if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-utility</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="s2">            utility</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="s2">        {{~else if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-bilingual</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="s2">            bilingual</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="s2">        {{~else~}}</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="s2">            {{~! assumed that anything else is a monolingual dictionary ~}}</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="s2">            monolingual</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="s2">{{~! returns "" if selection text is disabled, or if none existed in the first place ~}}</span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-selection-text</span><span class="s2">"~}}</span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="s2">    {{~! text-mode != "" and text-mode &gt; 0 ~}}</span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="s2">    {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-selection-text-enabled</span><span class="s2">") true)~}}</span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a><span class="s2">        {{~! removes leading and trailing whitespace ~}}</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a><span class="s2">        {{~#regexReplace "</span><span class="err">^\</span><span class="nv">s</span><span class="err">+|\</span><span class="nv">s</span><span class="err">+$</span><span class="s2">" "" "</span><span class="nv">g</span><span class="s2">"~}}</span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="s2">            {{~#getMedia "</span><span class="nv">selectionText</span><span class="s2">"}}{{/getMedia~}}</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="s2">        {{~/regexReplace~}}</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="s2">    {{~/if~}}</span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="s2">{{~! checks that the selection text is indeed a dictionary (returns the text if true, nothing if false) ~}}</span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-check-dictionary</span><span class="s2">"~}}</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a><span class="s2">        {{~#set "</span><span class="nv">selection-is-dictionary</span><span class="s2">" false}}{{/set~}}</span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a><span class="s2">        {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="s2">            {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">selection</span><span class="s2">") dictionary)~}}</span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="s2">                {{~#set "</span><span class="nv">selection-is-dictionary</span><span class="s2">" true ~}}{{~/set~}}</span>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a><span class="s2">        {{~/each~}}</span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">selection-is-dictionary</span><span class="s2">") true)~}}</span>
<a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a><span class="s2">            {{~get "</span><span class="nv">selection</span><span class="s2">"~}}</span>
<a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a><span class="s2">        {{~else~}}</span>
<a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a><span class="s2">            {{~! null ~}}</span>
<a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a>
<a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a>
<a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a>
<a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a><span class="s2">{{~! gives the raw glossary as the search string (for searching to see if the selected text</span>
<a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a><span class="s2">is a part of a dictionary) ~}}</span>
<a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a><span class="s2">{{#*inline "</span><span class="err">_</span><span class="nv">jpmn-glossary-single-search</span><span class="s2">"}}</span>
<a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a>
<a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a><span class="s2">        {{~#each glossary}}{{#formatGlossary ../dictionary}}{{{.}}}{{/formatGlossary}}{{#unless @last}} | {{/unless}}{{/each~}}</span>
<a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-83" name="__codelineno-1-83" href="#__codelineno-1-83"></a>
<a id="__codelineno-1-84" name="__codelineno-1-84" href="#__codelineno-1-84"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-85" name="__codelineno-1-85" href="#__codelineno-1-85"></a>
<a id="__codelineno-1-86" name="__codelineno-1-86" href="#__codelineno-1-86"></a>
<a id="__codelineno-1-87" name="__codelineno-1-87" href="#__codelineno-1-87"></a>
<a id="__codelineno-1-88" name="__codelineno-1-88" href="#__codelineno-1-88"></a><span class="s2">{{~! escape a regex string: https://stackoverflow.com/a/6969486~}}</span>
<a id="__codelineno-1-89" name="__codelineno-1-89" href="#__codelineno-1-89"></a><span class="s2">{{~! /[.*+?^${}()|[\]\\]/g, '\\$&amp;' ~}}</span>
<a id="__codelineno-1-90" name="__codelineno-1-90" href="#__codelineno-1-90"></a><span class="s2">{{~! escapes the `regexString` regex to allow it to be used like a normal search in a string ~}}</span>
<a id="__codelineno-1-91" name="__codelineno-1-91" href="#__codelineno-1-91"></a><span class="s2">{{#*inline "</span><span class="err">_</span><span class="nv">jpmn-escape-regex</span><span class="s2">"}}</span>
<a id="__codelineno-1-92" name="__codelineno-1-92" href="#__codelineno-1-92"></a><span class="s2">    {{~#regexReplace "</span><span class="err">[.*+?^${}</span><span class="nv">()</span><span class="err">|[\]\\]</span><span class="s2">" "</span><span class="err">\$&amp;</span><span class="s2">" "</span><span class="nv">g</span><span class="s2">"~}}{{~regexString~}}{{~/regexReplace~}}</span>
<a id="__codelineno-1-93" name="__codelineno-1-93" href="#__codelineno-1-93"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-94" name="__codelineno-1-94" href="#__codelineno-1-94"></a>
<a id="__codelineno-1-95" name="__codelineno-1-95" href="#__codelineno-1-95"></a>
<a id="__codelineno-1-96" name="__codelineno-1-96" href="#__codelineno-1-96"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-get-dict-if-glossary-selected</span><span class="s2">"~}}</span>
<a id="__codelineno-1-97" name="__codelineno-1-97" href="#__codelineno-1-97"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-98" name="__codelineno-1-98" href="#__codelineno-1-98"></a><span class="s2">        {{~#set "</span><span class="nv">result-dictionary</span><span class="s2">" null}}{{/set~}}</span>
<a id="__codelineno-1-99" name="__codelineno-1-99" href="#__codelineno-1-99"></a><span class="s2">        {{~#set "</span><span class="nv">search-selection</span><span class="s2">"}}{{~#regexReplace "</span><span class="err">[.*+?^${}</span><span class="nv">()</span><span class="err">|[\]\\]</span><span class="s2">" "</span><span class="err">\$&amp;</span><span class="s2">" "</span><span class="nv">g</span><span class="s2">"~}}{{~&gt; _jpmn-selection-text ~}}{{~/regexReplace~}}{{/set~}}</span>
<a id="__codelineno-1-100" name="__codelineno-1-100" href="#__codelineno-1-100"></a>
<a id="__codelineno-1-101" name="__codelineno-1-101" href="#__codelineno-1-101"></a><span class="s2">        {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-102" name="__codelineno-1-102" href="#__codelineno-1-102"></a><span class="s2">            {{~#set "</span><span class="nv">search-def</span><span class="s2">"}}{{~&gt; _jpmn-glossary-single-search . brief=../brief noDictionaryTag=../noDictionaryTag ~}}{{/set~}}</span>
<a id="__codelineno-1-103" name="__codelineno-1-103" href="#__codelineno-1-103"></a>
<a id="__codelineno-1-104" name="__codelineno-1-104" href="#__codelineno-1-104"></a><span class="s2">            {{~set "</span><span class="nv">search-regex-match</span><span class="s2">" (regexMatch (get "</span><span class="nv">search-selection</span><span class="s2">") "</span><span class="nv">gu</span><span class="s2">" (get "</span><span class="nv">search-def</span><span class="s2">"))}}</span>
<a id="__codelineno-1-105" name="__codelineno-1-105" href="#__codelineno-1-105"></a><span class="s2">            {{~#if (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-106" name="__codelineno-1-106" href="#__codelineno-1-106"></a><span class="s2">                (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result-dictionary</span><span class="s2">") null)</span>
<a id="__codelineno-1-107" name="__codelineno-1-107" href="#__codelineno-1-107"></a><span class="s2">                (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">search-regex-match</span><span class="s2">") "")</span>
<a id="__codelineno-1-108" name="__codelineno-1-108" href="#__codelineno-1-108"></a><span class="s2">            )~}}</span>
<a id="__codelineno-1-109" name="__codelineno-1-109" href="#__codelineno-1-109"></a><span class="s2">                {{~#set "</span><span class="nv">result-dictionary</span><span class="s2">" dictionary}}{{/set~}}</span>
<a id="__codelineno-1-110" name="__codelineno-1-110" href="#__codelineno-1-110"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-111" name="__codelineno-1-111" href="#__codelineno-1-111"></a>
<a id="__codelineno-1-112" name="__codelineno-1-112" href="#__codelineno-1-112"></a><span class="s2">        {{~/each~}}</span>
<a id="__codelineno-1-113" name="__codelineno-1-113" href="#__codelineno-1-113"></a><span class="s2">        {{~get "</span><span class="nv">result-dictionary</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-114" name="__codelineno-1-114" href="#__codelineno-1-114"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-115" name="__codelineno-1-115" href="#__codelineno-1-115"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-116" name="__codelineno-1-116" href="#__codelineno-1-116"></a>
<a id="__codelineno-1-117" name="__codelineno-1-117" href="#__codelineno-1-117"></a>
<a id="__codelineno-1-118" name="__codelineno-1-118" href="#__codelineno-1-118"></a>
<a id="__codelineno-1-119" name="__codelineno-1-119" href="#__codelineno-1-119"></a>
<a id="__codelineno-1-120" name="__codelineno-1-120" href="#__codelineno-1-120"></a><span class="s2">{{~!</span>
<a id="__codelineno-1-121" name="__codelineno-1-121" href="#__codelineno-1-121"></a><span class="s2">    searches dictionary, determined by `opt-first-definition-type`</span>
<a id="__codelineno-1-122" name="__codelineno-1-122" href="#__codelineno-1-122"></a><span class="s2">    - (opt-first-definition-type === bilingual) -&gt; bilingual dictionaries are searched first</span>
<a id="__codelineno-1-123" name="__codelineno-1-123" href="#__codelineno-1-123"></a><span class="s2">    - (opt-first-definition-type === monolingual) -&gt; monolingual dictionaries are searched first</span>
<a id="__codelineno-1-124" name="__codelineno-1-124" href="#__codelineno-1-124"></a><span class="s2">~}}</span>
<a id="__codelineno-1-125" name="__codelineno-1-125" href="#__codelineno-1-125"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-search-primary-definition-dict</span><span class="s2">"~}}</span>
<a id="__codelineno-1-126" name="__codelineno-1-126" href="#__codelineno-1-126"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-127" name="__codelineno-1-127" href="#__codelineno-1-127"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-first-definition-type</span><span class="s2">") "</span><span class="nv">bilingual</span><span class="s2">")~}}</span>
<a id="__codelineno-1-128" name="__codelineno-1-128" href="#__codelineno-1-128"></a><span class="s2">            {{~#set "</span><span class="nv">first-definition-search-type-1</span><span class="s2">" "</span><span class="nv">bilingual</span><span class="s2">"}}{{/set~}}</span>
<a id="__codelineno-1-129" name="__codelineno-1-129" href="#__codelineno-1-129"></a><span class="s2">            {{~#set "</span><span class="nv">first-definition-search-type-2</span><span class="s2">" "</span><span class="nv">monolingual</span><span class="s2">"}}{{/set~}}</span>
<a id="__codelineno-1-130" name="__codelineno-1-130" href="#__codelineno-1-130"></a><span class="s2">        {{~else~}}</span>
<a id="__codelineno-1-131" name="__codelineno-1-131" href="#__codelineno-1-131"></a><span class="s2">            {{~#set "</span><span class="nv">first-definition-search-type-1</span><span class="s2">" "</span><span class="nv">monolingual</span><span class="s2">"}}{{/set~}}</span>
<a id="__codelineno-1-132" name="__codelineno-1-132" href="#__codelineno-1-132"></a><span class="s2">            {{~#set "</span><span class="nv">first-definition-search-type-2</span><span class="s2">" "</span><span class="nv">bilingual</span><span class="s2">"}}{{/set~}}</span>
<a id="__codelineno-1-133" name="__codelineno-1-133" href="#__codelineno-1-133"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-134" name="__codelineno-1-134" href="#__codelineno-1-134"></a>
<a id="__codelineno-1-135" name="__codelineno-1-135" href="#__codelineno-1-135"></a>
<a id="__codelineno-1-136" name="__codelineno-1-136" href="#__codelineno-1-136"></a><span class="s2">        {{~! first-dictionary === null &lt;=&gt; no valid dictionary was found ~}}</span>
<a id="__codelineno-1-137" name="__codelineno-1-137" href="#__codelineno-1-137"></a><span class="s2">        {{~#set "</span><span class="nv">first-dictionary</span><span class="s2">" null}}{{/set~}}</span>
<a id="__codelineno-1-138" name="__codelineno-1-138" href="#__codelineno-1-138"></a>
<a id="__codelineno-1-139" name="__codelineno-1-139" href="#__codelineno-1-139"></a><span class="s2">        {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-140" name="__codelineno-1-140" href="#__codelineno-1-140"></a>
<a id="__codelineno-1-141" name="__codelineno-1-141" href="#__codelineno-1-141"></a><span class="s2">            {{~#set "</span><span class="nv">test-dict-name</span><span class="s2">"}}{{~&gt; jpmn-get-dict-type . dictionaryName=dictionary ~}}{{/set~}}</span>
<a id="__codelineno-1-142" name="__codelineno-1-142" href="#__codelineno-1-142"></a><span class="s2">            {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">test-dict-name</span><span class="s2">") (get "</span><span class="nv">first-definition-search-type-1</span><span class="s2">"))~}}</span>
<a id="__codelineno-1-143" name="__codelineno-1-143" href="#__codelineno-1-143"></a><span class="s2">                {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" null (get "</span><span class="nv">first-dictionary</span><span class="s2">"))~}}</span>
<a id="__codelineno-1-144" name="__codelineno-1-144" href="#__codelineno-1-144"></a><span class="s2">                    {{~#set "</span><span class="nv">first-dictionary</span><span class="s2">" dictionary~}}{{~/set~}}</span>
<a id="__codelineno-1-145" name="__codelineno-1-145" href="#__codelineno-1-145"></a><span class="s2">                {{~/if~}}</span>
<a id="__codelineno-1-146" name="__codelineno-1-146" href="#__codelineno-1-146"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-147" name="__codelineno-1-147" href="#__codelineno-1-147"></a>
<a id="__codelineno-1-148" name="__codelineno-1-148" href="#__codelineno-1-148"></a><span class="s2">        {{~/each~}}</span>
<a id="__codelineno-1-149" name="__codelineno-1-149" href="#__codelineno-1-149"></a>
<a id="__codelineno-1-150" name="__codelineno-1-150" href="#__codelineno-1-150"></a>
<a id="__codelineno-1-151" name="__codelineno-1-151" href="#__codelineno-1-151"></a><span class="s2">        {{~! uses other dictionary type, last resort ~}}</span>
<a id="__codelineno-1-152" name="__codelineno-1-152" href="#__codelineno-1-152"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">first-dictionary</span><span class="s2">") null)~}}</span>
<a id="__codelineno-1-153" name="__codelineno-1-153" href="#__codelineno-1-153"></a>
<a id="__codelineno-1-154" name="__codelineno-1-154" href="#__codelineno-1-154"></a><span class="s2">            {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-155" name="__codelineno-1-155" href="#__codelineno-1-155"></a>
<a id="__codelineno-1-156" name="__codelineno-1-156" href="#__codelineno-1-156"></a><span class="s2">                {{~#set "</span><span class="nv">test-dict-name</span><span class="s2">"}}{{~&gt; jpmn-get-dict-type . dictionaryName=dictionary ~}}{{/set~}}</span>
<a id="__codelineno-1-157" name="__codelineno-1-157" href="#__codelineno-1-157"></a><span class="s2">                {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">test-dict-name</span><span class="s2">") (get "</span><span class="nv">first-definition-search-type-2</span><span class="s2">"))~}}</span>
<a id="__codelineno-1-158" name="__codelineno-1-158" href="#__codelineno-1-158"></a><span class="s2">                    {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" null (get "</span><span class="nv">first-dictionary</span><span class="s2">"))~}}</span>
<a id="__codelineno-1-159" name="__codelineno-1-159" href="#__codelineno-1-159"></a><span class="s2">                        {{~#set "</span><span class="nv">first-dictionary</span><span class="s2">" dictionary~}}{{~/set~}}</span>
<a id="__codelineno-1-160" name="__codelineno-1-160" href="#__codelineno-1-160"></a><span class="s2">                    {{~/if~}}</span>
<a id="__codelineno-1-161" name="__codelineno-1-161" href="#__codelineno-1-161"></a><span class="s2">                {{~/if~}}</span>
<a id="__codelineno-1-162" name="__codelineno-1-162" href="#__codelineno-1-162"></a>
<a id="__codelineno-1-163" name="__codelineno-1-163" href="#__codelineno-1-163"></a><span class="s2">            {{~/each~}}</span>
<a id="__codelineno-1-164" name="__codelineno-1-164" href="#__codelineno-1-164"></a>
<a id="__codelineno-1-165" name="__codelineno-1-165" href="#__codelineno-1-165"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-166" name="__codelineno-1-166" href="#__codelineno-1-166"></a>
<a id="__codelineno-1-167" name="__codelineno-1-167" href="#__codelineno-1-167"></a><span class="s2">        {{~#get "</span><span class="nv">first-dictionary</span><span class="s2">"~}}{{~/get~}}</span>
<a id="__codelineno-1-168" name="__codelineno-1-168" href="#__codelineno-1-168"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-169" name="__codelineno-1-169" href="#__codelineno-1-169"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-170" name="__codelineno-1-170" href="#__codelineno-1-170"></a>
<a id="__codelineno-1-171" name="__codelineno-1-171" href="#__codelineno-1-171"></a>
<a id="__codelineno-1-172" name="__codelineno-1-172" href="#__codelineno-1-172"></a><span class="s2">{{~!</span>
<a id="__codelineno-1-173" name="__codelineno-1-173" href="#__codelineno-1-173"></a><span class="s2">    if (selection-text exists):</span>
<a id="__codelineno-1-174" name="__codelineno-1-174" href="#__codelineno-1-174"></a><span class="s2">        if (selection-text is exactly a dictionary):</span>
<a id="__codelineno-1-175" name="__codelineno-1-175" href="#__codelineno-1-175"></a><span class="s2">            return dictionary</span>
<a id="__codelineno-1-176" name="__codelineno-1-176" href="#__codelineno-1-176"></a><span class="s2">        if (able to detect dictionary of which the selection-text is highlighting):</span>
<a id="__codelineno-1-177" name="__codelineno-1-177" href="#__codelineno-1-177"></a><span class="s2">            return dictionary</span>
<a id="__codelineno-1-178" name="__codelineno-1-178" href="#__codelineno-1-178"></a><span class="s2">        return null</span>
<a id="__codelineno-1-179" name="__codelineno-1-179" href="#__codelineno-1-179"></a><span class="s2">~}}</span>
<a id="__codelineno-1-180" name="__codelineno-1-180" href="#__codelineno-1-180"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-check-dictionary-and-glossary</span><span class="s2">"~}}</span>
<a id="__codelineno-1-181" name="__codelineno-1-181" href="#__codelineno-1-181"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-182" name="__codelineno-1-182" href="#__codelineno-1-182"></a>
<a id="__codelineno-1-183" name="__codelineno-1-183" href="#__codelineno-1-183"></a><span class="s2">        {{~#set "</span><span class="nv">result</span><span class="s2">" ""}}{{/set~}}</span>
<a id="__codelineno-1-184" name="__codelineno-1-184" href="#__codelineno-1-184"></a>
<a id="__codelineno-1-185" name="__codelineno-1-185" href="#__codelineno-1-185"></a><span class="s2">        {{~! checks if the selected text matches a dictionary ~}}</span>
<a id="__codelineno-1-186" name="__codelineno-1-186" href="#__codelineno-1-186"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-selection-text-dictionary</span><span class="s2">") true)~}}</span>
<a id="__codelineno-1-187" name="__codelineno-1-187" href="#__codelineno-1-187"></a><span class="s2">            {{~#set "</span><span class="nv">result</span><span class="s2">"}}{{~&gt; _jpmn-check-dictionary . ~}}{{/set~}}</span>
<a id="__codelineno-1-188" name="__codelineno-1-188" href="#__codelineno-1-188"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-189" name="__codelineno-1-189" href="#__codelineno-1-189"></a>
<a id="__codelineno-1-190" name="__codelineno-1-190" href="#__codelineno-1-190"></a><span class="s2">        {{~! checks if the selected text matches a definition in a dictionary ~}}</span>
<a id="__codelineno-1-191" name="__codelineno-1-191" href="#__codelineno-1-191"></a><span class="s2">        {{~#if</span>
<a id="__codelineno-1-192" name="__codelineno-1-192" href="#__codelineno-1-192"></a><span class="s2">            (op "</span><span class="err">&amp;&amp;</span><span class="s2">" (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result</span><span class="s2">") "")</span>
<a id="__codelineno-1-193" name="__codelineno-1-193" href="#__codelineno-1-193"></a><span class="s2">                (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-194" name="__codelineno-1-194" href="#__codelineno-1-194"></a><span class="s2">                    (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-selection-text-glossary</span><span class="s2">") true)</span>
<a id="__codelineno-1-195" name="__codelineno-1-195" href="#__codelineno-1-195"></a><span class="s2">                    (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-selection-text-glossary-attempt-bold</span><span class="s2">") true)</span>
<a id="__codelineno-1-196" name="__codelineno-1-196" href="#__codelineno-1-196"></a><span class="s2">                )</span>
<a id="__codelineno-1-197" name="__codelineno-1-197" href="#__codelineno-1-197"></a><span class="s2">            )</span>
<a id="__codelineno-1-198" name="__codelineno-1-198" href="#__codelineno-1-198"></a><span class="s2">        ~}}</span>
<a id="__codelineno-1-199" name="__codelineno-1-199" href="#__codelineno-1-199"></a><span class="s2">            {{~#set "</span><span class="nv">result</span><span class="s2">"}}{{~&gt; _jpmn-get-dict-if-glossary-selected . ~}}{{/set~}}</span>
<a id="__codelineno-1-200" name="__codelineno-1-200" href="#__codelineno-1-200"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-201" name="__codelineno-1-201" href="#__codelineno-1-201"></a>
<a id="__codelineno-1-202" name="__codelineno-1-202" href="#__codelineno-1-202"></a><span class="s2">        {{~get "</span><span class="nv">result</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-203" name="__codelineno-1-203" href="#__codelineno-1-203"></a>
<a id="__codelineno-1-204" name="__codelineno-1-204" href="#__codelineno-1-204"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-205" name="__codelineno-1-205" href="#__codelineno-1-205"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-206" name="__codelineno-1-206" href="#__codelineno-1-206"></a>
<a id="__codelineno-1-207" name="__codelineno-1-207" href="#__codelineno-1-207"></a>
<a id="__codelineno-1-208" name="__codelineno-1-208" href="#__codelineno-1-208"></a><span class="s2">{{~!</span>
<a id="__codelineno-1-209" name="__codelineno-1-209" href="#__codelineno-1-209"></a><span class="s2">    if (selection-text exists):</span>
<a id="__codelineno-1-210" name="__codelineno-1-210" href="#__codelineno-1-210"></a><span class="s2">        if (selection-text is exactly a dictionary):</span>
<a id="__codelineno-1-211" name="__codelineno-1-211" href="#__codelineno-1-211"></a><span class="s2">            return null</span>
<a id="__codelineno-1-212" name="__codelineno-1-212" href="#__codelineno-1-212"></a><span class="s2">        if (able to detect dictionary of which the selection-text is highlighting):</span>
<a id="__codelineno-1-213" name="__codelineno-1-213" href="#__codelineno-1-213"></a><span class="s2">            return "</span><span class="nv">uses-glossary</span><span class="s2">"</span>
<a id="__codelineno-1-214" name="__codelineno-1-214" href="#__codelineno-1-214"></a><span class="s2">        return null</span>
<a id="__codelineno-1-215" name="__codelineno-1-215" href="#__codelineno-1-215"></a><span class="s2">~}}</span>
<a id="__codelineno-1-216" name="__codelineno-1-216" href="#__codelineno-1-216"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-selection-uses-glossary</span><span class="s2">"~}}</span>
<a id="__codelineno-1-217" name="__codelineno-1-217" href="#__codelineno-1-217"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-218" name="__codelineno-1-218" href="#__codelineno-1-218"></a>
<a id="__codelineno-1-219" name="__codelineno-1-219" href="#__codelineno-1-219"></a><span class="s2">        {{~#set "</span><span class="nv">result</span><span class="s2">" ""}}{{/set~}}</span>
<a id="__codelineno-1-220" name="__codelineno-1-220" href="#__codelineno-1-220"></a>
<a id="__codelineno-1-221" name="__codelineno-1-221" href="#__codelineno-1-221"></a><span class="s2">        {{~! checks if the selected text matches a dictionary ~}}</span>
<a id="__codelineno-1-222" name="__codelineno-1-222" href="#__codelineno-1-222"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-selection-text-dictionary</span><span class="s2">") true)~}}</span>
<a id="__codelineno-1-223" name="__codelineno-1-223" href="#__codelineno-1-223"></a><span class="s2">            {{~#set "</span><span class="nv">result</span><span class="s2">"}}{{~&gt; _jpmn-check-dictionary . ~}}{{/set~}}</span>
<a id="__codelineno-1-224" name="__codelineno-1-224" href="#__codelineno-1-224"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-225" name="__codelineno-1-225" href="#__codelineno-1-225"></a>
<a id="__codelineno-1-226" name="__codelineno-1-226" href="#__codelineno-1-226"></a><span class="s2">        {{~! checks if the selected text matches a definition in a dictionary ~}}</span>
<a id="__codelineno-1-227" name="__codelineno-1-227" href="#__codelineno-1-227"></a><span class="s2">        {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result</span><span class="s2">") "") ~}}</span>
<a id="__codelineno-1-228" name="__codelineno-1-228" href="#__codelineno-1-228"></a><span class="s2">            {{~! selection-text is a dictionary -&gt; null ~}}</span>
<a id="__codelineno-1-229" name="__codelineno-1-229" href="#__codelineno-1-229"></a><span class="s2">        {{~else if</span>
<a id="__codelineno-1-230" name="__codelineno-1-230" href="#__codelineno-1-230"></a><span class="s2">            (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-231" name="__codelineno-1-231" href="#__codelineno-1-231"></a><span class="s2">                (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-selection-text-glossary</span><span class="s2">") true)</span>
<a id="__codelineno-1-232" name="__codelineno-1-232" href="#__codelineno-1-232"></a><span class="s2">                (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-selection-text-glossary-attempt-bold</span><span class="s2">") true)</span>
<a id="__codelineno-1-233" name="__codelineno-1-233" href="#__codelineno-1-233"></a><span class="s2">            )</span>
<a id="__codelineno-1-234" name="__codelineno-1-234" href="#__codelineno-1-234"></a><span class="s2">        ~}}</span>
<a id="__codelineno-1-235" name="__codelineno-1-235" href="#__codelineno-1-235"></a><span class="s2">            {{~#set "</span><span class="nv">result</span><span class="s2">"}}{{~&gt; _jpmn-get-dict-if-glossary-selected . ~}}{{/set~}}</span>
<a id="__codelineno-1-236" name="__codelineno-1-236" href="#__codelineno-1-236"></a><span class="s2">            {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result</span><span class="s2">") "") ~}}</span>
<a id="__codelineno-1-237" name="__codelineno-1-237" href="#__codelineno-1-237"></a><span class="s2">                {{~! selection-text dict found -&gt; "</span><span class="nv">uses-glossary</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-238" name="__codelineno-1-238" href="#__codelineno-1-238"></a><span class="s2">                uses-glossary</span>
<a id="__codelineno-1-239" name="__codelineno-1-239" href="#__codelineno-1-239"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-240" name="__codelineno-1-240" href="#__codelineno-1-240"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-241" name="__codelineno-1-241" href="#__codelineno-1-241"></a>
<a id="__codelineno-1-242" name="__codelineno-1-242" href="#__codelineno-1-242"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-243" name="__codelineno-1-243" href="#__codelineno-1-243"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-244" name="__codelineno-1-244" href="#__codelineno-1-244"></a>
<a id="__codelineno-1-245" name="__codelineno-1-245" href="#__codelineno-1-245"></a>
<a id="__codelineno-1-246" name="__codelineno-1-246" href="#__codelineno-1-246"></a>
<a id="__codelineno-1-247" name="__codelineno-1-247" href="#__codelineno-1-247"></a>
<a id="__codelineno-1-248" name="__codelineno-1-248" href="#__codelineno-1-248"></a><span class="s2">{{~!</span>
<a id="__codelineno-1-249" name="__codelineno-1-249" href="#__codelineno-1-249"></a><span class="s2">    if (selection-text exists):</span>
<a id="__codelineno-1-250" name="__codelineno-1-250" href="#__codelineno-1-250"></a><span class="s2">        if (selection-text is exactly a dictionary):</span>
<a id="__codelineno-1-251" name="__codelineno-1-251" href="#__codelineno-1-251"></a><span class="s2">            return dictionary</span>
<a id="__codelineno-1-252" name="__codelineno-1-252" href="#__codelineno-1-252"></a><span class="s2">        if (able to detect dictionary of which the selection-text is highlighting):</span>
<a id="__codelineno-1-253" name="__codelineno-1-253" href="#__codelineno-1-253"></a><span class="s2">            return dictionary</span>
<a id="__codelineno-1-254" name="__codelineno-1-254" href="#__codelineno-1-254"></a><span class="s2">        if (selection-text-glossary is not enabled):</span>
<a id="__codelineno-1-255" name="__codelineno-1-255" href="#__codelineno-1-255"></a><span class="s2">            return first-dictionary (determined by `opt-first-definition-type`)</span>
<a id="__codelineno-1-256" name="__codelineno-1-256" href="#__codelineno-1-256"></a><span class="s2">        return null</span>
<a id="__codelineno-1-257" name="__codelineno-1-257" href="#__codelineno-1-257"></a>
<a id="__codelineno-1-258" name="__codelineno-1-258" href="#__codelineno-1-258"></a><span class="s2">    else:</span>
<a id="__codelineno-1-259" name="__codelineno-1-259" href="#__codelineno-1-259"></a><span class="s2">        return first-dictionary (determined by `opt-first-definition-type`)</span>
<a id="__codelineno-1-260" name="__codelineno-1-260" href="#__codelineno-1-260"></a><span class="s2">~}}</span>
<a id="__codelineno-1-261" name="__codelineno-1-261" href="#__codelineno-1-261"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-get-primary-definition-dict</span><span class="s2">"~}}</span>
<a id="__codelineno-1-262" name="__codelineno-1-262" href="#__codelineno-1-262"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-263" name="__codelineno-1-263" href="#__codelineno-1-263"></a>
<a id="__codelineno-1-264" name="__codelineno-1-264" href="#__codelineno-1-264"></a><span class="s2">        {{~! first checks selection text ~}}</span>
<a id="__codelineno-1-265" name="__codelineno-1-265" href="#__codelineno-1-265"></a><span class="s2">        {{~#set "</span><span class="nv">selection</span><span class="s2">"}}{{~&gt; _jpmn-selection-text ~}}{{/set~}}</span>
<a id="__codelineno-1-266" name="__codelineno-1-266" href="#__codelineno-1-266"></a><span class="s2">        {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">selection</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-267" name="__codelineno-1-267" href="#__codelineno-1-267"></a>
<a id="__codelineno-1-268" name="__codelineno-1-268" href="#__codelineno-1-268"></a><span class="s2">            {{~#set "</span><span class="nv">result</span><span class="s2">"}}{{~&gt; _jpmn-check-dictionary-and-glossary . ~}}{{/set~}}</span>
<a id="__codelineno-1-269" name="__codelineno-1-269" href="#__codelineno-1-269"></a>
<a id="__codelineno-1-270" name="__codelineno-1-270" href="#__codelineno-1-270"></a><span class="s2">            {{~! doesn't return a dictionary if opt-selection-text-glossary is false b/c ~}}</span>
<a id="__codelineno-1-271" name="__codelineno-1-271" href="#__codelineno-1-271"></a><span class="s2">            {{~#if</span>
<a id="__codelineno-1-272" name="__codelineno-1-272" href="#__codelineno-1-272"></a><span class="s2">                (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-273" name="__codelineno-1-273" href="#__codelineno-1-273"></a><span class="s2">                    (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result</span><span class="s2">") "")</span>
<a id="__codelineno-1-274" name="__codelineno-1-274" href="#__codelineno-1-274"></a><span class="s2">                    (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-selection-text-glossary</span><span class="s2">") false)</span>
<a id="__codelineno-1-275" name="__codelineno-1-275" href="#__codelineno-1-275"></a><span class="s2">                )</span>
<a id="__codelineno-1-276" name="__codelineno-1-276" href="#__codelineno-1-276"></a><span class="s2">            ~}}</span>
<a id="__codelineno-1-277" name="__codelineno-1-277" href="#__codelineno-1-277"></a><span class="s2">                {{~#set "</span><span class="nv">result</span><span class="s2">"}}{{~&gt; _jpmn-search-primary-definition-dict . ~}}{{/set~}}</span>
<a id="__codelineno-1-278" name="__codelineno-1-278" href="#__codelineno-1-278"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-279" name="__codelineno-1-279" href="#__codelineno-1-279"></a>
<a id="__codelineno-1-280" name="__codelineno-1-280" href="#__codelineno-1-280"></a><span class="s2">            {{~get "</span><span class="nv">result</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-281" name="__codelineno-1-281" href="#__codelineno-1-281"></a>
<a id="__codelineno-1-282" name="__codelineno-1-282" href="#__codelineno-1-282"></a><span class="s2">        {{~! no selection text ~}}</span>
<a id="__codelineno-1-283" name="__codelineno-1-283" href="#__codelineno-1-283"></a><span class="s2">        {{~else~}}</span>
<a id="__codelineno-1-284" name="__codelineno-1-284" href="#__codelineno-1-284"></a><span class="s2">            {{~&gt; _jpmn-search-primary-definition-dict . ~}}</span>
<a id="__codelineno-1-285" name="__codelineno-1-285" href="#__codelineno-1-285"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-286" name="__codelineno-1-286" href="#__codelineno-1-286"></a>
<a id="__codelineno-1-287" name="__codelineno-1-287" href="#__codelineno-1-287"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-288" name="__codelineno-1-288" href="#__codelineno-1-288"></a>
<a id="__codelineno-1-289" name="__codelineno-1-289" href="#__codelineno-1-289"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-290" name="__codelineno-1-290" href="#__codelineno-1-290"></a>
<a id="__codelineno-1-291" name="__codelineno-1-291" href="#__codelineno-1-291"></a>
<a id="__codelineno-1-292" name="__codelineno-1-292" href="#__codelineno-1-292"></a>
<a id="__codelineno-1-293" name="__codelineno-1-293" href="#__codelineno-1-293"></a>
<a id="__codelineno-1-294" name="__codelineno-1-294" href="#__codelineno-1-294"></a><span class="s2">{{~!</span>
<a id="__codelineno-1-295" name="__codelineno-1-295" href="#__codelineno-1-295"></a><span class="s2">    get number of primary dictionary entries</span>
<a id="__codelineno-1-296" name="__codelineno-1-296" href="#__codelineno-1-296"></a><span class="s2">~}}</span>
<a id="__codelineno-1-297" name="__codelineno-1-297" href="#__codelineno-1-297"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-primary-dict-entry-count</span><span class="s2">"~}}</span>
<a id="__codelineno-1-298" name="__codelineno-1-298" href="#__codelineno-1-298"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-299" name="__codelineno-1-299" href="#__codelineno-1-299"></a>
<a id="__codelineno-1-300" name="__codelineno-1-300" href="#__codelineno-1-300"></a><span class="s2">        {{~#set "</span><span class="nv">primary-dictionary</span><span class="s2">"}}{{~&gt; _jpmn-get-primary-definition-dict . ~}}{{/set~}}</span>
<a id="__codelineno-1-301" name="__codelineno-1-301" href="#__codelineno-1-301"></a>
<a id="__codelineno-1-302" name="__codelineno-1-302" href="#__codelineno-1-302"></a><span class="s2">        {{~set "</span><span class="nv">dict-entry-count</span><span class="s2">" 0 ~}}</span>
<a id="__codelineno-1-303" name="__codelineno-1-303" href="#__codelineno-1-303"></a>
<a id="__codelineno-1-304" name="__codelineno-1-304" href="#__codelineno-1-304"></a><span class="s2">        {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-305" name="__codelineno-1-305" href="#__codelineno-1-305"></a><span class="s2">            {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" dictionary (get "</span><span class="nv">primary-dictionary</span><span class="s2">")) ~}}</span>
<a id="__codelineno-1-306" name="__codelineno-1-306" href="#__codelineno-1-306"></a><span class="s2">                {{~! dict-entry-count += 1 ~}}</span>
<a id="__codelineno-1-307" name="__codelineno-1-307" href="#__codelineno-1-307"></a><span class="s2">                {{~set "</span><span class="nv">dict-entry-count</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">"</span>
<a id="__codelineno-1-308" name="__codelineno-1-308" href="#__codelineno-1-308"></a><span class="s2">                    (get "</span><span class="nv">dict-entry-count</span><span class="s2">") 1</span>
<a id="__codelineno-1-309" name="__codelineno-1-309" href="#__codelineno-1-309"></a><span class="s2">                )</span>
<a id="__codelineno-1-310" name="__codelineno-1-310" href="#__codelineno-1-310"></a><span class="s2">                ~}}</span>
<a id="__codelineno-1-311" name="__codelineno-1-311" href="#__codelineno-1-311"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-312" name="__codelineno-1-312" href="#__codelineno-1-312"></a><span class="s2">        {{~/each~}}</span>
<a id="__codelineno-1-313" name="__codelineno-1-313" href="#__codelineno-1-313"></a>
<a id="__codelineno-1-314" name="__codelineno-1-314" href="#__codelineno-1-314"></a><span class="s2">        {{~get "</span><span class="nv">dict-entry-count</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-315" name="__codelineno-1-315" href="#__codelineno-1-315"></a>
<a id="__codelineno-1-316" name="__codelineno-1-316" href="#__codelineno-1-316"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-317" name="__codelineno-1-317" href="#__codelineno-1-317"></a>
<a id="__codelineno-1-318" name="__codelineno-1-318" href="#__codelineno-1-318"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-319" name="__codelineno-1-319" href="#__codelineno-1-319"></a>
<a id="__codelineno-1-320" name="__codelineno-1-320" href="#__codelineno-1-320"></a>
<a id="__codelineno-1-321" name="__codelineno-1-321" href="#__codelineno-1-321"></a>
<a id="__codelineno-1-322" name="__codelineno-1-322" href="#__codelineno-1-322"></a>
<a id="__codelineno-1-323" name="__codelineno-1-323" href="#__codelineno-1-323"></a>
<a id="__codelineno-1-324" name="__codelineno-1-324" href="#__codelineno-1-324"></a>
<a id="__codelineno-1-325" name="__codelineno-1-325" href="#__codelineno-1-325"></a>
<a id="__codelineno-1-326" name="__codelineno-1-326" href="#__codelineno-1-326"></a><span class="s2">{{~!</span>
<a id="__codelineno-1-327" name="__codelineno-1-327" href="#__codelineno-1-327"></a><span class="s2">    returns "</span><span class="nv">true</span><span class="s2">" if valid dict, "" (null) otherwise</span>
<a id="__codelineno-1-328" name="__codelineno-1-328" href="#__codelineno-1-328"></a><span class="s2">~}}</span>
<a id="__codelineno-1-329" name="__codelineno-1-329" href="#__codelineno-1-329"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-non-primary-is-valid-dict</span><span class="s2">"~}}</span>
<a id="__codelineno-1-330" name="__codelineno-1-330" href="#__codelineno-1-330"></a><span class="s2">    {{~!</span>
<a id="__codelineno-1-331" name="__codelineno-1-331" href="#__codelineno-1-331"></a><span class="s2">        PARAMETERS:</span>
<a id="__codelineno-1-332" name="__codelineno-1-332" href="#__codelineno-1-332"></a><span class="s2">            validDictType: "</span><span class="nv">monolingual</span><span class="s2">" or "</span><span class="nv">bilingual</span><span class="s2">" or "</span><span class="nv">utility</span><span class="s2">"</span>
<a id="__codelineno-1-333" name="__codelineno-1-333" href="#__codelineno-1-333"></a><span class="s2">            dictionaryName: dictionary id</span>
<a id="__codelineno-1-334" name="__codelineno-1-334" href="#__codelineno-1-334"></a><span class="s2">            entryCount: primary dictionary entry count</span>
<a id="__codelineno-1-335" name="__codelineno-1-335" href="#__codelineno-1-335"></a><span class="s2">    ~}}</span>
<a id="__codelineno-1-336" name="__codelineno-1-336" href="#__codelineno-1-336"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-337" name="__codelineno-1-337" href="#__codelineno-1-337"></a>
<a id="__codelineno-1-338" name="__codelineno-1-338" href="#__codelineno-1-338"></a><span class="s2">        {{~set "</span><span class="nv">use-primary-dictionary</span><span class="s2">" (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-339" name="__codelineno-1-339" href="#__codelineno-1-339"></a><span class="s2">            (get "</span><span class="nv">opt-primary-def-one-dict-entry-only</span><span class="s2">")</span>
<a id="__codelineno-1-340" name="__codelineno-1-340" href="#__codelineno-1-340"></a><span class="s2">            (op "</span><span class="err">&amp;&amp;</span><span class="s2">" (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" entryCount) 0) (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" entryCount) 1))</span>
<a id="__codelineno-1-341" name="__codelineno-1-341" href="#__codelineno-1-341"></a><span class="s2">        )</span>
<a id="__codelineno-1-342" name="__codelineno-1-342" href="#__codelineno-1-342"></a><span class="s2">        ~}}</span>
<a id="__codelineno-1-343" name="__codelineno-1-343" href="#__codelineno-1-343"></a>
<a id="__codelineno-1-344" name="__codelineno-1-344" href="#__codelineno-1-344"></a><span class="s2">        {{~set "</span><span class="nv">valid-dict</span><span class="s2">" null ~}}</span>
<a id="__codelineno-1-345" name="__codelineno-1-345" href="#__codelineno-1-345"></a><span class="s2">        {{~#set "</span><span class="nv">test-dict-type</span><span class="s2">"}}{{~&gt; jpmn-get-dict-type . dictionaryName=dictionaryName ~}}{{/set~}}</span>
<a id="__codelineno-1-346" name="__codelineno-1-346" href="#__codelineno-1-346"></a><span class="s2">        {{~#if (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-347" name="__codelineno-1-347" href="#__codelineno-1-347"></a><span class="s2">            (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">test-dict-type</span><span class="s2">") validDictType)</span>
<a id="__codelineno-1-348" name="__codelineno-1-348" href="#__codelineno-1-348"></a><span class="s2">            (op "</span><span class="err">||</span><span class="s2">"</span>
<a id="__codelineno-1-349" name="__codelineno-1-349" href="#__codelineno-1-349"></a><span class="s2">                (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">primary-dictionary</span><span class="s2">") dictionaryName)</span>
<a id="__codelineno-1-350" name="__codelineno-1-350" href="#__codelineno-1-350"></a><span class="s2">                (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">use-primary-dictionary</span><span class="s2">") true)</span>
<a id="__codelineno-1-351" name="__codelineno-1-351" href="#__codelineno-1-351"></a><span class="s2">            )</span>
<a id="__codelineno-1-352" name="__codelineno-1-352" href="#__codelineno-1-352"></a><span class="s2">        ) ~}}</span>
<a id="__codelineno-1-353" name="__codelineno-1-353" href="#__codelineno-1-353"></a><span class="s2">            {{~set "</span><span class="nv">valid-dict</span><span class="s2">" "</span><span class="nv">true</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-354" name="__codelineno-1-354" href="#__codelineno-1-354"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-355" name="__codelineno-1-355" href="#__codelineno-1-355"></a><span class="s2">        {{~get "</span><span class="nv">valid-dict</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-356" name="__codelineno-1-356" href="#__codelineno-1-356"></a>
<a id="__codelineno-1-357" name="__codelineno-1-357" href="#__codelineno-1-357"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-358" name="__codelineno-1-358" href="#__codelineno-1-358"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-359" name="__codelineno-1-359" href="#__codelineno-1-359"></a>
<a id="__codelineno-1-360" name="__codelineno-1-360" href="#__codelineno-1-360"></a>
<a id="__codelineno-1-361" name="__codelineno-1-361" href="#__codelineno-1-361"></a><span class="s2">{{~!</span>
<a id="__codelineno-1-362" name="__codelineno-1-362" href="#__codelineno-1-362"></a><span class="s2">    returns "</span><span class="nv">true</span><span class="s2">" if valid dict, "" (null) otherwise</span>
<a id="__codelineno-1-363" name="__codelineno-1-363" href="#__codelineno-1-363"></a><span class="s2">~}}</span>
<a id="__codelineno-1-364" name="__codelineno-1-364" href="#__codelineno-1-364"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-non-primary-has-valid-dict</span><span class="s2">"~}}</span>
<a id="__codelineno-1-365" name="__codelineno-1-365" href="#__codelineno-1-365"></a><span class="s2">    {{~!</span>
<a id="__codelineno-1-366" name="__codelineno-1-366" href="#__codelineno-1-366"></a><span class="s2">        PARAMETERS:</span>
<a id="__codelineno-1-367" name="__codelineno-1-367" href="#__codelineno-1-367"></a><span class="s2">            validDictType: "</span><span class="nv">monolingual</span><span class="s2">" or "</span><span class="nv">bilingual</span><span class="s2">" or "</span><span class="nv">utility</span><span class="s2">"</span>
<a id="__codelineno-1-368" name="__codelineno-1-368" href="#__codelineno-1-368"></a><span class="s2">            entryCount: primary dictionary entry count</span>
<a id="__codelineno-1-369" name="__codelineno-1-369" href="#__codelineno-1-369"></a><span class="s2">    ~}}</span>
<a id="__codelineno-1-370" name="__codelineno-1-370" href="#__codelineno-1-370"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-371" name="__codelineno-1-371" href="#__codelineno-1-371"></a>
<a id="__codelineno-1-372" name="__codelineno-1-372" href="#__codelineno-1-372"></a><span class="s2">        {{~set "</span><span class="nv">use-primary-dictionary</span><span class="s2">" (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-373" name="__codelineno-1-373" href="#__codelineno-1-373"></a><span class="s2">            (get "</span><span class="nv">opt-primary-def-one-dict-entry-only</span><span class="s2">")</span>
<a id="__codelineno-1-374" name="__codelineno-1-374" href="#__codelineno-1-374"></a><span class="s2">            (op "</span><span class="err">&amp;&amp;</span><span class="s2">" (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" entryCount) 0) (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" entryCount) 1))</span>
<a id="__codelineno-1-375" name="__codelineno-1-375" href="#__codelineno-1-375"></a><span class="s2">        )</span>
<a id="__codelineno-1-376" name="__codelineno-1-376" href="#__codelineno-1-376"></a><span class="s2">        ~}}</span>
<a id="__codelineno-1-377" name="__codelineno-1-377" href="#__codelineno-1-377"></a>
<a id="__codelineno-1-378" name="__codelineno-1-378" href="#__codelineno-1-378"></a><span class="s2">        {{~!</span>
<a id="__codelineno-1-379" name="__codelineno-1-379" href="#__codelineno-1-379"></a><span class="s2">            without this set statement, the parameters</span>
<a id="__codelineno-1-380" name="__codelineno-1-380" href="#__codelineno-1-380"></a><span class="s2">            magically disappears within the bottom 'each' loop...</span>
<a id="__codelineno-1-381" name="__codelineno-1-381" href="#__codelineno-1-381"></a><span class="s2">        ~}}</span>
<a id="__codelineno-1-382" name="__codelineno-1-382" href="#__codelineno-1-382"></a><span class="s2">        {{~ set "</span><span class="nv">valid-dict-type</span><span class="s2">" validDictType ~}}</span>
<a id="__codelineno-1-383" name="__codelineno-1-383" href="#__codelineno-1-383"></a><span class="s2">        {{~ set "</span><span class="nv">entry-count</span><span class="s2">" entryCount ~}}</span>
<a id="__codelineno-1-384" name="__codelineno-1-384" href="#__codelineno-1-384"></a>
<a id="__codelineno-1-385" name="__codelineno-1-385" href="#__codelineno-1-385"></a><span class="s2">        {{~set "</span><span class="nv">has-valid-dict</span><span class="s2">" null ~}}</span>
<a id="__codelineno-1-386" name="__codelineno-1-386" href="#__codelineno-1-386"></a><span class="s2">        {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-387" name="__codelineno-1-387" href="#__codelineno-1-387"></a><span class="s2">            {{~#set "</span><span class="nv">is-valid-dict</span><span class="s2">"}}{{~&gt; _jpmn-non-primary-is-valid-dict . validDictType=(get "</span><span class="nv">valid-dict-type</span><span class="s2">") entryCount=(get "</span><span class="nv">entry-count</span><span class="s2">") dictionaryName=dictionary ~}}{{/set~}}</span>
<a id="__codelineno-1-388" name="__codelineno-1-388" href="#__codelineno-1-388"></a>
<a id="__codelineno-1-389" name="__codelineno-1-389" href="#__codelineno-1-389"></a><span class="s2">            {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">is-valid-dict</span><span class="s2">") "</span><span class="nv">true</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-390" name="__codelineno-1-390" href="#__codelineno-1-390"></a><span class="s2">                {{~set "</span><span class="nv">has-valid-dict</span><span class="s2">" "</span><span class="nv">true</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-391" name="__codelineno-1-391" href="#__codelineno-1-391"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-392" name="__codelineno-1-392" href="#__codelineno-1-392"></a>
<a id="__codelineno-1-393" name="__codelineno-1-393" href="#__codelineno-1-393"></a><span class="s2">        {{~/each~}}</span>
<a id="__codelineno-1-394" name="__codelineno-1-394" href="#__codelineno-1-394"></a><span class="s2">        {{~get "</span><span class="nv">has-valid-dict</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-395" name="__codelineno-1-395" href="#__codelineno-1-395"></a>
<a id="__codelineno-1-396" name="__codelineno-1-396" href="#__codelineno-1-396"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-397" name="__codelineno-1-397" href="#__codelineno-1-397"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-398" name="__codelineno-1-398" href="#__codelineno-1-398"></a>
<a id="__codelineno-1-399" name="__codelineno-1-399" href="#__codelineno-1-399"></a>
<a id="__codelineno-1-400" name="__codelineno-1-400" href="#__codelineno-1-400"></a>
<a id="__codelineno-1-401" name="__codelineno-1-401" href="#__codelineno-1-401"></a>
<a id="__codelineno-1-402" name="__codelineno-1-402" href="#__codelineno-1-402"></a>
<a id="__codelineno-1-403" name="__codelineno-1-403" href="#__codelineno-1-403"></a>
<a id="__codelineno-1-404" name="__codelineno-1-404" href="#__codelineno-1-404"></a><span class="s2">{{~#*inline "</span><span class="err">_</span><span class="nv">jpmn-get-primary-definition-value</span><span class="s2">"~}}</span>
<a id="__codelineno-1-405" name="__codelineno-1-405" href="#__codelineno-1-405"></a><span class="s2">    {{~!</span>
<a id="__codelineno-1-406" name="__codelineno-1-406" href="#__codelineno-1-406"></a><span class="s2">        ASSUMPTION: "</span><span class="nv">primary-dictionary</span><span class="s2">" and "</span><span class="nv">search-selection</span><span class="s2">" is available to us from previous functions</span>
<a id="__codelineno-1-407" name="__codelineno-1-407" href="#__codelineno-1-407"></a><span class="s2">    ~}}</span>
<a id="__codelineno-1-408" name="__codelineno-1-408" href="#__codelineno-1-408"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-409" name="__codelineno-1-409" href="#__codelineno-1-409"></a>
<a id="__codelineno-1-410" name="__codelineno-1-410" href="#__codelineno-1-410"></a><span class="s2">        {{~#if</span>
<a id="__codelineno-1-411" name="__codelineno-1-411" href="#__codelineno-1-411"></a><span class="s2">            (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-412" name="__codelineno-1-412" href="#__codelineno-1-412"></a><span class="s2">                (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">search-selection</span><span class="s2">") "")</span>
<a id="__codelineno-1-413" name="__codelineno-1-413" href="#__codelineno-1-413"></a><span class="s2">                (get "</span><span class="nv">opt-primary-def-one-dict-entry-only</span><span class="s2">")</span>
<a id="__codelineno-1-414" name="__codelineno-1-414" href="#__codelineno-1-414"></a><span class="s2">            )</span>
<a id="__codelineno-1-415" name="__codelineno-1-415" href="#__codelineno-1-415"></a><span class="s2">        ~}}</span>
<a id="__codelineno-1-416" name="__codelineno-1-416" href="#__codelineno-1-416"></a><span class="s2">            {{~! text was highlighted -&gt; use primary dictionary entry with highlighted text ~}}</span>
<a id="__codelineno-1-417" name="__codelineno-1-417" href="#__codelineno-1-417"></a>
<a id="__codelineno-1-418" name="__codelineno-1-418" href="#__codelineno-1-418"></a><span class="s2">            {{~set "</span><span class="nv">found-dict-entry</span><span class="s2">" false ~}}</span>
<a id="__codelineno-1-419" name="__codelineno-1-419" href="#__codelineno-1-419"></a>
<a id="__codelineno-1-420" name="__codelineno-1-420" href="#__codelineno-1-420"></a><span class="s2">            {{~#if (op "</span><span class="err">!</span><span class="s2">" (get "</span><span class="nv">opt__plaintext__one-dict-entry-only-no-list</span><span class="s2">")) ~}}</span>
<a id="__codelineno-1-421" name="__codelineno-1-421" href="#__codelineno-1-421"></a><span class="s2">            &lt;ol&gt;</span>
<a id="__codelineno-1-422" name="__codelineno-1-422" href="#__codelineno-1-422"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-423" name="__codelineno-1-423" href="#__codelineno-1-423"></a>
<a id="__codelineno-1-424" name="__codelineno-1-424" href="#__codelineno-1-424"></a><span class="s2">            {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-425" name="__codelineno-1-425" href="#__codelineno-1-425"></a>
<a id="__codelineno-1-426" name="__codelineno-1-426" href="#__codelineno-1-426"></a><span class="s2">                {{~#set "</span><span class="nv">rx-match-dict-entry</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-427" name="__codelineno-1-427" href="#__codelineno-1-427"></a><span class="s2">                    {{~#regexMatch (get "</span><span class="nv">search-selection</span><span class="s2">") "</span><span class="nv">gu</span><span class="s2">"~}}{{~&gt; _jpmn-glossary-single . brief=../brief noDictionaryTag=../noDictionaryTag ~}}{{~/regexMatch~}}</span>
<a id="__codelineno-1-428" name="__codelineno-1-428" href="#__codelineno-1-428"></a><span class="s2">                {{/set~}}</span>
<a id="__codelineno-1-429" name="__codelineno-1-429" href="#__codelineno-1-429"></a>
<a id="__codelineno-1-430" name="__codelineno-1-430" href="#__codelineno-1-430"></a><span class="s2">                {{~#if</span>
<a id="__codelineno-1-431" name="__codelineno-1-431" href="#__codelineno-1-431"></a><span class="s2">                    (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-432" name="__codelineno-1-432" href="#__codelineno-1-432"></a><span class="s2">                        (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">found-dict-entry</span><span class="s2">") false)</span>
<a id="__codelineno-1-433" name="__codelineno-1-433" href="#__codelineno-1-433"></a><span class="s2">                        (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-434" name="__codelineno-1-434" href="#__codelineno-1-434"></a><span class="s2">                            (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-dict-entry</span><span class="s2">") "")</span>
<a id="__codelineno-1-435" name="__codelineno-1-435" href="#__codelineno-1-435"></a><span class="s2">                            (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" dictionary (get "</span><span class="nv">primary-dictionary</span><span class="s2">"))</span>
<a id="__codelineno-1-436" name="__codelineno-1-436" href="#__codelineno-1-436"></a><span class="s2">                        )</span>
<a id="__codelineno-1-437" name="__codelineno-1-437" href="#__codelineno-1-437"></a><span class="s2">                    )</span>
<a id="__codelineno-1-438" name="__codelineno-1-438" href="#__codelineno-1-438"></a><span class="s2">                ~}}</span>
<a id="__codelineno-1-439" name="__codelineno-1-439" href="#__codelineno-1-439"></a>
<a id="__codelineno-1-440" name="__codelineno-1-440" href="#__codelineno-1-440"></a><span class="s2">                    {{~#if (op "</span><span class="err">!</span><span class="s2">" (get "</span><span class="nv">opt__plaintext__one-dict-entry-only-no-list</span><span class="s2">")) ~}}</span>
<a id="__codelineno-1-441" name="__codelineno-1-441" href="#__codelineno-1-441"></a><span class="s2">                    &lt;li data-details="</span><span class="err">{{~</span><span class="nv">dictionary</span><span class="m">~</span><span class="cp">}}</span><span class="x">"&gt;</span>
<a id="__codelineno-1-442" name="__codelineno-1-442" href="#__codelineno-1-442"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-443" name="__codelineno-1-443" href="#__codelineno-1-443"></a>
<a id="__codelineno-1-444" name="__codelineno-1-444" href="#__codelineno-1-444"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-glossary-single</span> <span class="err">.</span> <span class="na">brief</span><span class="o">=</span><span class="nv">../brief</span> <span class="na">noDictionaryTag</span><span class="o">=</span><span class="nv">../noDictionaryTag</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-445" name="__codelineno-1-445" href="#__codelineno-1-445"></a>
<a id="__codelineno-1-446" name="__codelineno-1-446" href="#__codelineno-1-446"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="s2">"!"</span> <span class="nv">(get</span> <span class="s2">"opt__plaintext__one-dict-entry-only-no-list"</span><span class="nv">))</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-447" name="__codelineno-1-447" href="#__codelineno-1-447"></a><span class="x">                    &lt;/li&gt;</span>
<a id="__codelineno-1-448" name="__codelineno-1-448" href="#__codelineno-1-448"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-449" name="__codelineno-1-449" href="#__codelineno-1-449"></a>
<a id="__codelineno-1-450" name="__codelineno-1-450" href="#__codelineno-1-450"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"found-dict-entry"</span> <span class="nv">true</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-451" name="__codelineno-1-451" href="#__codelineno-1-451"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-452" name="__codelineno-1-452" href="#__codelineno-1-452"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-453" name="__codelineno-1-453" href="#__codelineno-1-453"></a>
<a id="__codelineno-1-454" name="__codelineno-1-454" href="#__codelineno-1-454"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="s2">"!"</span> <span class="nv">(get</span> <span class="s2">"opt__plaintext__one-dict-entry-only-no-list"</span><span class="nv">))</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-455" name="__codelineno-1-455" href="#__codelineno-1-455"></a><span class="x">            &lt;/ol&gt;</span>
<a id="__codelineno-1-456" name="__codelineno-1-456" href="#__codelineno-1-456"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-457" name="__codelineno-1-457" href="#__codelineno-1-457"></a>
<a id="__codelineno-1-458" name="__codelineno-1-458" href="#__codelineno-1-458"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~else</span> <span class="nv">if</span> <span class="nv">(get</span> <span class="s2">"opt-primary-def-one-dict-entry-only"</span><span class="nv">)</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-459" name="__codelineno-1-459" href="#__codelineno-1-459"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">use</span> <span class="nv">first</span> <span class="nv">primary</span> <span class="nv">dictionary</span> <span class="nv">entry</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-460" name="__codelineno-1-460" href="#__codelineno-1-460"></a>
<a id="__codelineno-1-461" name="__codelineno-1-461" href="#__codelineno-1-461"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"found-dict-entry"</span> <span class="nv">false</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-462" name="__codelineno-1-462" href="#__codelineno-1-462"></a>
<a id="__codelineno-1-463" name="__codelineno-1-463" href="#__codelineno-1-463"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="s2">"!"</span> <span class="nv">(get</span> <span class="s2">"opt__plaintext__one-dict-entry-only-no-list"</span><span class="nv">))</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-464" name="__codelineno-1-464" href="#__codelineno-1-464"></a><span class="x">            &lt;ol&gt;</span>
<a id="__codelineno-1-465" name="__codelineno-1-465" href="#__codelineno-1-465"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-466" name="__codelineno-1-466" href="#__codelineno-1-466"></a>
<a id="__codelineno-1-467" name="__codelineno-1-467" href="#__codelineno-1-467"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#each</span> <span class="nv">definition.definitions</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-468" name="__codelineno-1-468" href="#__codelineno-1-468"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span>
<a id="__codelineno-1-469" name="__codelineno-1-469" href="#__codelineno-1-469"></a>                    <span class="nv">(op</span> <span class="s2">"&amp;&amp;"</span>
<a id="__codelineno-1-470" name="__codelineno-1-470" href="#__codelineno-1-470"></a>                        <span class="nv">(op</span> <span class="na">"==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">found-dict-entry</span><span class="s2">") false)</span>
<a id="__codelineno-1-471" name="__codelineno-1-471" href="#__codelineno-1-471"></a><span class="s2">                        (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" dictionary (get "</span><span class="nv">primary-dictionary</span><span class="s2">"))</span>
<a id="__codelineno-1-472" name="__codelineno-1-472" href="#__codelineno-1-472"></a><span class="s2">                    )</span>
<a id="__codelineno-1-473" name="__codelineno-1-473" href="#__codelineno-1-473"></a><span class="s2">                ~}}</span>
<a id="__codelineno-1-474" name="__codelineno-1-474" href="#__codelineno-1-474"></a>
<a id="__codelineno-1-475" name="__codelineno-1-475" href="#__codelineno-1-475"></a><span class="s2">                    {{~#if (op "</span><span class="err">!</span><span class="s2">" (get "</span><span class="nv">opt__plaintext__one-dict-entry-only-no-list</span><span class="s2">")) ~}}</span>
<a id="__codelineno-1-476" name="__codelineno-1-476" href="#__codelineno-1-476"></a><span class="s2">                    &lt;li data-details="</span><span class="err">{{~</span><span class="nv">dictionary</span><span class="m">~</span><span class="cp">}}</span><span class="x">"&gt;</span>
<a id="__codelineno-1-477" name="__codelineno-1-477" href="#__codelineno-1-477"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-478" name="__codelineno-1-478" href="#__codelineno-1-478"></a>
<a id="__codelineno-1-479" name="__codelineno-1-479" href="#__codelineno-1-479"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-glossary-single</span> <span class="err">.</span> <span class="na">brief</span><span class="o">=</span><span class="nv">../brief</span> <span class="na">noDictionaryTag</span><span class="o">=</span><span class="nv">../noDictionaryTag</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-480" name="__codelineno-1-480" href="#__codelineno-1-480"></a>
<a id="__codelineno-1-481" name="__codelineno-1-481" href="#__codelineno-1-481"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="s2">"!"</span> <span class="nv">(get</span> <span class="s2">"opt__plaintext__one-dict-entry-only-no-list"</span><span class="nv">))</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-482" name="__codelineno-1-482" href="#__codelineno-1-482"></a><span class="x">                    &lt;/li&gt;</span>
<a id="__codelineno-1-483" name="__codelineno-1-483" href="#__codelineno-1-483"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-484" name="__codelineno-1-484" href="#__codelineno-1-484"></a>
<a id="__codelineno-1-485" name="__codelineno-1-485" href="#__codelineno-1-485"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"found-dict-entry"</span> <span class="nv">true</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-486" name="__codelineno-1-486" href="#__codelineno-1-486"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-487" name="__codelineno-1-487" href="#__codelineno-1-487"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-488" name="__codelineno-1-488" href="#__codelineno-1-488"></a>
<a id="__codelineno-1-489" name="__codelineno-1-489" href="#__codelineno-1-489"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="s2">"!"</span> <span class="nv">(get</span> <span class="s2">"opt__plaintext__one-dict-entry-only-no-list"</span><span class="nv">))</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-490" name="__codelineno-1-490" href="#__codelineno-1-490"></a><span class="x">            &lt;/ol&gt;</span>
<a id="__codelineno-1-491" name="__codelineno-1-491" href="#__codelineno-1-491"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-492" name="__codelineno-1-492" href="#__codelineno-1-492"></a>
<a id="__codelineno-1-493" name="__codelineno-1-493" href="#__codelineno-1-493"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~else~</span><span class="cp">}}</span>
<a id="__codelineno-1-494" name="__codelineno-1-494" href="#__codelineno-1-494"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">use</span> <span class="nv">all</span> <span class="nv">primary</span> <span class="nv">dictionary</span> <span class="nv">entries</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-495" name="__codelineno-1-495" href="#__codelineno-1-495"></a>
<a id="__codelineno-1-496" name="__codelineno-1-496" href="#__codelineno-1-496"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(get</span> <span class="s2">"opt__plaintext__one-dict-entry-only-no-list"</span><span class="nv">)</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-497" name="__codelineno-1-497" href="#__codelineno-1-497"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">must</span> <span class="nv">manually</span> <span class="nv">calculate</span> <span class="nv">number</span> <span class="nv">of</span> <span class="nv">primary-dictionary</span> <span class="nv">entries</span><span class="err">...</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-498" name="__codelineno-1-498" href="#__codelineno-1-498"></a>
<a id="__codelineno-1-499" name="__codelineno-1-499" href="#__codelineno-1-499"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"t"</span> <span class="m">0</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-500" name="__codelineno-1-500" href="#__codelineno-1-500"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~#each</span> <span class="nv">definition.definitions</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-501" name="__codelineno-1-501" href="#__codelineno-1-501"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="na">"==</span><span class="o">=</span><span class="s2">" dictionary (get "</span><span class="nv">primary-dictionary</span><span class="s2">"))~}}</span>
<a id="__codelineno-1-502" name="__codelineno-1-502" href="#__codelineno-1-502"></a><span class="s2">                        {{~set "</span><span class="nv">t</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" (get "</span><span class="nv">t</span><span class="s2">") 1) ~}}</span>
<a id="__codelineno-1-503" name="__codelineno-1-503" href="#__codelineno-1-503"></a><span class="s2">                    {{~/if~}}</span>
<a id="__codelineno-1-504" name="__codelineno-1-504" href="#__codelineno-1-504"></a><span class="s2">                {{~/each~}}</span>
<a id="__codelineno-1-505" name="__codelineno-1-505" href="#__codelineno-1-505"></a>
<a id="__codelineno-1-506" name="__codelineno-1-506" href="#__codelineno-1-506"></a><span class="s2">                {{~#if (op "</span><span class="na">&gt;</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">t</span><span class="s2">") 2)~}} &lt;ol&gt; {{~/if~}}</span>
<a id="__codelineno-1-507" name="__codelineno-1-507" href="#__codelineno-1-507"></a>
<a id="__codelineno-1-508" name="__codelineno-1-508" href="#__codelineno-1-508"></a><span class="s2">                {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-509" name="__codelineno-1-509" href="#__codelineno-1-509"></a><span class="s2">                    {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" dictionary (get "</span><span class="nv">primary-dictionary</span><span class="s2">"))~}}</span>
<a id="__codelineno-1-510" name="__codelineno-1-510" href="#__codelineno-1-510"></a><span class="s2">                        {{~#if (op "</span><span class="na">&gt;</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">t</span><span class="s2">") 2)~}} &lt;li data-details="</span><span class="err">{{~</span><span class="nv">dictionary</span><span class="m">~</span><span class="cp">}}</span><span class="x">"&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-511" name="__codelineno-1-511" href="#__codelineno-1-511"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-glossary-single</span> <span class="err">.</span> <span class="na">brief</span><span class="o">=</span><span class="nv">../brief</span> <span class="na">noDictionaryTag</span><span class="o">=</span><span class="nv">../noDictionaryTag</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-512" name="__codelineno-1-512" href="#__codelineno-1-512"></a><span class="x">                        </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="na">"&gt;</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">t</span><span class="s2">") 2)~}} &lt;/li&gt; {{~/if~}}</span>
<a id="__codelineno-1-513" name="__codelineno-1-513" href="#__codelineno-1-513"></a><span class="s2">                    {{~/if~}}</span>
<a id="__codelineno-1-514" name="__codelineno-1-514" href="#__codelineno-1-514"></a><span class="s2">                {{~/each~}}</span>
<a id="__codelineno-1-515" name="__codelineno-1-515" href="#__codelineno-1-515"></a>
<a id="__codelineno-1-516" name="__codelineno-1-516" href="#__codelineno-1-516"></a><span class="s2">                {{~#if (op "</span><span class="na">&gt;</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">t</span><span class="s2">") 2)~}} &lt;/ol&gt; {{~/if~}}</span>
<a id="__codelineno-1-517" name="__codelineno-1-517" href="#__codelineno-1-517"></a>
<a id="__codelineno-1-518" name="__codelineno-1-518" href="#__codelineno-1-518"></a><span class="s2">            {{~else~}}</span>
<a id="__codelineno-1-519" name="__codelineno-1-519" href="#__codelineno-1-519"></a>
<a id="__codelineno-1-520" name="__codelineno-1-520" href="#__codelineno-1-520"></a><span class="s2">                &lt;ol&gt; {{~s~}}</span>
<a id="__codelineno-1-521" name="__codelineno-1-521" href="#__codelineno-1-521"></a>
<a id="__codelineno-1-522" name="__codelineno-1-522" href="#__codelineno-1-522"></a><span class="s2">                {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-523" name="__codelineno-1-523" href="#__codelineno-1-523"></a><span class="s2">                    {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" dictionary (get "</span><span class="nv">primary-dictionary</span><span class="s2">"))~}}</span>
<a id="__codelineno-1-524" name="__codelineno-1-524" href="#__codelineno-1-524"></a><span class="s2">                        &lt;li data-details="</span><span class="err">{{~</span><span class="nv">dictionary</span><span class="m">~</span><span class="cp">}}</span><span class="x">"&gt;</span>
<a id="__codelineno-1-525" name="__codelineno-1-525" href="#__codelineno-1-525"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-glossary-single</span> <span class="err">.</span> <span class="na">brief</span><span class="o">=</span><span class="nv">../brief</span> <span class="na">noDictionaryTag</span><span class="o">=</span><span class="nv">../noDictionaryTag</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-526" name="__codelineno-1-526" href="#__codelineno-1-526"></a><span class="x">                        &lt;/li&gt;</span>
<a id="__codelineno-1-527" name="__codelineno-1-527" href="#__codelineno-1-527"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-528" name="__codelineno-1-528" href="#__codelineno-1-528"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-529" name="__codelineno-1-529" href="#__codelineno-1-529"></a>
<a id="__codelineno-1-530" name="__codelineno-1-530" href="#__codelineno-1-530"></a><span class="x">                &lt;/ol&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-531" name="__codelineno-1-531" href="#__codelineno-1-531"></a>
<a id="__codelineno-1-532" name="__codelineno-1-532" href="#__codelineno-1-532"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-533" name="__codelineno-1-533" href="#__codelineno-1-533"></a>
<a id="__codelineno-1-534" name="__codelineno-1-534" href="#__codelineno-1-534"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-535" name="__codelineno-1-535" href="#__codelineno-1-535"></a>
<a id="__codelineno-1-536" name="__codelineno-1-536" href="#__codelineno-1-536"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~/scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-537" name="__codelineno-1-537" href="#__codelineno-1-537"></a>
<a id="__codelineno-1-538" name="__codelineno-1-538" href="#__codelineno-1-538"></a><span class="cp">{{</span><span class="m m-Attribute">~/inline~</span><span class="cp">}}</span>
<a id="__codelineno-1-539" name="__codelineno-1-539" href="#__codelineno-1-539"></a>
<a id="__codelineno-1-540" name="__codelineno-1-540" href="#__codelineno-1-540"></a>
<a id="__codelineno-1-541" name="__codelineno-1-541" href="#__codelineno-1-541"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>
<a id="__codelineno-1-542" name="__codelineno-1-542" href="#__codelineno-1-542"></a>    <span class="nv">if</span> <span class="nv">(mode</span> <span class="na">==</span><span class="o">=</span> <span class="s2">"except"</span> <span class="nv">and</span> <span class="nv">(regex</span> <span class="nv">doesn</span><span class="s1">'t match) or mode === "only" and (regex matches)):</span>
<a id="__codelineno-1-543" name="__codelineno-1-543" href="#__codelineno-1-543"></a><span class="s1">        return true</span>
<a id="__codelineno-1-544" name="__codelineno-1-544" href="#__codelineno-1-544"></a><span class="s1">    return null</span>
<a id="__codelineno-1-545" name="__codelineno-1-545" href="#__codelineno-1-545"></a><span class="s1">~}}</span>
<a id="__codelineno-1-546" name="__codelineno-1-546" href="#__codelineno-1-546"></a>
<a id="__codelineno-1-547" name="__codelineno-1-547" href="#__codelineno-1-547"></a><span class="s1">{{#*inline "_jpmn-check-first-line-dict"}}</span>
<a id="__codelineno-1-548" name="__codelineno-1-548" href="#__codelineno-1-548"></a><span class="s1">    {{~#scope~}}</span>
<a id="__codelineno-1-549" name="__codelineno-1-549" href="#__codelineno-1-549"></a>
<a id="__codelineno-1-550" name="__codelineno-1-550" href="#__codelineno-1-550"></a><span class="s1">        {{~#set "rx-match-first-line-dict" ~}}</span>
<a id="__codelineno-1-551" name="__codelineno-1-551" href="#__codelineno-1-551"></a><span class="s1">            {{~#regexMatch (get "opt-first-line-dicts-regex") "u"~}}{{dictionary}}{{~/regexMatch~}}</span>
<a id="__codelineno-1-552" name="__codelineno-1-552" href="#__codelineno-1-552"></a><span class="s1">        {{/set~}}</span>
<a id="__codelineno-1-553" name="__codelineno-1-553" href="#__codelineno-1-553"></a>
<a id="__codelineno-1-554" name="__codelineno-1-554" href="#__codelineno-1-554"></a><span class="s1">        {{~#if (op "||"</span>
<a id="__codelineno-1-555" name="__codelineno-1-555" href="#__codelineno-1-555"></a><span class="s1">            (op "&amp;&amp;"</span>
<a id="__codelineno-1-556" name="__codelineno-1-556" href="#__codelineno-1-556"></a><span class="s1">                (op "===" (get "opt-first-line-regex-mode") "except")</span>
<a id="__codelineno-1-557" name="__codelineno-1-557" href="#__codelineno-1-557"></a><span class="s1">                (op "===" (get "rx-match-first-line-dict") "")</span>
<a id="__codelineno-1-558" name="__codelineno-1-558" href="#__codelineno-1-558"></a><span class="s1">            )</span>
<a id="__codelineno-1-559" name="__codelineno-1-559" href="#__codelineno-1-559"></a><span class="s1">            (op "&amp;&amp;"</span>
<a id="__codelineno-1-560" name="__codelineno-1-560" href="#__codelineno-1-560"></a><span class="s1">                (op "===" (get "opt-first-line-regex-mode") "only")</span>
<a id="__codelineno-1-561" name="__codelineno-1-561" href="#__codelineno-1-561"></a><span class="s1">                (op "!==" (get "rx-match-first-line-dict") "")</span>
<a id="__codelineno-1-562" name="__codelineno-1-562" href="#__codelineno-1-562"></a><span class="s1">            )</span>
<a id="__codelineno-1-563" name="__codelineno-1-563" href="#__codelineno-1-563"></a><span class="s1">        )</span>
<a id="__codelineno-1-564" name="__codelineno-1-564" href="#__codelineno-1-564"></a><span class="s1">        ~}}</span>
<a id="__codelineno-1-565" name="__codelineno-1-565" href="#__codelineno-1-565"></a><span class="s1">            true</span>
<a id="__codelineno-1-566" name="__codelineno-1-566" href="#__codelineno-1-566"></a><span class="s1">        {{~/if~}}</span>
<a id="__codelineno-1-567" name="__codelineno-1-567" href="#__codelineno-1-567"></a><span class="s1">    {{~/scope~}}</span>
<a id="__codelineno-1-568" name="__codelineno-1-568" href="#__codelineno-1-568"></a><span class="s1">{{~/inline~}}</span>
<a id="__codelineno-1-569" name="__codelineno-1-569" href="#__codelineno-1-569"></a>
<a id="__codelineno-1-570" name="__codelineno-1-570" href="#__codelineno-1-570"></a><span class="s1">{{~! custom glossary-single function for additional regex parsing per dictionary ~}}</span>
<a id="__codelineno-1-571" name="__codelineno-1-571" href="#__codelineno-1-571"></a><span class="s1">{{~! OVERRIDES brief and noDictionaryTag ~}}</span>
<a id="__codelineno-1-572" name="__codelineno-1-572" href="#__codelineno-1-572"></a><span class="s1">{{#*inline "_jpmn-glossary-single"}}</span>
<a id="__codelineno-1-573" name="__codelineno-1-573" href="#__codelineno-1-573"></a><span class="s1">    {{~#scope~}}</span>
<a id="__codelineno-1-574" name="__codelineno-1-574" href="#__codelineno-1-574"></a>
<a id="__codelineno-1-575" name="__codelineno-1-575" href="#__codelineno-1-575"></a><span class="s1">        {{~#if (op "===" dictionary "NHK日本語発音アクセント新辞典")~}}</span>
<a id="__codelineno-1-576" name="__codelineno-1-576" href="#__codelineno-1-576"></a><span class="s1">            {{~#regexReplace "&lt;br&gt;&lt;/span&gt; ・" "&lt;br&gt;&lt;/span&gt;" "g"~}}</span>
<a id="__codelineno-1-577" name="__codelineno-1-577" href="#__codelineno-1-577"></a><span class="s1">                {{~#regexReplace "&lt;br&gt; ・" "&lt;br&gt;" "g"~}}</span>
<a id="__codelineno-1-578" name="__codelineno-1-578" href="#__codelineno-1-578"></a><span class="s1">                    {{~&gt; _jpmn-glossary-single2 . ~}}</span>
<a id="__codelineno-1-579" name="__codelineno-1-579" href="#__codelineno-1-579"></a><span class="s1">                {{~/regexReplace~}}</span>
<a id="__codelineno-1-580" name="__codelineno-1-580" href="#__codelineno-1-580"></a><span class="s1">            {{~/regexReplace~}}</span>
<a id="__codelineno-1-581" name="__codelineno-1-581" href="#__codelineno-1-581"></a><span class="s1">        {{~else~}}</span>
<a id="__codelineno-1-582" name="__codelineno-1-582" href="#__codelineno-1-582"></a><span class="s1">            {{~&gt; _jpmn-glossary-single2 . ~}}</span>
<a id="__codelineno-1-583" name="__codelineno-1-583" href="#__codelineno-1-583"></a><span class="s1">        {{~/if~}}</span>
<a id="__codelineno-1-584" name="__codelineno-1-584" href="#__codelineno-1-584"></a>
<a id="__codelineno-1-585" name="__codelineno-1-585" href="#__codelineno-1-585"></a><span class="s1">    {{~/scope~}}</span>
<a id="__codelineno-1-586" name="__codelineno-1-586" href="#__codelineno-1-586"></a><span class="s1">{{/inline}}</span>
<a id="__codelineno-1-587" name="__codelineno-1-587" href="#__codelineno-1-587"></a>
<a id="__codelineno-1-588" name="__codelineno-1-588" href="#__codelineno-1-588"></a>
<a id="__codelineno-1-589" name="__codelineno-1-589" href="#__codelineno-1-589"></a>
<a id="__codelineno-1-590" name="__codelineno-1-590" href="#__codelineno-1-590"></a><span class="s1">{{~! custom glossary-single function to add custom html around the dictionary and tags ~}}</span>
<a id="__codelineno-1-591" name="__codelineno-1-591" href="#__codelineno-1-591"></a><span class="s1">{{#*inline "_jpmn-glossary-single2"}}</span>
<a id="__codelineno-1-592" name="__codelineno-1-592" href="#__codelineno-1-592"></a>
<a id="__codelineno-1-593" name="__codelineno-1-593" href="#__codelineno-1-593"></a><span class="s1">    {{~#scope~}}</span>
<a id="__codelineno-1-594" name="__codelineno-1-594" href="#__codelineno-1-594"></a>
<a id="__codelineno-1-595" name="__codelineno-1-595" href="#__codelineno-1-595"></a><span class="s1">        {{~#if (op "!" (get "opt__plaintext__enabled")) ~}}</span>
<a id="__codelineno-1-596" name="__codelineno-1-596" href="#__codelineno-1-596"></a>
<a id="__codelineno-1-597" name="__codelineno-1-597" href="#__codelineno-1-597"></a><span class="s1">            &lt;span class="dict-group__tag-list"&gt; {{~s~}}</span>
<a id="__codelineno-1-598" name="__codelineno-1-598" href="#__codelineno-1-598"></a>
<a id="__codelineno-1-599" name="__codelineno-1-599" href="#__codelineno-1-599"></a><span class="s1">                {{~#each definitionTags~}}</span>
<a id="__codelineno-1-600" name="__codelineno-1-600" href="#__codelineno-1-600"></a>
<a id="__codelineno-1-601" name="__codelineno-1-601" href="#__codelineno-1-601"></a><span class="s1">                    &lt;span class="dict-group__tag dict-group__tag--name"&gt; {{~s~}}</span>
<a id="__codelineno-1-602" name="__codelineno-1-602" href="#__codelineno-1-602"></a><span class="s1">                        &lt;span class="dict-group__tag-inner"&gt; {{~s~}}</span>
<a id="__codelineno-1-603" name="__codelineno-1-603" href="#__codelineno-1-603"></a><span class="s1">                            {{~name~}}</span>
<a id="__codelineno-1-604" name="__codelineno-1-604" href="#__codelineno-1-604"></a><span class="s1">                        &lt;/span&gt; {{~s~}}</span>
<a id="__codelineno-1-605" name="__codelineno-1-605" href="#__codelineno-1-605"></a><span class="s1">                    &lt;/span&gt; {{~s~}}</span>
<a id="__codelineno-1-606" name="__codelineno-1-606" href="#__codelineno-1-606"></a>
<a id="__codelineno-1-607" name="__codelineno-1-607" href="#__codelineno-1-607"></a><span class="s1">                {{~/each~}}</span>
<a id="__codelineno-1-608" name="__codelineno-1-608" href="#__codelineno-1-608"></a>
<a id="__codelineno-1-609" name="__codelineno-1-609" href="#__codelineno-1-609"></a><span class="s1">                &lt;span class="dict-group__tag dict-group__tag--dict"&gt; {{~s~}}</span>
<a id="__codelineno-1-610" name="__codelineno-1-610" href="#__codelineno-1-610"></a><span class="s1">                    &lt;span class="dict-group__tag-inner"&gt; {{~s~}}</span>
<a id="__codelineno-1-611" name="__codelineno-1-611" href="#__codelineno-1-611"></a><span class="s1">                        {{~dictionary~}}</span>
<a id="__codelineno-1-612" name="__codelineno-1-612" href="#__codelineno-1-612"></a><span class="s1">                    &lt;/span&gt; {{~s~}}</span>
<a id="__codelineno-1-613" name="__codelineno-1-613" href="#__codelineno-1-613"></a><span class="s1">                &lt;/span&gt; {{~s~}}</span>
<a id="__codelineno-1-614" name="__codelineno-1-614" href="#__codelineno-1-614"></a>
<a id="__codelineno-1-615" name="__codelineno-1-615" href="#__codelineno-1-615"></a><span class="s1">            &lt;/span&gt; {{~s~}}</span>
<a id="__codelineno-1-616" name="__codelineno-1-616" href="#__codelineno-1-616"></a>
<a id="__codelineno-1-617" name="__codelineno-1-617" href="#__codelineno-1-617"></a><span class="s1">        {{~else~}}</span>
<a id="__codelineno-1-618" name="__codelineno-1-618" href="#__codelineno-1-618"></a>
<a id="__codelineno-1-619" name="__codelineno-1-619" href="#__codelineno-1-619"></a><span class="s1">            {{~#scope~}}</span>
<a id="__codelineno-1-620" name="__codelineno-1-620" href="#__codelineno-1-620"></a><span class="s1">                {{~#set "any" false}}{{/set~}}</span>
<a id="__codelineno-1-621" name="__codelineno-1-621" href="#__codelineno-1-621"></a><span class="s1">                {{~#each definitionTags~}}</span>
<a id="__codelineno-1-622" name="__codelineno-1-622" href="#__codelineno-1-622"></a><span class="s1">                    {{~#if (get "any")}}, {{else}}({{/if~}}</span>
<a id="__codelineno-1-623" name="__codelineno-1-623" href="#__codelineno-1-623"></a><span class="s1">                    {{name}}</span>
<a id="__codelineno-1-624" name="__codelineno-1-624" href="#__codelineno-1-624"></a><span class="s1">                    {{~#set "any" true}}{{/set~}}</span>
<a id="__codelineno-1-625" name="__codelineno-1-625" href="#__codelineno-1-625"></a><span class="s1">                {{~/each~}}</span>
<a id="__codelineno-1-626" name="__codelineno-1-626" href="#__codelineno-1-626"></a><span class="s1">                {{~#if (op "!" (get "opt__plaintext__remove-dictionary-tag"))~}}</span>
<a id="__codelineno-1-627" name="__codelineno-1-627" href="#__codelineno-1-627"></a><span class="s1">                    {{~#if (get "any")}}, {{else}}({{/if~}}</span>
<a id="__codelineno-1-628" name="__codelineno-1-628" href="#__codelineno-1-628"></a><span class="s1">                    {{dictionary}}</span>
<a id="__codelineno-1-629" name="__codelineno-1-629" href="#__codelineno-1-629"></a><span class="s1">                    {{~#set "any" true}}{{/set~}}</span>
<a id="__codelineno-1-630" name="__codelineno-1-630" href="#__codelineno-1-630"></a><span class="s1">                {{~/if~}}</span>
<a id="__codelineno-1-631" name="__codelineno-1-631" href="#__codelineno-1-631"></a><span class="s1">                {{~#if (get "any")}}) {{/if~}}</span>
<a id="__codelineno-1-632" name="__codelineno-1-632" href="#__codelineno-1-632"></a><span class="s1">            {{~/scope~}}</span>
<a id="__codelineno-1-633" name="__codelineno-1-633" href="#__codelineno-1-633"></a><span class="s1">            {{~#if only~}}({{#each only}}{{.}}{{#unless @last}}, {{/unless}}{{/each}} only) {{/if~}}</span>
<a id="__codelineno-1-634" name="__codelineno-1-634" href="#__codelineno-1-634"></a>
<a id="__codelineno-1-635" name="__codelineno-1-635" href="#__codelineno-1-635"></a><span class="s1">        {{~/if~}}</span>
<a id="__codelineno-1-636" name="__codelineno-1-636" href="#__codelineno-1-636"></a>
<a id="__codelineno-1-637" name="__codelineno-1-637" href="#__codelineno-1-637"></a><span class="s1">        {{~#if (op "!" (get "opt__plaintext__enabled")) ~}}</span>
<a id="__codelineno-1-638" name="__codelineno-1-638" href="#__codelineno-1-638"></a><span class="s1">        &lt;span class="dict-group__glossary"&gt; {{~s~}}</span>
<a id="__codelineno-1-639" name="__codelineno-1-639" href="#__codelineno-1-639"></a><span class="s1">        {{~/if~}}</span>
<a id="__codelineno-1-640" name="__codelineno-1-640" href="#__codelineno-1-640"></a>
<a id="__codelineno-1-641" name="__codelineno-1-641" href="#__codelineno-1-641"></a><span class="s1">        {{~!</span>
<a id="__codelineno-1-642" name="__codelineno-1-642" href="#__codelineno-1-642"></a><span class="s1">            option to not wrap with spans because it may break dictionaries</span>
<a id="__codelineno-1-643" name="__codelineno-1-643" href="#__codelineno-1-643"></a><span class="s1">            (this is the hell that is parsing html with regex)</span>
<a id="__codelineno-1-644" name="__codelineno-1-644" href="#__codelineno-1-644"></a><span class="s1">        ~}}</span>
<a id="__codelineno-1-645" name="__codelineno-1-645" href="#__codelineno-1-645"></a><span class="s1">        {{~#if (op "&amp;&amp;"</span>
<a id="__codelineno-1-646" name="__codelineno-1-646" href="#__codelineno-1-646"></a><span class="s1">            (get "opt-wrap-first-line-spans")</span>
<a id="__codelineno-1-647" name="__codelineno-1-647" href="#__codelineno-1-647"></a><span class="s1">            (op "!" (get "opt__plaintext__enabled"))</span>
<a id="__codelineno-1-648" name="__codelineno-1-648" href="#__codelineno-1-648"></a><span class="s1">        )</span>
<a id="__codelineno-1-649" name="__codelineno-1-649" href="#__codelineno-1-649"></a><span class="s1">        }}</span>
<a id="__codelineno-1-650" name="__codelineno-1-650" href="#__codelineno-1-650"></a>
<a id="__codelineno-1-651" name="__codelineno-1-651" href="#__codelineno-1-651"></a><span class="s1">            {{~#set "modify-first-line" ~}}{{&gt; _jpmn-check-first-line-dict dictionary=dictionary }}{{~/set~}}</span>
<a id="__codelineno-1-652" name="__codelineno-1-652" href="#__codelineno-1-652"></a>
<a id="__codelineno-1-653" name="__codelineno-1-653" href="#__codelineno-1-653"></a><span class="s1">            {{~#if (get "modify-first-line") ~}}</span>
<a id="__codelineno-1-654" name="__codelineno-1-654" href="#__codelineno-1-654"></a><span class="s1">                {{~#regexReplace</span>
<a id="__codelineno-1-655" name="__codelineno-1-655" href="#__codelineno-1-655"></a><span class="s1">                        "^(&lt;span lang=\"ja\"&gt;)?(.*?)&lt;br&gt;"</span>
<a id="__codelineno-1-656" name="__codelineno-1-656" href="#__codelineno-1-656"></a><span class="s1">                        "$1&lt;span class=\"dict-group__glossary--first-line\"&gt;$2&lt;/span&gt;&lt;span class=\"dict-group__glossary--first-line-break\"&gt;&lt;br&gt;&lt;/span&gt;"</span>
<a id="__codelineno-1-657" name="__codelineno-1-657" href="#__codelineno-1-657"></a><span class="s1">                ~}}</span>
<a id="__codelineno-1-658" name="__codelineno-1-658" href="#__codelineno-1-658"></a><span class="s1">                    {{~&gt; _jpmn-glossary-single3 . ~}}</span>
<a id="__codelineno-1-659" name="__codelineno-1-659" href="#__codelineno-1-659"></a><span class="s1">                {{~/regexReplace~}}</span>
<a id="__codelineno-1-660" name="__codelineno-1-660" href="#__codelineno-1-660"></a><span class="s1">            {{~else~}}</span>
<a id="__codelineno-1-661" name="__codelineno-1-661" href="#__codelineno-1-661"></a><span class="s1">                {{~&gt; _jpmn-glossary-single3 . ~}}</span>
<a id="__codelineno-1-662" name="__codelineno-1-662" href="#__codelineno-1-662"></a><span class="s1">            {{~/if~}}</span>
<a id="__codelineno-1-663" name="__codelineno-1-663" href="#__codelineno-1-663"></a>
<a id="__codelineno-1-664" name="__codelineno-1-664" href="#__codelineno-1-664"></a><span class="s1">        {{~else if (get "opt__plaintext__remove-first-line-enabled")~}}</span>
<a id="__codelineno-1-665" name="__codelineno-1-665" href="#__codelineno-1-665"></a>
<a id="__codelineno-1-666" name="__codelineno-1-666" href="#__codelineno-1-666"></a><span class="s1">            {{~#set "modify-first-line" ~}}{{&gt; _jpmn-check-first-line-dict dictionary=dictionary }}{{~/set~}}</span>
<a id="__codelineno-1-667" name="__codelineno-1-667" href="#__codelineno-1-667"></a>
<a id="__codelineno-1-668" name="__codelineno-1-668" href="#__codelineno-1-668"></a><span class="s1">            {{~#if (get "modify-first-line") ~}}</span>
<a id="__codelineno-1-669" name="__codelineno-1-669" href="#__codelineno-1-669"></a><span class="s1">                {{~! none match means the dictionary is not an exception, i.e. replace newline ~}}</span>
<a id="__codelineno-1-670" name="__codelineno-1-670" href="#__codelineno-1-670"></a><span class="s1">                {{~#regexReplace</span>
<a id="__codelineno-1-671" name="__codelineno-1-671" href="#__codelineno-1-671"></a><span class="s1">                        "^(&lt;span lang=\"ja\"&gt;)?(.*?)&lt;br&gt;"</span>
<a id="__codelineno-1-672" name="__codelineno-1-672" href="#__codelineno-1-672"></a><span class="s1">                        "$1"</span>
<a id="__codelineno-1-673" name="__codelineno-1-673" href="#__codelineno-1-673"></a><span class="s1">                ~}}</span>
<a id="__codelineno-1-674" name="__codelineno-1-674" href="#__codelineno-1-674"></a><span class="s1">                    {{~&gt; _jpmn-glossary-single3 . ~}}</span>
<a id="__codelineno-1-675" name="__codelineno-1-675" href="#__codelineno-1-675"></a><span class="s1">                {{~/regexReplace~}}</span>
<a id="__codelineno-1-676" name="__codelineno-1-676" href="#__codelineno-1-676"></a><span class="s1">            {{~else~}}</span>
<a id="__codelineno-1-677" name="__codelineno-1-677" href="#__codelineno-1-677"></a><span class="s1">                {{~&gt; _jpmn-glossary-single3 . ~}}</span>
<a id="__codelineno-1-678" name="__codelineno-1-678" href="#__codelineno-1-678"></a><span class="s1">            {{~/if~}}</span>
<a id="__codelineno-1-679" name="__codelineno-1-679" href="#__codelineno-1-679"></a>
<a id="__codelineno-1-680" name="__codelineno-1-680" href="#__codelineno-1-680"></a><span class="s1">        {{~else~}}</span>
<a id="__codelineno-1-681" name="__codelineno-1-681" href="#__codelineno-1-681"></a><span class="s1">            {{~&gt; _jpmn-glossary-single3 . ~}}</span>
<a id="__codelineno-1-682" name="__codelineno-1-682" href="#__codelineno-1-682"></a><span class="s1">        {{~/if~}}</span>
<a id="__codelineno-1-683" name="__codelineno-1-683" href="#__codelineno-1-683"></a>
<a id="__codelineno-1-684" name="__codelineno-1-684" href="#__codelineno-1-684"></a><span class="s1">        {{~#if (op "!" (get "opt__plaintext__enabled")) ~}}</span>
<a id="__codelineno-1-685" name="__codelineno-1-685" href="#__codelineno-1-685"></a><span class="s1">        &lt;/span&gt; {{~s~}}</span>
<a id="__codelineno-1-686" name="__codelineno-1-686" href="#__codelineno-1-686"></a><span class="s1">        {{~/if~}}</span>
<a id="__codelineno-1-687" name="__codelineno-1-687" href="#__codelineno-1-687"></a>
<a id="__codelineno-1-688" name="__codelineno-1-688" href="#__codelineno-1-688"></a><span class="s1">    {{~/scope~}}</span>
<a id="__codelineno-1-689" name="__codelineno-1-689" href="#__codelineno-1-689"></a>
<a id="__codelineno-1-690" name="__codelineno-1-690" href="#__codelineno-1-690"></a><span class="s1">    {{~#if only~}}({{#each only}}{{.}}{{#unless @last}}, {{/unless}}{{/each}} only) {{/if~}}</span>
<a id="__codelineno-1-691" name="__codelineno-1-691" href="#__codelineno-1-691"></a><span class="s1">{{/inline}}</span>
<a id="__codelineno-1-692" name="__codelineno-1-692" href="#__codelineno-1-692"></a>
<a id="__codelineno-1-693" name="__codelineno-1-693" href="#__codelineno-1-693"></a>
<a id="__codelineno-1-694" name="__codelineno-1-694" href="#__codelineno-1-694"></a>
<a id="__codelineno-1-695" name="__codelineno-1-695" href="#__codelineno-1-695"></a>
<a id="__codelineno-1-696" name="__codelineno-1-696" href="#__codelineno-1-696"></a><span class="s1">{{#*inline "_jpmn-glossary-single3"}}</span>
<a id="__codelineno-1-697" name="__codelineno-1-697" href="#__codelineno-1-697"></a>
<a id="__codelineno-1-698" name="__codelineno-1-698" href="#__codelineno-1-698"></a><span class="s1">    {{~#scope~}}</span>
<a id="__codelineno-1-699" name="__codelineno-1-699" href="#__codelineno-1-699"></a>
<a id="__codelineno-1-700" name="__codelineno-1-700" href="#__codelineno-1-700"></a><span class="s1">        {{~#if (op "&amp;&amp;"</span>
<a id="__codelineno-1-701" name="__codelineno-1-701" href="#__codelineno-1-701"></a><span class="s1">            (op "===" (get "opt-jmdict-list-format") true)</span>
<a id="__codelineno-1-702" name="__codelineno-1-702" href="#__codelineno-1-702"></a><span class="s1">            (op "||"</span>
<a id="__codelineno-1-703" name="__codelineno-1-703" href="#__codelineno-1-703"></a><span class="s1">                (op "===" dictionary "JMdict (English)")</span>
<a id="__codelineno-1-704" name="__codelineno-1-704" href="#__codelineno-1-704"></a><span class="s1">                (op "||"</span>
<a id="__codelineno-1-705" name="__codelineno-1-705" href="#__codelineno-1-705"></a><span class="s1">                    (op "===" dictionary "JMdict Extra")</span>
<a id="__codelineno-1-706" name="__codelineno-1-706" href="#__codelineno-1-706"></a><span class="s1">                    (op "===" dictionary "JMdict")</span>
<a id="__codelineno-1-707" name="__codelineno-1-707" href="#__codelineno-1-707"></a><span class="s1">                )</span>
<a id="__codelineno-1-708" name="__codelineno-1-708" href="#__codelineno-1-708"></a><span class="s1">            )</span>
<a id="__codelineno-1-709" name="__codelineno-1-709" href="#__codelineno-1-709"></a><span class="s1">        )</span>
<a id="__codelineno-1-710" name="__codelineno-1-710" href="#__codelineno-1-710"></a><span class="s1">        ~}}</span>
<a id="__codelineno-1-711" name="__codelineno-1-711" href="#__codelineno-1-711"></a><span class="s1">            {{~#if (op "&lt;=" glossary.length 1)~}}</span>
<a id="__codelineno-1-712" name="__codelineno-1-712" href="#__codelineno-1-712"></a><span class="s1">                {{#each glossary}}{{#formatGlossary ../dictionary}}{{{.}}}{{/formatGlossary}}{{/each}}</span>
<a id="__codelineno-1-713" name="__codelineno-1-713" href="#__codelineno-1-713"></a><span class="s1">            {{~else~}}</span>
<a id="__codelineno-1-714" name="__codelineno-1-714" href="#__codelineno-1-714"></a><span class="s1">                &lt;ul&gt;{{#each glossary}}&lt;li&gt;{{#formatGlossary ../dictionary}}{{{.}}}{{/formatGlossary}}&lt;/li&gt;{{/each}}&lt;/ul&gt;</span>
<a id="__codelineno-1-715" name="__codelineno-1-715" href="#__codelineno-1-715"></a><span class="s1">            {{~/if~}}</span>
<a id="__codelineno-1-716" name="__codelineno-1-716" href="#__codelineno-1-716"></a><span class="s1">        {{~else~}}</span>
<a id="__codelineno-1-717" name="__codelineno-1-717" href="#__codelineno-1-717"></a><span class="s1">            {{~#each glossary}}{{#formatGlossary ../dictionary}}{{{.}}}{{/formatGlossary}}{{#unless @last}} | {{/unless}}{{/each~}}</span>
<a id="__codelineno-1-718" name="__codelineno-1-718" href="#__codelineno-1-718"></a><span class="s1">        {{~/if~}}</span>
<a id="__codelineno-1-719" name="__codelineno-1-719" href="#__codelineno-1-719"></a>
<a id="__codelineno-1-720" name="__codelineno-1-720" href="#__codelineno-1-720"></a><span class="s1">    {{~/scope~}}</span>
<a id="__codelineno-1-721" name="__codelineno-1-721" href="#__codelineno-1-721"></a>
<a id="__codelineno-1-722" name="__codelineno-1-722" href="#__codelineno-1-722"></a><span class="s1">{{/inline}}</span>
<a id="__codelineno-1-723" name="__codelineno-1-723" href="#__codelineno-1-723"></a>
<a id="__codelineno-1-724" name="__codelineno-1-724" href="#__codelineno-1-724"></a>
<a id="__codelineno-1-725" name="__codelineno-1-725" href="#__codelineno-1-725"></a>
<a id="__codelineno-1-726" name="__codelineno-1-726" href="#__codelineno-1-726"></a>
<a id="__codelineno-1-727" name="__codelineno-1-727" href="#__codelineno-1-727"></a>
<a id="__codelineno-1-728" name="__codelineno-1-728" href="#__codelineno-1-728"></a><span class="s1">{{~!</span>
<a id="__codelineno-1-729" name="__codelineno-1-729" href="#__codelineno-1-729"></a><span class="s1">    =============</span>
<a id="__codelineno-1-730" name="__codelineno-1-730" href="#__codelineno-1-730"></a><span class="s1">     frequencies</span>
<a id="__codelineno-1-731" name="__codelineno-1-731" href="#__codelineno-1-731"></a><span class="s1">    =============</span>
<a id="__codelineno-1-732" name="__codelineno-1-732" href="#__codelineno-1-732"></a><span class="s1">~}}</span>
<a id="__codelineno-1-733" name="__codelineno-1-733" href="#__codelineno-1-733"></a>
<a id="__codelineno-1-734" name="__codelineno-1-734" href="#__codelineno-1-734"></a><span class="s1">{{#*inline "jpmn-frequencies"}}</span>
<a id="__codelineno-1-735" name="__codelineno-1-735" href="#__codelineno-1-735"></a><span class="s1">    {{~#if (op "&gt;" definition.frequencies.length 0)~}}</span>
<a id="__codelineno-1-736" name="__codelineno-1-736" href="#__codelineno-1-736"></a><span class="s1">        {{~#each definition.frequencies~}}</span>
<a id="__codelineno-1-737" name="__codelineno-1-737" href="#__codelineno-1-737"></a><span class="s1">            &lt;div class="frequencies__group" data-details="{{~dictionary~}}"&gt; {{~s~}}</span>
<a id="__codelineno-1-738" name="__codelineno-1-738" href="#__codelineno-1-738"></a><span class="s1">                &lt;div class="frequencies__number"&gt; {{~s~}}</span>
<a id="__codelineno-1-739" name="__codelineno-1-739" href="#__codelineno-1-739"></a><span class="s1">                    &lt;span class="frequencies__number-inner"&gt; {{~s~}}</span>
<a id="__codelineno-1-740" name="__codelineno-1-740" href="#__codelineno-1-740"></a><span class="s1">                        {{~! removes the "X" in JPDB'</span><span class="nv">s</span> <span class="nv">frequency</span> <span class="nv">and</span> <span class="nv">replaces</span> <span class="nv">it</span> <span class="nv">with</span> <span class="nv">a</span> <span class="nv">less</span> <span class="nv">assuming</span> <span class="nv">character</span>
<a id="__codelineno-1-741" name="__codelineno-1-741" href="#__codelineno-1-741"></a>                            <span class="nv">(it</span> <span class="nv">interferes</span> <span class="nv">with</span> <span class="nv">the</span> <span class="nv">color</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">card</span><span class="err">,</span> <span class="nv">since</span> <span class="nv">you</span> <span class="nv">see</span> <span class="nv">red</span>
<a id="__codelineno-1-742" name="__codelineno-1-742" href="#__codelineno-1-742"></a>                            <span class="nv">at</span> <span class="nv">the</span> <span class="nv">top</span> <span class="nv">corner</span> <span class="nv">which</span> <span class="nv">is</span> <span class="nv">somewhat</span> <span class="nv">distracting)</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-743" name="__codelineno-1-743" href="#__codelineno-1-743"></a><span class="x">                        </span><span class="cp">{{</span><span class="m m-Attribute">~#regexReplace</span> <span class="s2">"❌"</span> <span class="s2">"✖"</span> <span class="s2">"g"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-744" name="__codelineno-1-744" href="#__codelineno-1-744"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~frequency~</span><span class="cp">}}</span>
<a id="__codelineno-1-745" name="__codelineno-1-745" href="#__codelineno-1-745"></a><span class="x">                        </span><span class="cp">{{</span><span class="m m-Attribute">~/regexReplace~</span><span class="cp">}}</span>
<a id="__codelineno-1-746" name="__codelineno-1-746" href="#__codelineno-1-746"></a><span class="x">                    &lt;/span&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-747" name="__codelineno-1-747" href="#__codelineno-1-747"></a><span class="x">                &lt;/div&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-748" name="__codelineno-1-748" href="#__codelineno-1-748"></a><span class="x">                &lt;div class="frequencies__dictionary"&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-749" name="__codelineno-1-749" href="#__codelineno-1-749"></a><span class="x">                    &lt;span class="frequencies__dictionary-inner"&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-750" name="__codelineno-1-750" href="#__codelineno-1-750"></a><span class="x">                        </span><span class="cp">{{</span><span class="m m-Attribute">~dictionary~</span><span class="cp">}}</span>
<a id="__codelineno-1-751" name="__codelineno-1-751" href="#__codelineno-1-751"></a><span class="x">                    &lt;/span&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-752" name="__codelineno-1-752" href="#__codelineno-1-752"></a><span class="x">                &lt;/div&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-753" name="__codelineno-1-753" href="#__codelineno-1-753"></a><span class="x">            &lt;/div&gt;</span>
<a id="__codelineno-1-754" name="__codelineno-1-754" href="#__codelineno-1-754"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-755" name="__codelineno-1-755" href="#__codelineno-1-755"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-756" name="__codelineno-1-756" href="#__codelineno-1-756"></a><span class="cp">{{</span><span class="m m-Attribute">/inline</span><span class="cp">}}</span>
<a id="__codelineno-1-757" name="__codelineno-1-757" href="#__codelineno-1-757"></a>
<a id="__codelineno-1-758" name="__codelineno-1-758" href="#__codelineno-1-758"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">base</span> <span class="nv">code</span> <span class="nv">taken</span> <span class="nv">from</span><span class="err">:</span> <span class="nv">https</span><span class="err">:</span><span class="nv">//github.com/MarvNC/JP-Resources</span><span class="err">#</span><span class="nv">sorting-mined-anki-cards-by-frequency</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-759" name="__codelineno-1-759" href="#__codelineno-1-759"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">NOTE</span><span class="err">:</span> <span class="nv">THIS</span> <span class="nv">IS</span> <span class="nv">ONLY</span> <span class="nv">KEPT</span> <span class="nv">FOR</span> <span class="nv">LEGACY</span> <span class="nv">PURPOSES</span><span class="err">,</span> <span class="nv">and</span> <span class="nv">is</span> <span class="nv">now</span> <span class="nv">deprecated</span><span class="err">.</span> <span class="nv">Please</span> <span class="nv">use</span> <span class="err">{</span><span class="nv">jpmn-frequency-sort</span><span class="err">}</span> <span class="nv">instead</span><span class="err">.</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-760" name="__codelineno-1-760" href="#__codelineno-1-760"></a><span class="cp">{{</span><span class="m m-Attribute">~#*inline</span> <span class="s2">"jpmn-min-freq"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-761" name="__codelineno-1-761" href="#__codelineno-1-761"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-762" name="__codelineno-1-762" href="#__codelineno-1-762"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"min-freq"</span> <span class="m">0~</span><span class="cp">}}{{</span><span class="m m-Attribute">~/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-763" name="__codelineno-1-763" href="#__codelineno-1-763"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#each</span> <span class="nv">definition.frequencies</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-764" name="__codelineno-1-764" href="#__codelineno-1-764"></a>
<a id="__codelineno-1-765" name="__codelineno-1-765" href="#__codelineno-1-765"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"rx-match-ignored-freq"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-766" name="__codelineno-1-766" href="#__codelineno-1-766"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~#regexMatch</span> <span class="nv">(get</span> <span class="s2">"ignored-freq-dict-regex"</span><span class="nv">)</span> <span class="s2">"gu"</span><span class="m">~</span><span class="cp">}}{{</span><span class="nv">this.dictionary</span><span class="cp">}}{{</span><span class="m m-Attribute">~/regexMatch~</span><span class="cp">}}</span>
<a id="__codelineno-1-767" name="__codelineno-1-767" href="#__codelineno-1-767"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-768" name="__codelineno-1-768" href="#__codelineno-1-768"></a>
<a id="__codelineno-1-769" name="__codelineno-1-769" href="#__codelineno-1-769"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span>
<a id="__codelineno-1-770" name="__codelineno-1-770" href="#__codelineno-1-770"></a>                    <span class="nv">(op</span> <span class="s2">"&amp;&amp;"</span>
<a id="__codelineno-1-771" name="__codelineno-1-771" href="#__codelineno-1-771"></a>                        <span class="nv">(op</span> <span class="s2">"||"</span>
<a id="__codelineno-1-772" name="__codelineno-1-772" href="#__codelineno-1-772"></a>                            <span class="nv">(op</span> <span class="na">"==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">min-freq</span><span class="s2">") 0)</span>
<a id="__codelineno-1-773" name="__codelineno-1-773" href="#__codelineno-1-773"></a><span class="s2">                            (op "</span><span class="err">&gt;</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" (get "</span><span class="nv">min-freq</span><span class="s2">")) (op "</span><span class="err">+</span><span class="s2">" (regexMatch "</span><span class="err">\</span><span class="nv">d</span><span class="s2">" "</span><span class="nv">g</span><span class="s2">" this.frequency)))</span>
<a id="__codelineno-1-774" name="__codelineno-1-774" href="#__codelineno-1-774"></a><span class="s2">                        )</span>
<a id="__codelineno-1-775" name="__codelineno-1-775" href="#__codelineno-1-775"></a><span class="s2">                        (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-ignored-freq</span><span class="s2">") "")</span>
<a id="__codelineno-1-776" name="__codelineno-1-776" href="#__codelineno-1-776"></a><span class="s2">                    )</span>
<a id="__codelineno-1-777" name="__codelineno-1-777" href="#__codelineno-1-777"></a><span class="s2">                ~}}</span>
<a id="__codelineno-1-778" name="__codelineno-1-778" href="#__codelineno-1-778"></a><span class="s2">                    {{~#set "</span><span class="nv">min-freq</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" (regexMatch "</span><span class="err">\</span><span class="nv">d</span><span class="s2">" "</span><span class="nv">g</span><span class="s2">" this.frequency))}}{{/set~}}</span>
<a id="__codelineno-1-779" name="__codelineno-1-779" href="#__codelineno-1-779"></a><span class="s2">                {{~/if~}}</span>
<a id="__codelineno-1-780" name="__codelineno-1-780" href="#__codelineno-1-780"></a><span class="s2">            {{~/each~}}</span>
<a id="__codelineno-1-781" name="__codelineno-1-781" href="#__codelineno-1-781"></a><span class="s2">        {{~get "</span><span class="nv">min-freq</span><span class="s2">"~}}</span>
<a id="__codelineno-1-782" name="__codelineno-1-782" href="#__codelineno-1-782"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-783" name="__codelineno-1-783" href="#__codelineno-1-783"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-784" name="__codelineno-1-784" href="#__codelineno-1-784"></a>
<a id="__codelineno-1-785" name="__codelineno-1-785" href="#__codelineno-1-785"></a>
<a id="__codelineno-1-786" name="__codelineno-1-786" href="#__codelineno-1-786"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-frequency-sort</span><span class="s2">"}}</span>
<a id="__codelineno-1-787" name="__codelineno-1-787" href="#__codelineno-1-787"></a><span class="s2">    {{~! Frequency sort handlebars: v23.03.13.1 ~}}</span>
<a id="__codelineno-1-788" name="__codelineno-1-788" href="#__codelineno-1-788"></a><span class="s2">    {{~! The latest version can be found at https://github.com/MarvNC/JP-Resources#freq-handlebar ~}}</span>
<a id="__codelineno-1-789" name="__codelineno-1-789" href="#__codelineno-1-789"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-790" name="__codelineno-1-790" href="#__codelineno-1-790"></a>
<a id="__codelineno-1-791" name="__codelineno-1-791" href="#__codelineno-1-791"></a><span class="s2">        {{~! Do not change the code below unless you know what you are doing. ~}}</span>
<a id="__codelineno-1-792" name="__codelineno-1-792" href="#__codelineno-1-792"></a><span class="s2">        {{~set "</span><span class="nv">result-freq</span><span class="s2">" -1 ~}} {{~! -1 is chosen because no frequency dictionaries should have an entry as -1 ~}}</span>
<a id="__codelineno-1-793" name="__codelineno-1-793" href="#__codelineno-1-793"></a><span class="s2">        {{~set "</span><span class="nv">prev-freq-dict</span><span class="s2">" "" ~}}</span>
<a id="__codelineno-1-794" name="__codelineno-1-794" href="#__codelineno-1-794"></a><span class="s2">        {{~set "</span><span class="nv">t</span><span class="s2">" 1 ~}}</span>
<a id="__codelineno-1-795" name="__codelineno-1-795" href="#__codelineno-1-795"></a><span class="s2">        {{~set "</span><span class="nv">found-grammar-dict</span><span class="s2">" false ~}}</span>
<a id="__codelineno-1-796" name="__codelineno-1-796" href="#__codelineno-1-796"></a>
<a id="__codelineno-1-797" name="__codelineno-1-797" href="#__codelineno-1-797"></a><span class="s2">        {{~! search for grammar dictionary ~}}</span>
<a id="__codelineno-1-798" name="__codelineno-1-798" href="#__codelineno-1-798"></a><span class="s2">        {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-799" name="__codelineno-1-799" href="#__codelineno-1-799"></a><span class="s2">            {{~#set "</span><span class="nv">rx-match-grammar-dicts</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-800" name="__codelineno-1-800" href="#__codelineno-1-800"></a><span class="s2">                {{~#regexMatch (get "</span><span class="nv">opt-grammar-override-dict-regex</span><span class="s2">") "</span><span class="nv">u</span><span class="s2">"~}}{{this.dictionary}}{{~/regexMatch~}}</span>
<a id="__codelineno-1-801" name="__codelineno-1-801" href="#__codelineno-1-801"></a><span class="s2">            {{/set~}}</span>
<a id="__codelineno-1-802" name="__codelineno-1-802" href="#__codelineno-1-802"></a><span class="s2">            {{~! rx-match-grammar-dicts is not empty if a grammar dictionary was found ~}}</span>
<a id="__codelineno-1-803" name="__codelineno-1-803" href="#__codelineno-1-803"></a><span class="s2">            {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-grammar-dicts</span><span class="s2">") "") ~}}</span>
<a id="__codelineno-1-804" name="__codelineno-1-804" href="#__codelineno-1-804"></a><span class="s2">                {{~set "</span><span class="nv">found-grammar-dict</span><span class="s2">" true ~}}</span>
<a id="__codelineno-1-805" name="__codelineno-1-805" href="#__codelineno-1-805"></a><span class="s2">            {{/if~}}</span>
<a id="__codelineno-1-806" name="__codelineno-1-806" href="#__codelineno-1-806"></a><span class="s2">        {{~/each~}}</span>
<a id="__codelineno-1-807" name="__codelineno-1-807" href="#__codelineno-1-807"></a>
<a id="__codelineno-1-808" name="__codelineno-1-808" href="#__codelineno-1-808"></a><span class="s2">        {{~! Additional case when "</span><span class="nv">Result</span> <span class="nv">grouping</span> <span class="nv">mode</span><span class="s2">" is set to "</span><span class="nv">No</span> <span class="nv">Grouping</span><span class="s2">"~}}</span>
<a id="__codelineno-1-809" name="__codelineno-1-809" href="#__codelineno-1-809"></a><span class="s2">        {{~#set "</span><span class="nv">rx-match-grammar-dicts</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-810" name="__codelineno-1-810" href="#__codelineno-1-810"></a><span class="s2">            {{~#regexMatch (get "</span><span class="nv">opt-grammar-override-dict-regex</span><span class="s2">") "</span><span class="nv">u</span><span class="s2">"~}}{{this.definition.dictionary}}{{~/regexMatch~}}</span>
<a id="__codelineno-1-811" name="__codelineno-1-811" href="#__codelineno-1-811"></a><span class="s2">        {{/set~}}</span>
<a id="__codelineno-1-812" name="__codelineno-1-812" href="#__codelineno-1-812"></a><span class="s2">        {{~! rx-match-grammar-dicts is not empty if a grammar dictionary was found ~}}</span>
<a id="__codelineno-1-813" name="__codelineno-1-813" href="#__codelineno-1-813"></a><span class="s2">        {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-grammar-dicts</span><span class="s2">") "") ~}}</span>
<a id="__codelineno-1-814" name="__codelineno-1-814" href="#__codelineno-1-814"></a><span class="s2">            {{~set "</span><span class="nv">found-grammar-dict</span><span class="s2">" true ~}}</span>
<a id="__codelineno-1-815" name="__codelineno-1-815" href="#__codelineno-1-815"></a><span class="s2">        {{/if~}}</span>
<a id="__codelineno-1-816" name="__codelineno-1-816" href="#__codelineno-1-816"></a>
<a id="__codelineno-1-817" name="__codelineno-1-817" href="#__codelineno-1-817"></a><span class="s2">        {{~#each definition.frequencies~}}</span>
<a id="__codelineno-1-818" name="__codelineno-1-818" href="#__codelineno-1-818"></a>
<a id="__codelineno-1-819" name="__codelineno-1-819" href="#__codelineno-1-819"></a><span class="s2">            {{~! rx-match-ignored-freq is not empty if ignored &lt;=&gt; rx-match-ignored-freq is empty if not ignored ~}}</span>
<a id="__codelineno-1-820" name="__codelineno-1-820" href="#__codelineno-1-820"></a><span class="s2">            {{~#set "</span><span class="nv">rx-match-ignored-freq</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-821" name="__codelineno-1-821" href="#__codelineno-1-821"></a><span class="s2">                {{~#regexMatch (get "</span><span class="nv">opt-ignored-freq-dict-regex</span><span class="s2">") "</span><span class="nv">u</span><span class="s2">"~}}{{this.dictionary}}{{~/regexMatch~}}</span>
<a id="__codelineno-1-822" name="__codelineno-1-822" href="#__codelineno-1-822"></a><span class="s2">            {{/set~}}</span>
<a id="__codelineno-1-823" name="__codelineno-1-823" href="#__codelineno-1-823"></a>
<a id="__codelineno-1-824" name="__codelineno-1-824" href="#__codelineno-1-824"></a><span class="s2">            {{~#set "</span><span class="nv">rx-match-ignored-value</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-825" name="__codelineno-1-825" href="#__codelineno-1-825"></a><span class="s2">                {{~#regexMatch (get "</span><span class="nv">opt-ignored-freq-value-regex</span><span class="s2">") "</span><span class="nv">u</span><span class="s2">"~}}{{this.frequency}}{{~/regexMatch~}}</span>
<a id="__codelineno-1-826" name="__codelineno-1-826" href="#__codelineno-1-826"></a><span class="s2">            {{/set~}}</span>
<a id="__codelineno-1-827" name="__codelineno-1-827" href="#__codelineno-1-827"></a><span class="s2">            {{~#if (op "</span><span class="err">&amp;&amp;</span><span class="s2">" (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-ignored-freq</span><span class="s2">") "") (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-ignored-value</span><span class="s2">") ""))~}}</span>
<a id="__codelineno-1-828" name="__codelineno-1-828" href="#__codelineno-1-828"></a>
<a id="__codelineno-1-829" name="__codelineno-1-829" href="#__codelineno-1-829"></a><span class="s2">                {{~!</span>
<a id="__codelineno-1-830" name="__codelineno-1-830" href="#__codelineno-1-830"></a><span class="s2">                    only uses the 1st frequency of any dictionary.</span>
<a id="__codelineno-1-831" name="__codelineno-1-831" href="#__codelineno-1-831"></a><span class="s2">                    For example, if JPDB lists 440 and 26189㋕, only the first 440 will be used.</span>
<a id="__codelineno-1-832" name="__codelineno-1-832" href="#__codelineno-1-832"></a><span class="s2">                ~}}</span>
<a id="__codelineno-1-833" name="__codelineno-1-833" href="#__codelineno-1-833"></a><span class="s2">                {{~set "</span><span class="nv">read-freq</span><span class="s2">" false ~}}</span>
<a id="__codelineno-1-834" name="__codelineno-1-834" href="#__codelineno-1-834"></a><span class="s2">                {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">prev-freq-dict</span><span class="s2">") this.dictionary ) ~}}</span>
<a id="__codelineno-1-835" name="__codelineno-1-835" href="#__codelineno-1-835"></a><span class="s2">                    {{~set "</span><span class="nv">read-freq</span><span class="s2">" true ~}}</span>
<a id="__codelineno-1-836" name="__codelineno-1-836" href="#__codelineno-1-836"></a><span class="s2">                    {{~set "</span><span class="nv">prev-freq-dict</span><span class="s2">" this.dictionary ~}}</span>
<a id="__codelineno-1-837" name="__codelineno-1-837" href="#__codelineno-1-837"></a><span class="s2">                {{/if~}}</span>
<a id="__codelineno-1-838" name="__codelineno-1-838" href="#__codelineno-1-838"></a>
<a id="__codelineno-1-839" name="__codelineno-1-839" href="#__codelineno-1-839"></a><span class="s2">                {{~#if (op "</span><span class="err">!</span><span class="s2">" (get "</span><span class="nv">read-freq</span><span class="s2">") ) ~}}</span>
<a id="__codelineno-1-840" name="__codelineno-1-840" href="#__codelineno-1-840"></a><span class="s2">                    {{~#set "</span><span class="nv">rx-match-keep-freqs</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-841" name="__codelineno-1-841" href="#__codelineno-1-841"></a><span class="s2">                        {{~#regexMatch (get "</span><span class="nv">opt-keep-freqs-past-first-regex</span><span class="s2">") "</span><span class="nv">u</span><span class="s2">"~}}{{this.dictionary}}{{~/regexMatch~}}</span>
<a id="__codelineno-1-842" name="__codelineno-1-842" href="#__codelineno-1-842"></a><span class="s2">                    {{/set~}}</span>
<a id="__codelineno-1-843" name="__codelineno-1-843" href="#__codelineno-1-843"></a>
<a id="__codelineno-1-844" name="__codelineno-1-844" href="#__codelineno-1-844"></a><span class="s2">                    {{~! rx-match-keep-freqs is not empty if keep freqs ~}}</span>
<a id="__codelineno-1-845" name="__codelineno-1-845" href="#__codelineno-1-845"></a><span class="s2">                    {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-keep-freqs</span><span class="s2">") "") ~}}</span>
<a id="__codelineno-1-846" name="__codelineno-1-846" href="#__codelineno-1-846"></a><span class="s2">                        {{~set "</span><span class="nv">read-freq</span><span class="s2">" true ~}}</span>
<a id="__codelineno-1-847" name="__codelineno-1-847" href="#__codelineno-1-847"></a><span class="s2">                    {{/if~}}</span>
<a id="__codelineno-1-848" name="__codelineno-1-848" href="#__codelineno-1-848"></a><span class="s2">                {{/if~}}</span>
<a id="__codelineno-1-849" name="__codelineno-1-849" href="#__codelineno-1-849"></a>
<a id="__codelineno-1-850" name="__codelineno-1-850" href="#__codelineno-1-850"></a><span class="s2">                {{~#if (get "</span><span class="nv">read-freq</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-851" name="__codelineno-1-851" href="#__codelineno-1-851"></a><span class="s2">                    {{~set "</span><span class="nv">f</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" (regexMatch "</span><span class="err">\</span><span class="nv">d</span><span class="err">+</span><span class="s2">" "" this.frequency)) ~}}</span>
<a id="__codelineno-1-852" name="__codelineno-1-852" href="#__codelineno-1-852"></a>
<a id="__codelineno-1-853" name="__codelineno-1-853" href="#__codelineno-1-853"></a><span class="s2">                    {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-freq-sorting-method</span><span class="s2">") "</span><span class="nv">min</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-854" name="__codelineno-1-854" href="#__codelineno-1-854"></a><span class="s2">                        {{~#if</span>
<a id="__codelineno-1-855" name="__codelineno-1-855" href="#__codelineno-1-855"></a><span class="s2">                            (op "</span><span class="err">||</span><span class="s2">"</span>
<a id="__codelineno-1-856" name="__codelineno-1-856" href="#__codelineno-1-856"></a><span class="s2">                                (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result-freq</span><span class="s2">") -1)</span>
<a id="__codelineno-1-857" name="__codelineno-1-857" href="#__codelineno-1-857"></a><span class="s2">                                (op "</span><span class="err">&gt;</span><span class="s2">" (get "</span><span class="nv">result-freq</span><span class="s2">") (get "</span><span class="nv">f</span><span class="s2">"))</span>
<a id="__codelineno-1-858" name="__codelineno-1-858" href="#__codelineno-1-858"></a><span class="s2">                            )</span>
<a id="__codelineno-1-859" name="__codelineno-1-859" href="#__codelineno-1-859"></a><span class="s2">                        ~}}</span>
<a id="__codelineno-1-860" name="__codelineno-1-860" href="#__codelineno-1-860"></a><span class="s2">                            {{~set "</span><span class="nv">result-freq</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" (get "</span><span class="nv">f</span><span class="s2">")) ~}}</span>
<a id="__codelineno-1-861" name="__codelineno-1-861" href="#__codelineno-1-861"></a><span class="s2">                        {{~/if~}}</span>
<a id="__codelineno-1-862" name="__codelineno-1-862" href="#__codelineno-1-862"></a>
<a id="__codelineno-1-863" name="__codelineno-1-863" href="#__codelineno-1-863"></a><span class="s2">                    {{~else if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-freq-sorting-method</span><span class="s2">") "</span><span class="nv">first</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-864" name="__codelineno-1-864" href="#__codelineno-1-864"></a><span class="s2">                        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result-freq</span><span class="s2">") -1) ~}}</span>
<a id="__codelineno-1-865" name="__codelineno-1-865" href="#__codelineno-1-865"></a><span class="s2">                            {{~set "</span><span class="nv">result-freq</span><span class="s2">" (get "</span><span class="nv">f</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-866" name="__codelineno-1-866" href="#__codelineno-1-866"></a><span class="s2">                        {{~/if~}}</span>
<a id="__codelineno-1-867" name="__codelineno-1-867" href="#__codelineno-1-867"></a>
<a id="__codelineno-1-868" name="__codelineno-1-868" href="#__codelineno-1-868"></a><span class="s2">                    {{~else if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-freq-sorting-method</span><span class="s2">") "</span><span class="nv">avg</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-869" name="__codelineno-1-869" href="#__codelineno-1-869"></a>
<a id="__codelineno-1-870" name="__codelineno-1-870" href="#__codelineno-1-870"></a><span class="s2">                        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result-freq</span><span class="s2">") -1) ~}}</span>
<a id="__codelineno-1-871" name="__codelineno-1-871" href="#__codelineno-1-871"></a><span class="s2">                            {{~set "</span><span class="nv">result-freq</span><span class="s2">" (get "</span><span class="nv">f</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-872" name="__codelineno-1-872" href="#__codelineno-1-872"></a><span class="s2">                        {{~else~}}</span>
<a id="__codelineno-1-873" name="__codelineno-1-873" href="#__codelineno-1-873"></a><span class="s2">                            {{~!</span>
<a id="__codelineno-1-874" name="__codelineno-1-874" href="#__codelineno-1-874"></a><span class="s2">                                iterative mean formula (to prevent floating point overflow):</span>
<a id="__codelineno-1-875" name="__codelineno-1-875" href="#__codelineno-1-875"></a><span class="s2">                                    $S_{(t+1)} = S_t + \frac{1}{t+1} (x - S_t)$</span>
<a id="__codelineno-1-876" name="__codelineno-1-876" href="#__codelineno-1-876"></a><span class="s2">                                - example java implementation: https://stackoverflow.com/a/1934266</span>
<a id="__codelineno-1-877" name="__codelineno-1-877" href="#__codelineno-1-877"></a><span class="s2">                                - proof: https://www.heikohoffmann.de/htmlthesis/node134.html</span>
<a id="__codelineno-1-878" name="__codelineno-1-878" href="#__codelineno-1-878"></a><span class="s2">                            ~}}</span>
<a id="__codelineno-1-879" name="__codelineno-1-879" href="#__codelineno-1-879"></a><span class="s2">                            {{~set "</span><span class="nv">result-freq</span><span class="s2">"</span>
<a id="__codelineno-1-880" name="__codelineno-1-880" href="#__codelineno-1-880"></a><span class="s2">                                (op "</span><span class="err">+</span><span class="s2">"</span>
<a id="__codelineno-1-881" name="__codelineno-1-881" href="#__codelineno-1-881"></a><span class="s2">                                    (get "</span><span class="nv">result-freq</span><span class="s2">")</span>
<a id="__codelineno-1-882" name="__codelineno-1-882" href="#__codelineno-1-882"></a><span class="s2">                                    (op "</span><span class="nv">/</span><span class="s2">"</span>
<a id="__codelineno-1-883" name="__codelineno-1-883" href="#__codelineno-1-883"></a><span class="s2">                                        (op "</span><span class="err">-</span><span class="s2">"</span>
<a id="__codelineno-1-884" name="__codelineno-1-884" href="#__codelineno-1-884"></a><span class="s2">                                            (get "</span><span class="nv">f</span><span class="s2">")</span>
<a id="__codelineno-1-885" name="__codelineno-1-885" href="#__codelineno-1-885"></a><span class="s2">                                            (get "</span><span class="nv">result-freq</span><span class="s2">")</span>
<a id="__codelineno-1-886" name="__codelineno-1-886" href="#__codelineno-1-886"></a><span class="s2">                                        )</span>
<a id="__codelineno-1-887" name="__codelineno-1-887" href="#__codelineno-1-887"></a><span class="s2">                                        (get "</span><span class="nv">t</span><span class="s2">")</span>
<a id="__codelineno-1-888" name="__codelineno-1-888" href="#__codelineno-1-888"></a><span class="s2">                                    )</span>
<a id="__codelineno-1-889" name="__codelineno-1-889" href="#__codelineno-1-889"></a><span class="s2">                                )</span>
<a id="__codelineno-1-890" name="__codelineno-1-890" href="#__codelineno-1-890"></a><span class="s2">                            }}</span>
<a id="__codelineno-1-891" name="__codelineno-1-891" href="#__codelineno-1-891"></a><span class="s2">                        {{~/if~}}</span>
<a id="__codelineno-1-892" name="__codelineno-1-892" href="#__codelineno-1-892"></a><span class="s2">                        {{~set "</span><span class="nv">t</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" (get "</span><span class="nv">t</span><span class="s2">") 1) ~}}</span>
<a id="__codelineno-1-893" name="__codelineno-1-893" href="#__codelineno-1-893"></a>
<a id="__codelineno-1-894" name="__codelineno-1-894" href="#__codelineno-1-894"></a><span class="s2">                    {{~else if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-freq-sorting-method</span><span class="s2">") "</span><span class="nv">harmonic</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-895" name="__codelineno-1-895" href="#__codelineno-1-895"></a><span class="s2">                        {{~#if (op "</span><span class="err">&gt;</span><span class="s2">" (get "</span><span class="nv">f</span><span class="s2">") 0) ~}} {{~! ensures only positive numbers are used ~}}</span>
<a id="__codelineno-1-896" name="__codelineno-1-896" href="#__codelineno-1-896"></a><span class="s2">                            {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result-freq</span><span class="s2">") -1) ~}}</span>
<a id="__codelineno-1-897" name="__codelineno-1-897" href="#__codelineno-1-897"></a><span class="s2">                                {{~set "</span><span class="nv">result-freq</span><span class="s2">" (op "</span><span class="nv">/</span><span class="s2">" 1 (get "</span><span class="nv">f</span><span class="s2">")) ~}}</span>
<a id="__codelineno-1-898" name="__codelineno-1-898" href="#__codelineno-1-898"></a><span class="s2">                            {{~else ~}}</span>
<a id="__codelineno-1-899" name="__codelineno-1-899" href="#__codelineno-1-899"></a><span class="s2">                                {{~set "</span><span class="nv">result-freq</span><span class="s2">"</span>
<a id="__codelineno-1-900" name="__codelineno-1-900" href="#__codelineno-1-900"></a><span class="s2">                                    (op "</span><span class="err">+</span><span class="s2">"</span>
<a id="__codelineno-1-901" name="__codelineno-1-901" href="#__codelineno-1-901"></a><span class="s2">                                        (get "</span><span class="nv">result-freq</span><span class="s2">")</span>
<a id="__codelineno-1-902" name="__codelineno-1-902" href="#__codelineno-1-902"></a><span class="s2">                                        (op "</span><span class="nv">/</span><span class="s2">" 1 (get "</span><span class="nv">f</span><span class="s2">"))</span>
<a id="__codelineno-1-903" name="__codelineno-1-903" href="#__codelineno-1-903"></a><span class="s2">                                    )</span>
<a id="__codelineno-1-904" name="__codelineno-1-904" href="#__codelineno-1-904"></a><span class="s2">                                }}</span>
<a id="__codelineno-1-905" name="__codelineno-1-905" href="#__codelineno-1-905"></a><span class="s2">                                {{~set "</span><span class="nv">t</span><span class="s2">" (op "</span><span class="err">+</span><span class="s2">" (get "</span><span class="nv">t</span><span class="s2">") 1) ~}}</span>
<a id="__codelineno-1-906" name="__codelineno-1-906" href="#__codelineno-1-906"></a><span class="s2">                            {{~/if~}}</span>
<a id="__codelineno-1-907" name="__codelineno-1-907" href="#__codelineno-1-907"></a><span class="s2">                        {{~/if~}}</span>
<a id="__codelineno-1-908" name="__codelineno-1-908" href="#__codelineno-1-908"></a>
<a id="__codelineno-1-909" name="__codelineno-1-909" href="#__codelineno-1-909"></a><span class="s2">                    {{~else if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-freq-sorting-method</span><span class="s2">") "</span><span class="nv">debug</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-910" name="__codelineno-1-910" href="#__codelineno-1-910"></a>
<a id="__codelineno-1-911" name="__codelineno-1-911" href="#__codelineno-1-911"></a><span class="s2">                        {{ this.dictionary }}: {{ this.frequency }} -&gt; {{ get "</span><span class="nv">f</span><span class="s2">" }} &lt;br&gt;</span>
<a id="__codelineno-1-912" name="__codelineno-1-912" href="#__codelineno-1-912"></a>
<a id="__codelineno-1-913" name="__codelineno-1-913" href="#__codelineno-1-913"></a><span class="s2">                    {{~else~}}</span>
<a id="__codelineno-1-914" name="__codelineno-1-914" href="#__codelineno-1-914"></a><span class="s2">                        (INVALID opt-freq-sorting-method value)</span>
<a id="__codelineno-1-915" name="__codelineno-1-915" href="#__codelineno-1-915"></a><span class="s2">                    {{~/if~}}</span>
<a id="__codelineno-1-916" name="__codelineno-1-916" href="#__codelineno-1-916"></a>
<a id="__codelineno-1-917" name="__codelineno-1-917" href="#__codelineno-1-917"></a><span class="s2">                {{~/if~}}</span>
<a id="__codelineno-1-918" name="__codelineno-1-918" href="#__codelineno-1-918"></a>
<a id="__codelineno-1-919" name="__codelineno-1-919" href="#__codelineno-1-919"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-920" name="__codelineno-1-920" href="#__codelineno-1-920"></a>
<a id="__codelineno-1-921" name="__codelineno-1-921" href="#__codelineno-1-921"></a><span class="s2">        {{~/each~}}</span>
<a id="__codelineno-1-922" name="__codelineno-1-922" href="#__codelineno-1-922"></a>
<a id="__codelineno-1-923" name="__codelineno-1-923" href="#__codelineno-1-923"></a><span class="s2">        {{~! (x) &gt;&gt; 0 apparently floors x: https://stackoverflow.com/a/4228528 ~}}</span>
<a id="__codelineno-1-924" name="__codelineno-1-924" href="#__codelineno-1-924"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">result-freq</span><span class="s2">") -1) ~}}</span>
<a id="__codelineno-1-925" name="__codelineno-1-925" href="#__codelineno-1-925"></a><span class="s2">            {{~set "</span><span class="nv">result-freq</span><span class="s2">" (get "</span><span class="nv">opt-no-freq-default-value</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-926" name="__codelineno-1-926" href="#__codelineno-1-926"></a><span class="s2">        {{~ else if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-freq-sorting-method</span><span class="s2">") "</span><span class="nv">avg</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-927" name="__codelineno-1-927" href="#__codelineno-1-927"></a><span class="s2">            {{~set "</span><span class="nv">result-freq</span><span class="s2">"</span>
<a id="__codelineno-1-928" name="__codelineno-1-928" href="#__codelineno-1-928"></a><span class="s2">                (op "</span><span class="err">&gt;&gt;</span><span class="s2">" (get "</span><span class="nv">result-freq</span><span class="s2">") 0 )</span>
<a id="__codelineno-1-929" name="__codelineno-1-929" href="#__codelineno-1-929"></a><span class="s2">            ~}}</span>
<a id="__codelineno-1-930" name="__codelineno-1-930" href="#__codelineno-1-930"></a><span class="s2">        {{~ else if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-freq-sorting-method</span><span class="s2">") "</span><span class="nv">harmonic</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-931" name="__codelineno-1-931" href="#__codelineno-1-931"></a><span class="s2">            {{~set "</span><span class="nv">result-freq</span><span class="s2">"</span>
<a id="__codelineno-1-932" name="__codelineno-1-932" href="#__codelineno-1-932"></a><span class="s2">                (op "</span><span class="err">&gt;&gt;</span><span class="s2">"</span>
<a id="__codelineno-1-933" name="__codelineno-1-933" href="#__codelineno-1-933"></a><span class="s2">                    (op "</span><span class="err">*</span><span class="s2">"</span>
<a id="__codelineno-1-934" name="__codelineno-1-934" href="#__codelineno-1-934"></a><span class="s2">                        (op "</span><span class="nv">/</span><span class="s2">" 1 (get "</span><span class="nv">result-freq</span><span class="s2">"))</span>
<a id="__codelineno-1-935" name="__codelineno-1-935" href="#__codelineno-1-935"></a><span class="s2">                        (get "</span><span class="nv">t</span><span class="s2">")</span>
<a id="__codelineno-1-936" name="__codelineno-1-936" href="#__codelineno-1-936"></a><span class="s2">                    )</span>
<a id="__codelineno-1-937" name="__codelineno-1-937" href="#__codelineno-1-937"></a><span class="s2">                    0</span>
<a id="__codelineno-1-938" name="__codelineno-1-938" href="#__codelineno-1-938"></a><span class="s2">                )</span>
<a id="__codelineno-1-939" name="__codelineno-1-939" href="#__codelineno-1-939"></a><span class="s2">            ~}}</span>
<a id="__codelineno-1-940" name="__codelineno-1-940" href="#__codelineno-1-940"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-941" name="__codelineno-1-941" href="#__codelineno-1-941"></a>
<a id="__codelineno-1-942" name="__codelineno-1-942" href="#__codelineno-1-942"></a><span class="s2">        {{~! override final result if grammar dictionary ~}}</span>
<a id="__codelineno-1-943" name="__codelineno-1-943" href="#__codelineno-1-943"></a><span class="s2">        {{~#if (</span>
<a id="__codelineno-1-944" name="__codelineno-1-944" href="#__codelineno-1-944"></a><span class="s2">            op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-945" name="__codelineno-1-945" href="#__codelineno-1-945"></a><span class="s2">                (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">found-grammar-dict</span><span class="s2">") true)</span>
<a id="__codelineno-1-946" name="__codelineno-1-946" href="#__codelineno-1-946"></a><span class="s2">                (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">opt-grammar-override</span><span class="s2">") true)</span>
<a id="__codelineno-1-947" name="__codelineno-1-947" href="#__codelineno-1-947"></a><span class="s2">            )</span>
<a id="__codelineno-1-948" name="__codelineno-1-948" href="#__codelineno-1-948"></a><span class="s2">        ~}}</span>
<a id="__codelineno-1-949" name="__codelineno-1-949" href="#__codelineno-1-949"></a><span class="s2">            {{~set "</span><span class="nv">result-freq</span><span class="s2">" (get "</span><span class="nv">opt-grammar-override-value</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-950" name="__codelineno-1-950" href="#__codelineno-1-950"></a><span class="s2">        {{/if}}</span>
<a id="__codelineno-1-951" name="__codelineno-1-951" href="#__codelineno-1-951"></a>
<a id="__codelineno-1-952" name="__codelineno-1-952" href="#__codelineno-1-952"></a><span class="s2">        {{~get "</span><span class="nv">result-freq</span><span class="s2">"~}}</span>
<a id="__codelineno-1-953" name="__codelineno-1-953" href="#__codelineno-1-953"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-954" name="__codelineno-1-954" href="#__codelineno-1-954"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-955" name="__codelineno-1-955" href="#__codelineno-1-955"></a>
<a id="__codelineno-1-956" name="__codelineno-1-956" href="#__codelineno-1-956"></a>
<a id="__codelineno-1-957" name="__codelineno-1-957" href="#__codelineno-1-957"></a>
<a id="__codelineno-1-958" name="__codelineno-1-958" href="#__codelineno-1-958"></a>
<a id="__codelineno-1-959" name="__codelineno-1-959" href="#__codelineno-1-959"></a><span class="s2">{{~!</span>
<a id="__codelineno-1-960" name="__codelineno-1-960" href="#__codelineno-1-960"></a><span class="s2">    ==============</span>
<a id="__codelineno-1-961" name="__codelineno-1-961" href="#__codelineno-1-961"></a><span class="s2">     pitch accent</span>
<a id="__codelineno-1-962" name="__codelineno-1-962" href="#__codelineno-1-962"></a><span class="s2">    ==============</span>
<a id="__codelineno-1-963" name="__codelineno-1-963" href="#__codelineno-1-963"></a><span class="s2">~}}</span>
<a id="__codelineno-1-964" name="__codelineno-1-964" href="#__codelineno-1-964"></a>
<a id="__codelineno-1-965" name="__codelineno-1-965" href="#__codelineno-1-965"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-pitch-accent-graphs</span><span class="s2">"}}</span>
<a id="__codelineno-1-966" name="__codelineno-1-966" href="#__codelineno-1-966"></a><span class="s2">    {{~#if (op "</span><span class="err">&gt;</span><span class="s2">" pitchCount 0)~}}</span>
<a id="__codelineno-1-967" name="__codelineno-1-967" href="#__codelineno-1-967"></a><span class="s2">        {{~#each pitches~}}</span>
<a id="__codelineno-1-968" name="__codelineno-1-968" href="#__codelineno-1-968"></a><span class="s2">            &lt;div class="</span><span class="nv">pa-graphs__group</span><span class="s2">" data-details="</span><span class="err">{{</span><span class="nv">dictionary</span><span class="cp">}}</span><span class="x">"&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-969" name="__codelineno-1-969" href="#__codelineno-1-969"></a><span class="x">                &lt;div class="pa-graphs__dictionary"&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-970" name="__codelineno-1-970" href="#__codelineno-1-970"></a><span class="x">                    &lt;div class="pa-graphs__dictionary-inner"&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-971" name="__codelineno-1-971" href="#__codelineno-1-971"></a><span class="x">                        </span><span class="cp">{{</span><span class="m m-Attribute">~dictionary~</span><span class="cp">}}</span>
<a id="__codelineno-1-972" name="__codelineno-1-972" href="#__codelineno-1-972"></a><span class="x">                    &lt;/div&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-973" name="__codelineno-1-973" href="#__codelineno-1-973"></a><span class="x">                &lt;/div&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-974" name="__codelineno-1-974" href="#__codelineno-1-974"></a><span class="x">                &lt;ol&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-975" name="__codelineno-1-975" href="#__codelineno-1-975"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~#each</span> <span class="nv">pitches</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-976" name="__codelineno-1-976" href="#__codelineno-1-976"></a><span class="x">                        &lt;li&gt;</span>
<a id="__codelineno-1-977" name="__codelineno-1-977" href="#__codelineno-1-977"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="nv">pitch-accent-item-disambiguation</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-978" name="__codelineno-1-978" href="#__codelineno-1-978"></a>
<a id="__codelineno-1-979" name="__codelineno-1-979" href="#__codelineno-1-979"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~#scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-980" name="__codelineno-1-980" href="#__codelineno-1-980"></a><span class="x">                                </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"any"</span> <span class="nv">false</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-981" name="__codelineno-1-981" href="#__codelineno-1-981"></a><span class="x">                                </span><span class="cp">{{</span><span class="m m-Attribute">~#each</span> <span class="nv">tags</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-982" name="__codelineno-1-982" href="#__codelineno-1-982"></a><span class="x">                                    </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(get</span> <span class="s2">"any"</span><span class="nv">)</span><span class="cp">}}</span><span class="x">, </span><span class="cp">{{</span><span class="nv">else</span><span class="cp">}}</span><span class="x">(</span><span class="cp">{{</span><span class="m m-Attribute">/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-983" name="__codelineno-1-983" href="#__codelineno-1-983"></a><span class="x">                                    </span><span class="cp">{{</span><span class="nv">name</span><span class="cp">}}</span>
<a id="__codelineno-1-984" name="__codelineno-1-984" href="#__codelineno-1-984"></a><span class="x">                                    </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"any"</span> <span class="nv">true</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-985" name="__codelineno-1-985" href="#__codelineno-1-985"></a><span class="x">                                </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-986" name="__codelineno-1-986" href="#__codelineno-1-986"></a><span class="x">                                </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(get</span> <span class="s2">"any"</span><span class="nv">)</span><span class="cp">}}</span><span class="x">) </span><span class="cp">{{</span><span class="m m-Attribute">/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-987" name="__codelineno-1-987" href="#__codelineno-1-987"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~/scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-988" name="__codelineno-1-988" href="#__codelineno-1-988"></a>
<a id="__codelineno-1-989" name="__codelineno-1-989" href="#__codelineno-1-989"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="nv">pitch-accent-item</span> <span class="na">format</span><span class="o">=</span><span class="s2">"graph"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-990" name="__codelineno-1-990" href="#__codelineno-1-990"></a><span class="x">                        &lt;/li&gt;</span>
<a id="__codelineno-1-991" name="__codelineno-1-991" href="#__codelineno-1-991"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-992" name="__codelineno-1-992" href="#__codelineno-1-992"></a><span class="x">                &lt;/ol&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-993" name="__codelineno-1-993" href="#__codelineno-1-993"></a><span class="x">            &lt;/div&gt;</span>
<a id="__codelineno-1-994" name="__codelineno-1-994" href="#__codelineno-1-994"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-995" name="__codelineno-1-995" href="#__codelineno-1-995"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-996" name="__codelineno-1-996" href="#__codelineno-1-996"></a><span class="cp">{{</span><span class="m m-Attribute">/inline</span><span class="cp">}}</span>
<a id="__codelineno-1-997" name="__codelineno-1-997" href="#__codelineno-1-997"></a>
<a id="__codelineno-1-998" name="__codelineno-1-998" href="#__codelineno-1-998"></a>
<a id="__codelineno-1-999" name="__codelineno-1-999" href="#__codelineno-1-999"></a><span class="cp">{{</span><span class="m m-Attribute">#*inline</span> <span class="s2">"jpmn-pitch-accent-positions"</span><span class="cp">}}</span>
<a id="__codelineno-1-1000" name="__codelineno-1-1000" href="#__codelineno-1-1000"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="s2">"&gt;"</span> <span class="nv">pitchCount</span> <span class="m">0</span><span class="nv">)</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1001" name="__codelineno-1-1001" href="#__codelineno-1-1001"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#each</span> <span class="nv">pitches</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1002" name="__codelineno-1-1002" href="#__codelineno-1-1002"></a><span class="x">            &lt;div class="pa-positions__group" data-details="</span><span class="cp">{{</span><span class="nv">dictionary</span><span class="cp">}}</span><span class="x">"&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-1003" name="__codelineno-1-1003" href="#__codelineno-1-1003"></a><span class="x">                &lt;div class="pa-positions__dictionary"&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-1004" name="__codelineno-1-1004" href="#__codelineno-1-1004"></a><span class="x">                    &lt;div class="pa-positions__dictionary-inner"&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-1005" name="__codelineno-1-1005" href="#__codelineno-1-1005"></a><span class="x">                        </span><span class="cp">{{</span><span class="m m-Attribute">~dictionary~</span><span class="cp">}}</span>
<a id="__codelineno-1-1006" name="__codelineno-1-1006" href="#__codelineno-1-1006"></a><span class="x">                    &lt;/div&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-1007" name="__codelineno-1-1007" href="#__codelineno-1-1007"></a><span class="x">                &lt;/div&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-1008" name="__codelineno-1-1008" href="#__codelineno-1-1008"></a><span class="x">                &lt;ol&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-1009" name="__codelineno-1-1009" href="#__codelineno-1-1009"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~#each</span> <span class="nv">pitches</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1010" name="__codelineno-1-1010" href="#__codelineno-1-1010"></a><span class="x">                        &lt;li&gt;</span>
<a id="__codelineno-1-1011" name="__codelineno-1-1011" href="#__codelineno-1-1011"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="nv">pitch-accent-item-disambiguation</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1012" name="__codelineno-1-1012" href="#__codelineno-1-1012"></a>
<a id="__codelineno-1-1013" name="__codelineno-1-1013" href="#__codelineno-1-1013"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~#scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1014" name="__codelineno-1-1014" href="#__codelineno-1-1014"></a><span class="x">                                </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"any"</span> <span class="nv">false</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1015" name="__codelineno-1-1015" href="#__codelineno-1-1015"></a><span class="x">                                </span><span class="cp">{{</span><span class="m m-Attribute">~#each</span> <span class="nv">tags</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1016" name="__codelineno-1-1016" href="#__codelineno-1-1016"></a><span class="x">                                    </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(get</span> <span class="s2">"any"</span><span class="nv">)</span><span class="cp">}}</span><span class="x">, </span><span class="cp">{{</span><span class="nv">else</span><span class="cp">}}</span><span class="x">(</span><span class="cp">{{</span><span class="m m-Attribute">/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1017" name="__codelineno-1-1017" href="#__codelineno-1-1017"></a><span class="x">                                    </span><span class="cp">{{</span><span class="nv">name</span><span class="cp">}}</span>
<a id="__codelineno-1-1018" name="__codelineno-1-1018" href="#__codelineno-1-1018"></a><span class="x">                                    </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"any"</span> <span class="nv">true</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1019" name="__codelineno-1-1019" href="#__codelineno-1-1019"></a><span class="x">                                </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-1020" name="__codelineno-1-1020" href="#__codelineno-1-1020"></a><span class="x">                                </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(get</span> <span class="s2">"any"</span><span class="nv">)</span><span class="cp">}}</span><span class="x">) </span><span class="cp">{{</span><span class="m m-Attribute">/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1021" name="__codelineno-1-1021" href="#__codelineno-1-1021"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~/scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1022" name="__codelineno-1-1022" href="#__codelineno-1-1022"></a>
<a id="__codelineno-1-1023" name="__codelineno-1-1023" href="#__codelineno-1-1023"></a><span class="x">                            </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="nv">pitch-accent-item</span> <span class="na">format</span><span class="o">=</span><span class="s2">"position"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1024" name="__codelineno-1-1024" href="#__codelineno-1-1024"></a><span class="x">                        &lt;/li&gt;</span>
<a id="__codelineno-1-1025" name="__codelineno-1-1025" href="#__codelineno-1-1025"></a><span class="x">                    </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-1026" name="__codelineno-1-1026" href="#__codelineno-1-1026"></a><span class="x">                &lt;/ol&gt; </span><span class="cp">{{</span><span class="m m-Attribute">~s~</span><span class="cp">}}</span>
<a id="__codelineno-1-1027" name="__codelineno-1-1027" href="#__codelineno-1-1027"></a><span class="x">            &lt;/div&gt;</span>
<a id="__codelineno-1-1028" name="__codelineno-1-1028" href="#__codelineno-1-1028"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-1029" name="__codelineno-1-1029" href="#__codelineno-1-1029"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1030" name="__codelineno-1-1030" href="#__codelineno-1-1030"></a><span class="cp">{{</span><span class="m m-Attribute">/inline</span><span class="cp">}}</span>
<a id="__codelineno-1-1031" name="__codelineno-1-1031" href="#__codelineno-1-1031"></a>
<a id="__codelineno-1-1032" name="__codelineno-1-1032" href="#__codelineno-1-1032"></a>
<a id="__codelineno-1-1033" name="__codelineno-1-1033" href="#__codelineno-1-1033"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>
<a id="__codelineno-1-1034" name="__codelineno-1-1034" href="#__codelineno-1-1034"></a>    <span class="na">=============</span><span class="o">=</span>
<a id="__codelineno-1-1035" name="__codelineno-1-1035" href="#__codelineno-1-1035"></a>     <span class="nv">dictionaries</span>
<a id="__codelineno-1-1036" name="__codelineno-1-1036" href="#__codelineno-1-1036"></a>    <span class="na">=============</span><span class="o">=</span>
<a id="__codelineno-1-1037" name="__codelineno-1-1037" href="#__codelineno-1-1037"></a><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1038" name="__codelineno-1-1038" href="#__codelineno-1-1038"></a>
<a id="__codelineno-1-1039" name="__codelineno-1-1039" href="#__codelineno-1-1039"></a>
<a id="__codelineno-1-1040" name="__codelineno-1-1040" href="#__codelineno-1-1040"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">primary</span> <span class="nv">def</span><span class="err">:</span> <span class="nv">first</span> <span class="nv">monolingual</span> <span class="nv">(or</span> <span class="nv">first</span> <span class="nv">bilingual</span> <span class="nv">if</span> <span class="nv">no</span> <span class="nv">monolingual</span> <span class="nv">dicts</span> <span class="nv">found)</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1041" name="__codelineno-1-1041" href="#__codelineno-1-1041"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">does</span> <span class="nv">the</span> <span class="nv">reverse</span> <span class="nv">if</span> <span class="nv">opt-first-definition-type</span> <span class="nv">is</span> <span class="s2">"bilingual"</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1042" name="__codelineno-1-1042" href="#__codelineno-1-1042"></a><span class="cp">{{</span><span class="m m-Attribute">~#*inline</span> <span class="s2">"jpmn-primary-definition"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1043" name="__codelineno-1-1043" href="#__codelineno-1-1043"></a>
<a id="__codelineno-1-1044" name="__codelineno-1-1044" href="#__codelineno-1-1044"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1045" name="__codelineno-1-1045" href="#__codelineno-1-1045"></a>
<a id="__codelineno-1-1046" name="__codelineno-1-1046" href="#__codelineno-1-1046"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">output</span> <span class="nv">warning</span> <span class="nv">if</span> <span class="nv">no</span> <span class="nv">dictionaries</span> <span class="nv">are</span> <span class="nv">found</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1047" name="__codelineno-1-1047" href="#__codelineno-1-1047"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="na">"==</span><span class="o">=</span><span class="s2">" definition.definitions.length undefined)~}}</span>
<a id="__codelineno-1-1048" name="__codelineno-1-1048" href="#__codelineno-1-1048"></a><span class="s2">WARNING: JPMN Handlebars cannot find any definitions to export.</span>
<a id="__codelineno-1-1049" name="__codelineno-1-1049" href="#__codelineno-1-1049"></a><span class="s2">This is usually because your Yomichan settings has "</span><span class="nv">Result</span> <span class="nv">grouping</span> <span class="nv">mode</span><span class="s2">"</span>
<a id="__codelineno-1-1050" name="__codelineno-1-1050" href="#__codelineno-1-1050"></a><span class="s2">set to "</span><span class="nv">No</span> <span class="nv">grouping</span><span class="s2">". Please set this to "</span><span class="nv">Group</span> <span class="nv">term-reading</span> <span class="nv">pairs</span><span class="s2">".</span>
<a id="__codelineno-1-1051" name="__codelineno-1-1051" href="#__codelineno-1-1051"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-1052" name="__codelineno-1-1052" href="#__codelineno-1-1052"></a>
<a id="__codelineno-1-1053" name="__codelineno-1-1053" href="#__codelineno-1-1053"></a><span class="s2">        {{~#set "</span><span class="nv">primary-dictionary</span><span class="s2">"}}{{~&gt; _jpmn-get-primary-definition-dict . ~}}{{/set~}}</span>
<a id="__codelineno-1-1054" name="__codelineno-1-1054" href="#__codelineno-1-1054"></a>
<a id="__codelineno-1-1055" name="__codelineno-1-1055" href="#__codelineno-1-1055"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">primary-dictionary</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-1056" name="__codelineno-1-1056" href="#__codelineno-1-1056"></a><span class="s2">            {{~&gt; _jpmn-selection-text ~}}</span>
<a id="__codelineno-1-1057" name="__codelineno-1-1057" href="#__codelineno-1-1057"></a><span class="s2">        {{~else~}}</span>
<a id="__codelineno-1-1058" name="__codelineno-1-1058" href="#__codelineno-1-1058"></a><span class="s2">            {{~#set "</span><span class="nv">selection</span><span class="s2">"}}{{~&gt; _jpmn-selection-text ~}}{{/set~}}</span>
<a id="__codelineno-1-1059" name="__codelineno-1-1059" href="#__codelineno-1-1059"></a><span class="s2">            {{~#set "</span><span class="nv">selection-uses-glossary</span><span class="s2">"~}}</span>
<a id="__codelineno-1-1060" name="__codelineno-1-1060" href="#__codelineno-1-1060"></a><span class="s2">                {{~&gt; _jpmn-selection-uses-glossary . ~}}</span>
<a id="__codelineno-1-1061" name="__codelineno-1-1061" href="#__codelineno-1-1061"></a><span class="s2">            {{~/set~}}</span>
<a id="__codelineno-1-1062" name="__codelineno-1-1062" href="#__codelineno-1-1062"></a>
<a id="__codelineno-1-1063" name="__codelineno-1-1063" href="#__codelineno-1-1063"></a><span class="s2">            {{~! not "" &lt;=&gt; is a filled string ~}}</span>
<a id="__codelineno-1-1064" name="__codelineno-1-1064" href="#__codelineno-1-1064"></a><span class="s2">            {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">selection-uses-glossary</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-1065" name="__codelineno-1-1065" href="#__codelineno-1-1065"></a>
<a id="__codelineno-1-1066" name="__codelineno-1-1066" href="#__codelineno-1-1066"></a><span class="s2">                {{~! escape regex ~}}</span>
<a id="__codelineno-1-1067" name="__codelineno-1-1067" href="#__codelineno-1-1067"></a><span class="s2">                {{~#set "</span><span class="nv">search-selection</span><span class="s2">"}}{{~#regexReplace "</span><span class="err">[.*+?^${}</span><span class="nv">()</span><span class="err">|[\]\\]</span><span class="s2">" "</span><span class="err">\$&amp;</span><span class="s2">" "</span><span class="nv">g</span><span class="s2">"~}}{{~&gt; _jpmn-selection-text ~}}{{~/regexReplace~}}{{/set~}}</span>
<a id="__codelineno-1-1068" name="__codelineno-1-1068" href="#__codelineno-1-1068"></a><span class="s2">                {{~#set "</span><span class="nv">search-selection-bold</span><span class="s2">"}}&lt;b&gt;{{~&gt; _jpmn-selection-text ~}}&lt;/b&gt;{{/set~}}</span>
<a id="__codelineno-1-1069" name="__codelineno-1-1069" href="#__codelineno-1-1069"></a>
<a id="__codelineno-1-1070" name="__codelineno-1-1070" href="#__codelineno-1-1070"></a><span class="s2">                {{~#regexReplace (get "</span><span class="nv">search-selection</span><span class="s2">") (get "</span><span class="nv">search-selection-bold</span><span class="s2">") "</span><span class="nv">g</span><span class="s2">"~}}</span>
<a id="__codelineno-1-1071" name="__codelineno-1-1071" href="#__codelineno-1-1071"></a><span class="s2">                    {{~&gt; _jpmn-get-primary-definition-value . brief=../brief noDictionaryTag=../noDictionaryTag ~}}</span>
<a id="__codelineno-1-1072" name="__codelineno-1-1072" href="#__codelineno-1-1072"></a><span class="s2">                {{~/regexReplace~}}</span>
<a id="__codelineno-1-1073" name="__codelineno-1-1073" href="#__codelineno-1-1073"></a>
<a id="__codelineno-1-1074" name="__codelineno-1-1074" href="#__codelineno-1-1074"></a><span class="s2">            {{~else~}}</span>
<a id="__codelineno-1-1075" name="__codelineno-1-1075" href="#__codelineno-1-1075"></a><span class="s2">                {{~#set "</span><span class="nv">search-selection</span><span class="s2">"}}{{/set~}}</span>
<a id="__codelineno-1-1076" name="__codelineno-1-1076" href="#__codelineno-1-1076"></a><span class="s2">                {{~&gt; _jpmn-get-primary-definition-value . brief=../brief noDictionaryTag=../noDictionaryTag ~}}</span>
<a id="__codelineno-1-1077" name="__codelineno-1-1077" href="#__codelineno-1-1077"></a><span class="s2">            {{~/if~}}</span>
<a id="__codelineno-1-1078" name="__codelineno-1-1078" href="#__codelineno-1-1078"></a>
<a id="__codelineno-1-1079" name="__codelineno-1-1079" href="#__codelineno-1-1079"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-1080" name="__codelineno-1-1080" href="#__codelineno-1-1080"></a>
<a id="__codelineno-1-1081" name="__codelineno-1-1081" href="#__codelineno-1-1081"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-1082" name="__codelineno-1-1082" href="#__codelineno-1-1082"></a>
<a id="__codelineno-1-1083" name="__codelineno-1-1083" href="#__codelineno-1-1083"></a><span class="s2">{{~/inline~}}</span>
<a id="__codelineno-1-1084" name="__codelineno-1-1084" href="#__codelineno-1-1084"></a>
<a id="__codelineno-1-1085" name="__codelineno-1-1085" href="#__codelineno-1-1085"></a>
<a id="__codelineno-1-1086" name="__codelineno-1-1086" href="#__codelineno-1-1086"></a><span class="s2">{{~! extra def: bilingual defs (excluding primary def) ~}}</span>
<a id="__codelineno-1-1087" name="__codelineno-1-1087" href="#__codelineno-1-1087"></a><span class="s2">{{~#*inline "</span><span class="nv">jpmn-secondary-definition</span><span class="s2">"~}}</span>
<a id="__codelineno-1-1088" name="__codelineno-1-1088" href="#__codelineno-1-1088"></a>
<a id="__codelineno-1-1089" name="__codelineno-1-1089" href="#__codelineno-1-1089"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-1090" name="__codelineno-1-1090" href="#__codelineno-1-1090"></a>
<a id="__codelineno-1-1091" name="__codelineno-1-1091" href="#__codelineno-1-1091"></a><span class="s2">        {{~#set "</span><span class="nv">primary-dictionary</span><span class="s2">"}}{{~&gt; _jpmn-get-primary-definition-dict . ~}}{{/set~}}</span>
<a id="__codelineno-1-1092" name="__codelineno-1-1092" href="#__codelineno-1-1092"></a>
<a id="__codelineno-1-1093" name="__codelineno-1-1093" href="#__codelineno-1-1093"></a><span class="s2">        {{~! looks to see if another dictionary exists ~}}</span>
<a id="__codelineno-1-1094" name="__codelineno-1-1094" href="#__codelineno-1-1094"></a><span class="s2">        {{~! entry count must be gotten here in order to properly iterate through definition.definitions ~}}</span>
<a id="__codelineno-1-1095" name="__codelineno-1-1095" href="#__codelineno-1-1095"></a><span class="s2">        {{~#set "</span><span class="nv">entry-count</span><span class="s2">"}}{{~&gt; _jpmn-primary-dict-entry-count . ~}}{{/set~}}</span>
<a id="__codelineno-1-1096" name="__codelineno-1-1096" href="#__codelineno-1-1096"></a><span class="s2">        {{~#set "</span><span class="nv">has-valid-dict</span><span class="s2">"}}{{~&gt; _jpmn-non-primary-has-valid-dict . validDictType="</span><span class="nv">bilingual</span><span class="s2">" entryCount=(get "</span><span class="nv">entry-count</span><span class="s2">")~}}{{/set~}}</span>
<a id="__codelineno-1-1097" name="__codelineno-1-1097" href="#__codelineno-1-1097"></a>
<a id="__codelineno-1-1098" name="__codelineno-1-1098" href="#__codelineno-1-1098"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">has-valid-dict</span><span class="s2">") "</span><span class="nv">true</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-1099" name="__codelineno-1-1099" href="#__codelineno-1-1099"></a><span class="s2">            &lt;ol&gt;</span>
<a id="__codelineno-1-1100" name="__codelineno-1-1100" href="#__codelineno-1-1100"></a><span class="s2">            {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-1101" name="__codelineno-1-1101" href="#__codelineno-1-1101"></a><span class="s2">                {{~#set "</span><span class="nv">is-valid-dict</span><span class="s2">"}}{{~&gt; _jpmn-non-primary-is-valid-dict . validDictType="</span><span class="nv">bilingual</span><span class="s2">" entryCount=(get "</span><span class="nv">entry-count</span><span class="s2">") dictionaryName=dictionary ~}}{{/set~}}</span>
<a id="__codelineno-1-1102" name="__codelineno-1-1102" href="#__codelineno-1-1102"></a><span class="s2">                {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">is-valid-dict</span><span class="s2">") "</span><span class="nv">true</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-1103" name="__codelineno-1-1103" href="#__codelineno-1-1103"></a>
<a id="__codelineno-1-1104" name="__codelineno-1-1104" href="#__codelineno-1-1104"></a><span class="s2">                    &lt;li data-details="</span><span class="err">{{~</span><span class="nv">dictionary</span><span class="m">~</span><span class="cp">}}</span><span class="x">"&gt;</span>
<a id="__codelineno-1-1105" name="__codelineno-1-1105" href="#__codelineno-1-1105"></a><span class="x">                        </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-glossary-single</span> <span class="err">.</span> <span class="na">brief</span><span class="o">=</span><span class="nv">../brief</span> <span class="na">noDictionaryTag</span><span class="o">=</span><span class="nv">../noDictionaryTag</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1106" name="__codelineno-1-1106" href="#__codelineno-1-1106"></a><span class="x">                    &lt;/li&gt;</span>
<a id="__codelineno-1-1107" name="__codelineno-1-1107" href="#__codelineno-1-1107"></a>
<a id="__codelineno-1-1108" name="__codelineno-1-1108" href="#__codelineno-1-1108"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1109" name="__codelineno-1-1109" href="#__codelineno-1-1109"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-1110" name="__codelineno-1-1110" href="#__codelineno-1-1110"></a><span class="x">            &lt;/ol&gt;</span>
<a id="__codelineno-1-1111" name="__codelineno-1-1111" href="#__codelineno-1-1111"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1112" name="__codelineno-1-1112" href="#__codelineno-1-1112"></a>
<a id="__codelineno-1-1113" name="__codelineno-1-1113" href="#__codelineno-1-1113"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~/scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1114" name="__codelineno-1-1114" href="#__codelineno-1-1114"></a>
<a id="__codelineno-1-1115" name="__codelineno-1-1115" href="#__codelineno-1-1115"></a><span class="cp">{{</span><span class="m m-Attribute">~/inline~</span><span class="cp">}}</span>
<a id="__codelineno-1-1116" name="__codelineno-1-1116" href="#__codelineno-1-1116"></a>
<a id="__codelineno-1-1117" name="__codelineno-1-1117" href="#__codelineno-1-1117"></a>
<a id="__codelineno-1-1118" name="__codelineno-1-1118" href="#__codelineno-1-1118"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">extra</span> <span class="nv">def</span><span class="err">:</span> <span class="nv">monolingual</span> <span class="nv">defs</span> <span class="nv">(excluding</span> <span class="nv">primary</span> <span class="nv">def)</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1119" name="__codelineno-1-1119" href="#__codelineno-1-1119"></a><span class="cp">{{</span><span class="m m-Attribute">~#*inline</span> <span class="s2">"jpmn-extra-definitions"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1120" name="__codelineno-1-1120" href="#__codelineno-1-1120"></a>
<a id="__codelineno-1-1121" name="__codelineno-1-1121" href="#__codelineno-1-1121"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1122" name="__codelineno-1-1122" href="#__codelineno-1-1122"></a>
<a id="__codelineno-1-1123" name="__codelineno-1-1123" href="#__codelineno-1-1123"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"primary-dictionary"</span><span class="cp">}}{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-get-primary-definition-dict</span> <span class="err">.</span> <span class="m">~</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1124" name="__codelineno-1-1124" href="#__codelineno-1-1124"></a>
<a id="__codelineno-1-1125" name="__codelineno-1-1125" href="#__codelineno-1-1125"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">looks</span> <span class="nv">to</span> <span class="nv">see</span> <span class="nv">if</span> <span class="nv">another</span> <span class="nv">dictionary</span> <span class="nv">exists</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1126" name="__codelineno-1-1126" href="#__codelineno-1-1126"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">entry</span> <span class="nv">count</span> <span class="nv">must</span> <span class="nv">be</span> <span class="nv">gotten</span> <span class="nv">here</span> <span class="nv">in</span> <span class="nv">order</span> <span class="nv">to</span> <span class="nv">properly</span> <span class="nv">iterate</span> <span class="nv">through</span> <span class="nv">definition.definitions</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1127" name="__codelineno-1-1127" href="#__codelineno-1-1127"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"entry-count"</span><span class="cp">}}{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-primary-dict-entry-count</span> <span class="err">.</span> <span class="m">~</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1128" name="__codelineno-1-1128" href="#__codelineno-1-1128"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"has-valid-dict"</span><span class="cp">}}{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-non-primary-has-valid-dict</span> <span class="err">.</span> <span class="na">validDictType</span><span class="o">=</span><span class="s2">"monolingual"</span> <span class="na">entryCount</span><span class="o">=</span><span class="nv">(get</span> <span class="s2">"entry-count"</span><span class="nv">)</span><span class="m">~</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1129" name="__codelineno-1-1129" href="#__codelineno-1-1129"></a>
<a id="__codelineno-1-1130" name="__codelineno-1-1130" href="#__codelineno-1-1130"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="na">"==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">has-valid-dict</span><span class="s2">") "</span><span class="nv">true</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-1131" name="__codelineno-1-1131" href="#__codelineno-1-1131"></a><span class="s2">            &lt;ol&gt;</span>
<a id="__codelineno-1-1132" name="__codelineno-1-1132" href="#__codelineno-1-1132"></a><span class="s2">            {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-1133" name="__codelineno-1-1133" href="#__codelineno-1-1133"></a><span class="s2">                {{~#set "</span><span class="nv">is-valid-dict</span><span class="s2">"}}{{~&gt; _jpmn-non-primary-is-valid-dict . validDictType="</span><span class="nv">monolingual</span><span class="s2">" entryCount=(get "</span><span class="nv">entry-count</span><span class="s2">") dictionaryName=dictionary ~}}{{/set~}}</span>
<a id="__codelineno-1-1134" name="__codelineno-1-1134" href="#__codelineno-1-1134"></a><span class="s2">                {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">is-valid-dict</span><span class="s2">") "</span><span class="nv">true</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-1135" name="__codelineno-1-1135" href="#__codelineno-1-1135"></a><span class="s2">                    &lt;li data-details="</span><span class="err">{{~</span><span class="nv">dictionary</span><span class="m">~</span><span class="cp">}}</span><span class="x">"&gt;</span>
<a id="__codelineno-1-1136" name="__codelineno-1-1136" href="#__codelineno-1-1136"></a><span class="x">                        </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-glossary-single</span> <span class="err">.</span> <span class="na">brief</span><span class="o">=</span><span class="nv">../brief</span> <span class="na">noDictionaryTag</span><span class="o">=</span><span class="nv">../noDictionaryTag</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1137" name="__codelineno-1-1137" href="#__codelineno-1-1137"></a><span class="x">                    &lt;/li&gt;</span>
<a id="__codelineno-1-1138" name="__codelineno-1-1138" href="#__codelineno-1-1138"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1139" name="__codelineno-1-1139" href="#__codelineno-1-1139"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-1140" name="__codelineno-1-1140" href="#__codelineno-1-1140"></a><span class="x">            &lt;/ol&gt;</span>
<a id="__codelineno-1-1141" name="__codelineno-1-1141" href="#__codelineno-1-1141"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1142" name="__codelineno-1-1142" href="#__codelineno-1-1142"></a>
<a id="__codelineno-1-1143" name="__codelineno-1-1143" href="#__codelineno-1-1143"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~/scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1144" name="__codelineno-1-1144" href="#__codelineno-1-1144"></a>
<a id="__codelineno-1-1145" name="__codelineno-1-1145" href="#__codelineno-1-1145"></a><span class="cp">{{</span><span class="m m-Attribute">~/inline~</span><span class="cp">}}</span>
<a id="__codelineno-1-1146" name="__codelineno-1-1146" href="#__codelineno-1-1146"></a>
<a id="__codelineno-1-1147" name="__codelineno-1-1147" href="#__codelineno-1-1147"></a>
<a id="__codelineno-1-1148" name="__codelineno-1-1148" href="#__codelineno-1-1148"></a>
<a id="__codelineno-1-1149" name="__codelineno-1-1149" href="#__codelineno-1-1149"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">pitch</span> <span class="nv">accent</span> <span class="nv">info</span><span class="err">:</span> <span class="nv">all</span> <span class="nv">pitch</span> <span class="nv">accent</span> <span class="nv">info</span> <span class="nv">dictionaries</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1150" name="__codelineno-1-1150" href="#__codelineno-1-1150"></a>
<a id="__codelineno-1-1151" name="__codelineno-1-1151" href="#__codelineno-1-1151"></a><span class="cp">{{</span><span class="m m-Attribute">~#*inline</span> <span class="s2">"jpmn-utility-dictionaries"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1152" name="__codelineno-1-1152" href="#__codelineno-1-1152"></a>
<a id="__codelineno-1-1153" name="__codelineno-1-1153" href="#__codelineno-1-1153"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1154" name="__codelineno-1-1154" href="#__codelineno-1-1154"></a>
<a id="__codelineno-1-1155" name="__codelineno-1-1155" href="#__codelineno-1-1155"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">looks</span> <span class="nv">to</span> <span class="nv">see</span> <span class="nv">if</span> <span class="nv">another</span> <span class="nv">dictionary</span> <span class="nv">exists</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1156" name="__codelineno-1-1156" href="#__codelineno-1-1156"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~!</span> <span class="nv">this</span> <span class="nv">if-statement</span> <span class="nv">is</span> <span class="nv">much</span> <span class="nv">more</span> <span class="nv">simple</span> <span class="nv">than</span> <span class="nv">the</span> <span class="nv">ones</span> <span class="nv">above</span><span class="err">,</span> <span class="nv">since</span> <span class="nv">utility</span> <span class="nv">dictionaries</span> <span class="nv">usually</span> <span class="nv">aren</span><span class="s1">'t the primary definition (if it is, then it'</span><span class="nv">ll</span> <span class="nv">just</span> <span class="nv">be</span> <span class="nv">repeated</span> <span class="nv">again</span> <span class="nv">here)</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1157" name="__codelineno-1-1157" href="#__codelineno-1-1157"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"has-valid-dict"</span><span class="cp">}}{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-non-primary-has-valid-dict</span> <span class="err">.</span> <span class="na">validDictType</span><span class="o">=</span><span class="s2">"utility"</span><span class="m">~</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1158" name="__codelineno-1-1158" href="#__codelineno-1-1158"></a>
<a id="__codelineno-1-1159" name="__codelineno-1-1159" href="#__codelineno-1-1159"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="na">"==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">has-valid-dict</span><span class="s2">") "</span><span class="nv">true</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-1160" name="__codelineno-1-1160" href="#__codelineno-1-1160"></a><span class="s2">            &lt;ol&gt;</span>
<a id="__codelineno-1-1161" name="__codelineno-1-1161" href="#__codelineno-1-1161"></a><span class="s2">            {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-1162" name="__codelineno-1-1162" href="#__codelineno-1-1162"></a><span class="s2">                {{~#set "</span><span class="nv">test-dict-name</span><span class="s2">"}}{{~&gt; jpmn-get-dict-type . dictionaryName=dictionary ~}}{{/set~}}</span>
<a id="__codelineno-1-1163" name="__codelineno-1-1163" href="#__codelineno-1-1163"></a><span class="s2">                {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">test-dict-name</span><span class="s2">") "</span><span class="nv">utility</span><span class="s2">")~}}</span>
<a id="__codelineno-1-1164" name="__codelineno-1-1164" href="#__codelineno-1-1164"></a><span class="s2">                    &lt;li data-details="</span><span class="err">{{~</span><span class="nv">dictionary</span><span class="m">~</span><span class="cp">}}</span><span class="x">"&gt;</span>
<a id="__codelineno-1-1165" name="__codelineno-1-1165" href="#__codelineno-1-1165"></a><span class="x">                        </span><span class="cp">{{</span><span class="m m-Attribute">~&gt;</span> <span class="err">_</span><span class="nv">jpmn-glossary-single</span> <span class="err">.</span> <span class="na">brief</span><span class="o">=</span><span class="nv">../brief</span> <span class="na">noDictionaryTag</span><span class="o">=</span><span class="nv">../noDictionaryTag</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1166" name="__codelineno-1-1166" href="#__codelineno-1-1166"></a><span class="x">                    &lt;/li&gt;</span>
<a id="__codelineno-1-1167" name="__codelineno-1-1167" href="#__codelineno-1-1167"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1168" name="__codelineno-1-1168" href="#__codelineno-1-1168"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-1169" name="__codelineno-1-1169" href="#__codelineno-1-1169"></a><span class="x">            &lt;/ol&gt;</span>
<a id="__codelineno-1-1170" name="__codelineno-1-1170" href="#__codelineno-1-1170"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1171" name="__codelineno-1-1171" href="#__codelineno-1-1171"></a>
<a id="__codelineno-1-1172" name="__codelineno-1-1172" href="#__codelineno-1-1172"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~/scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1173" name="__codelineno-1-1173" href="#__codelineno-1-1173"></a>
<a id="__codelineno-1-1174" name="__codelineno-1-1174" href="#__codelineno-1-1174"></a><span class="cp">{{</span><span class="m m-Attribute">~/inline~</span><span class="cp">}}</span>
<a id="__codelineno-1-1175" name="__codelineno-1-1175" href="#__codelineno-1-1175"></a>
<a id="__codelineno-1-1176" name="__codelineno-1-1176" href="#__codelineno-1-1176"></a>
<a id="__codelineno-1-1177" name="__codelineno-1-1177" href="#__codelineno-1-1177"></a>
<a id="__codelineno-1-1178" name="__codelineno-1-1178" href="#__codelineno-1-1178"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>
<a id="__codelineno-1-1179" name="__codelineno-1-1179" href="#__codelineno-1-1179"></a>    <span class="na">======</span><span class="o">=</span>
<a id="__codelineno-1-1180" name="__codelineno-1-1180" href="#__codelineno-1-1180"></a>     <span class="nv">other</span>
<a id="__codelineno-1-1181" name="__codelineno-1-1181" href="#__codelineno-1-1181"></a>    <span class="na">======</span><span class="o">=</span>
<a id="__codelineno-1-1182" name="__codelineno-1-1182" href="#__codelineno-1-1182"></a><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1183" name="__codelineno-1-1183" href="#__codelineno-1-1183"></a>
<a id="__codelineno-1-1184" name="__codelineno-1-1184" href="#__codelineno-1-1184"></a><span class="cp">{{</span><span class="m m-Attribute">~#*inline</span> <span class="s2">"jpmn-word-reading-hiragana"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1185" name="__codelineno-1-1185" href="#__codelineno-1-1185"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"word-reading"</span> <span class="m">~</span><span class="cp">}}{{</span><span class="k">&gt;</span> <span class="nv">reading</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1186" name="__codelineno-1-1186" href="#__codelineno-1-1186"></a>
<a id="__codelineno-1-1187" name="__codelineno-1-1187" href="#__codelineno-1-1187"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="s2">""</span> <span class="nv">(get</span> <span class="s2">"word-reading"</span><span class="nv">))</span> <span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1188" name="__codelineno-1-1188" href="#__codelineno-1-1188"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"word-reading"</span> <span class="m">~</span><span class="cp">}}{{</span><span class="k">&gt;</span> <span class="nv">expression</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1189" name="__codelineno-1-1189" href="#__codelineno-1-1189"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1190" name="__codelineno-1-1190" href="#__codelineno-1-1190"></a>
<a id="__codelineno-1-1191" name="__codelineno-1-1191" href="#__codelineno-1-1191"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">#hiragana</span> <span class="nv">(get</span> <span class="s2">"word-reading"</span><span class="nv">)</span> <span class="na">keepProlongedSoundMarks</span><span class="o">=</span><span class="nv">false</span><span class="cp">}}{{</span><span class="m m-Attribute">/hiragana</span><span class="cp">}}</span>
<a id="__codelineno-1-1192" name="__codelineno-1-1192" href="#__codelineno-1-1192"></a><span class="cp">{{</span><span class="m m-Attribute">~/inline~</span><span class="cp">}}</span>
<a id="__codelineno-1-1193" name="__codelineno-1-1193" href="#__codelineno-1-1193"></a>
<a id="__codelineno-1-1194" name="__codelineno-1-1194" href="#__codelineno-1-1194"></a>
<a id="__codelineno-1-1195" name="__codelineno-1-1195" href="#__codelineno-1-1195"></a>
<a id="__codelineno-1-1196" name="__codelineno-1-1196" href="#__codelineno-1-1196"></a><span class="cp">{{</span><span class="m m-Attribute">~!</span>
<a id="__codelineno-1-1197" name="__codelineno-1-1197" href="#__codelineno-1-1197"></a><span class="nv">thanks</span> <span class="nv">to</span><span class="err">:</span>
<a id="__codelineno-1-1198" name="__codelineno-1-1198" href="#__codelineno-1-1198"></a><span class="err">-</span> <span class="nv">https</span><span class="err">:</span><span class="nv">//github.com/FooSoft/yomichan/issues/1952</span><span class="err">#</span><span class="nv">issuecomment-922671489</span> <span class="nv">for</span> <span class="nv">the</span> <span class="nv">base</span> <span class="nv">code</span>
<a id="__codelineno-1-1199" name="__codelineno-1-1199" href="#__codelineno-1-1199"></a><span class="err">-</span> <span class="nv">DaNautics</span><span class="err">#</span><span class="m">8833</span> <span class="nv">for</span> <span class="nv">finding</span> <span class="nv">the</span> <span class="nv">above</span> <span class="err">+</span> <span class="nv">removing</span> <span class="nv">the</span> <span class="nv">span</span> <span class="nv">classes</span>
<a id="__codelineno-1-1200" name="__codelineno-1-1200" href="#__codelineno-1-1200"></a><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1201" name="__codelineno-1-1201" href="#__codelineno-1-1201"></a><span class="cp">{{</span><span class="m m-Attribute">#*inline</span> <span class="s2">"jpmn-sentence-bolded-furigana-plain"</span><span class="cp">}}</span>
<a id="__codelineno-1-1202" name="__codelineno-1-1202" href="#__codelineno-1-1202"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">definition.cloze</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1203" name="__codelineno-1-1203" href="#__codelineno-1-1203"></a>
<a id="__codelineno-1-1204" name="__codelineno-1-1204" href="#__codelineno-1-1204"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#regexReplace</span> <span class="s2">"(&lt;span class=\"term\"&gt;)|(&lt;/span&gt;)"</span> <span class="s2">""</span> <span class="s2">"g"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1205" name="__codelineno-1-1205" href="#__codelineno-1-1205"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#regexReplace</span> <span class="s2">"&lt;ruby&gt;(.+?)&lt;rt&gt;(.+?)&lt;/rt&gt;&lt;/ruby&gt;"</span> <span class="s2">" $1[$2]"</span> <span class="s2">"g"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1206" name="__codelineno-1-1206" href="#__codelineno-1-1206"></a>
<a id="__codelineno-1-1207" name="__codelineno-1-1207" href="#__codelineno-1-1207"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(hasMedia</span> <span class="s2">"textFurigana"</span> <span class="nv">definition.cloze.prefix)</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1208" name="__codelineno-1-1208" href="#__codelineno-1-1208"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~#getMedia</span> <span class="s2">"textFurigana"</span> <span class="nv">definition.cloze.prefix</span> <span class="na">escape</span><span class="o">=</span><span class="nv">false</span><span class="cp">}}{{</span><span class="m m-Attribute">/getMedia~</span><span class="cp">}}</span>
<a id="__codelineno-1-1209" name="__codelineno-1-1209" href="#__codelineno-1-1209"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~else~</span><span class="cp">}}</span>
<a id="__codelineno-1-1210" name="__codelineno-1-1210" href="#__codelineno-1-1210"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~definition.cloze.prefix~</span><span class="cp">}}</span>
<a id="__codelineno-1-1211" name="__codelineno-1-1211" href="#__codelineno-1-1211"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1212" name="__codelineno-1-1212" href="#__codelineno-1-1212"></a>
<a id="__codelineno-1-1213" name="__codelineno-1-1213" href="#__codelineno-1-1213"></a><span class="x">            &lt;b&gt;</span>
<a id="__codelineno-1-1214" name="__codelineno-1-1214" href="#__codelineno-1-1214"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(hasMedia</span> <span class="s2">"textFurigana"</span> <span class="nv">definition.cloze.body)</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1215" name="__codelineno-1-1215" href="#__codelineno-1-1215"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~#getMedia</span> <span class="s2">"textFurigana"</span> <span class="nv">definition.cloze.body</span> <span class="na">escape</span><span class="o">=</span><span class="nv">false</span><span class="cp">}}{{</span><span class="m m-Attribute">/getMedia~</span><span class="cp">}}</span>
<a id="__codelineno-1-1216" name="__codelineno-1-1216" href="#__codelineno-1-1216"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~else~</span><span class="cp">}}</span>
<a id="__codelineno-1-1217" name="__codelineno-1-1217" href="#__codelineno-1-1217"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~definition.cloze.body~</span><span class="cp">}}</span>
<a id="__codelineno-1-1218" name="__codelineno-1-1218" href="#__codelineno-1-1218"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1219" name="__codelineno-1-1219" href="#__codelineno-1-1219"></a><span class="x">            &lt;/b&gt;</span>
<a id="__codelineno-1-1220" name="__codelineno-1-1220" href="#__codelineno-1-1220"></a>
<a id="__codelineno-1-1221" name="__codelineno-1-1221" href="#__codelineno-1-1221"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(hasMedia</span> <span class="s2">"textFurigana"</span> <span class="nv">definition.cloze.suffix)</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1222" name="__codelineno-1-1222" href="#__codelineno-1-1222"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~#getMedia</span> <span class="s2">"textFurigana"</span> <span class="nv">definition.cloze.suffix</span> <span class="na">escape</span><span class="o">=</span><span class="nv">false</span><span class="cp">}}{{</span><span class="m m-Attribute">/getMedia~</span><span class="cp">}}</span>
<a id="__codelineno-1-1223" name="__codelineno-1-1223" href="#__codelineno-1-1223"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~else~</span><span class="cp">}}</span>
<a id="__codelineno-1-1224" name="__codelineno-1-1224" href="#__codelineno-1-1224"></a><span class="x">                </span><span class="cp">{{</span><span class="m m-Attribute">~definition.cloze.suffix~</span><span class="cp">}}</span>
<a id="__codelineno-1-1225" name="__codelineno-1-1225" href="#__codelineno-1-1225"></a><span class="x">            </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1226" name="__codelineno-1-1226" href="#__codelineno-1-1226"></a>
<a id="__codelineno-1-1227" name="__codelineno-1-1227" href="#__codelineno-1-1227"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~/regexReplace~</span><span class="cp">}}</span>
<a id="__codelineno-1-1228" name="__codelineno-1-1228" href="#__codelineno-1-1228"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~/regexReplace~</span><span class="cp">}}</span>
<a id="__codelineno-1-1229" name="__codelineno-1-1229" href="#__codelineno-1-1229"></a>
<a id="__codelineno-1-1230" name="__codelineno-1-1230" href="#__codelineno-1-1230"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~/if~</span><span class="cp">}}</span>
<a id="__codelineno-1-1231" name="__codelineno-1-1231" href="#__codelineno-1-1231"></a><span class="cp">{{</span><span class="m m-Attribute">/inline</span><span class="cp">}}</span>
<a id="__codelineno-1-1232" name="__codelineno-1-1232" href="#__codelineno-1-1232"></a>
<a id="__codelineno-1-1233" name="__codelineno-1-1233" href="#__codelineno-1-1233"></a>
<a id="__codelineno-1-1234" name="__codelineno-1-1234" href="#__codelineno-1-1234"></a>
<a id="__codelineno-1-1235" name="__codelineno-1-1235" href="#__codelineno-1-1235"></a><span class="cp">{{</span><span class="m m-Attribute">#*inline</span> <span class="s2">"jpmn-filled-if-word-is-hiragana"</span><span class="cp">}}</span>
<a id="__codelineno-1-1236" name="__codelineno-1-1236" href="#__codelineno-1-1236"></a><span class="x">    </span><span class="cp">{{</span><span class="m m-Attribute">~#scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1237" name="__codelineno-1-1237" href="#__codelineno-1-1237"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"expression"</span> <span class="m">~</span><span class="cp">}}{{</span><span class="k">&gt;</span> <span class="nv">expression</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1238" name="__codelineno-1-1238" href="#__codelineno-1-1238"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"reading"</span> <span class="m">~</span><span class="cp">}}{{</span><span class="k">&gt;</span> <span class="nv">reading</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1239" name="__codelineno-1-1239" href="#__codelineno-1-1239"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#set</span> <span class="s2">"expression-hiragana"</span> <span class="m">~</span><span class="cp">}}{{</span><span class="k">&gt;</span> <span class="nv">jpmn-word-reading-hiragana</span><span class="cp">}}{{</span><span class="m m-Attribute">/set~</span><span class="cp">}}</span>
<a id="__codelineno-1-1240" name="__codelineno-1-1240" href="#__codelineno-1-1240"></a>
<a id="__codelineno-1-1241" name="__codelineno-1-1241" href="#__codelineno-1-1241"></a><span class="x">        </span><span class="cp">{{</span><span class="m m-Attribute">~#if</span> <span class="nv">(op</span> <span class="s2">"&amp;&amp;"</span> <span class="nv">(op</span> <span class="na">"==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">expression</span><span class="s2">") (get "</span><span class="nv">reading</span><span class="s2">")) (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">expression</span><span class="s2">") (get "</span><span class="nv">expression-hiragana</span><span class="s2">")))~}}</span>
<a id="__codelineno-1-1242" name="__codelineno-1-1242" href="#__codelineno-1-1242"></a><span class="s2">            1</span>
<a id="__codelineno-1-1243" name="__codelineno-1-1243" href="#__codelineno-1-1243"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-1244" name="__codelineno-1-1244" href="#__codelineno-1-1244"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-1245" name="__codelineno-1-1245" href="#__codelineno-1-1245"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-1246" name="__codelineno-1-1246" href="#__codelineno-1-1246"></a>
<a id="__codelineno-1-1247" name="__codelineno-1-1247" href="#__codelineno-1-1247"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-filled-if-word-is-not-hiragana</span><span class="s2">"}}</span>
<a id="__codelineno-1-1248" name="__codelineno-1-1248" href="#__codelineno-1-1248"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-1249" name="__codelineno-1-1249" href="#__codelineno-1-1249"></a><span class="s2">        {{~#set "</span><span class="nv">filled</span><span class="s2">" ~}}{{&gt; jpmn-filled-if-word-is-hiragana}}{{/set~}}</span>
<a id="__codelineno-1-1250" name="__codelineno-1-1250" href="#__codelineno-1-1250"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">filled</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-1251" name="__codelineno-1-1251" href="#__codelineno-1-1251"></a><span class="s2">            1</span>
<a id="__codelineno-1-1252" name="__codelineno-1-1252" href="#__codelineno-1-1252"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-1253" name="__codelineno-1-1253" href="#__codelineno-1-1253"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-1254" name="__codelineno-1-1254" href="#__codelineno-1-1254"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-1255" name="__codelineno-1-1255" href="#__codelineno-1-1255"></a>
<a id="__codelineno-1-1256" name="__codelineno-1-1256" href="#__codelineno-1-1256"></a>
<a id="__codelineno-1-1257" name="__codelineno-1-1257" href="#__codelineno-1-1257"></a>
<a id="__codelineno-1-1258" name="__codelineno-1-1258" href="#__codelineno-1-1258"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-filled-if-grammar-point</span><span class="s2">"}}</span>
<a id="__codelineno-1-1259" name="__codelineno-1-1259" href="#__codelineno-1-1259"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-1260" name="__codelineno-1-1260" href="#__codelineno-1-1260"></a><span class="s2">        {{~set "</span><span class="nv">found-grammar-dict</span><span class="s2">" false ~}}</span>
<a id="__codelineno-1-1261" name="__codelineno-1-1261" href="#__codelineno-1-1261"></a>
<a id="__codelineno-1-1262" name="__codelineno-1-1262" href="#__codelineno-1-1262"></a><span class="s2">        {{~! search for grammar dictionary ~}}</span>
<a id="__codelineno-1-1263" name="__codelineno-1-1263" href="#__codelineno-1-1263"></a><span class="s2">        {{~#each definition.definitions~}}</span>
<a id="__codelineno-1-1264" name="__codelineno-1-1264" href="#__codelineno-1-1264"></a><span class="s2">            {{~#set "</span><span class="nv">rx-match-grammar-dicts</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-1265" name="__codelineno-1-1265" href="#__codelineno-1-1265"></a><span class="s2">                {{~#regexMatch (get "</span><span class="nv">opt-grammar-override-dict-regex</span><span class="s2">") "</span><span class="nv">gu</span><span class="s2">"~}}{{this.dictionary}}{{~/regexMatch~}}</span>
<a id="__codelineno-1-1266" name="__codelineno-1-1266" href="#__codelineno-1-1266"></a><span class="s2">            {{/set~}}</span>
<a id="__codelineno-1-1267" name="__codelineno-1-1267" href="#__codelineno-1-1267"></a><span class="s2">            {{~! rx-match-grammar-dicts is not empty if a grammar dictionary was found ~}}</span>
<a id="__codelineno-1-1268" name="__codelineno-1-1268" href="#__codelineno-1-1268"></a><span class="s2">            {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-grammar-dicts</span><span class="s2">") "") ~}}</span>
<a id="__codelineno-1-1269" name="__codelineno-1-1269" href="#__codelineno-1-1269"></a><span class="s2">                {{~set "</span><span class="nv">found-grammar-dict</span><span class="s2">" true ~}}</span>
<a id="__codelineno-1-1270" name="__codelineno-1-1270" href="#__codelineno-1-1270"></a><span class="s2">            {{/if~}}</span>
<a id="__codelineno-1-1271" name="__codelineno-1-1271" href="#__codelineno-1-1271"></a><span class="s2">        {{~/each~}}</span>
<a id="__codelineno-1-1272" name="__codelineno-1-1272" href="#__codelineno-1-1272"></a>
<a id="__codelineno-1-1273" name="__codelineno-1-1273" href="#__codelineno-1-1273"></a><span class="s2">        {{~! Additional case when "</span><span class="nv">Result</span> <span class="nv">grouping</span> <span class="nv">mode</span><span class="s2">" is set to "</span><span class="nv">No</span> <span class="nv">Grouping</span><span class="s2">"~}}</span>
<a id="__codelineno-1-1274" name="__codelineno-1-1274" href="#__codelineno-1-1274"></a><span class="s2">        {{~#set "</span><span class="nv">rx-match-grammar-dicts</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-1275" name="__codelineno-1-1275" href="#__codelineno-1-1275"></a><span class="s2">            {{~#regexMatch (get "</span><span class="nv">opt-grammar-override-dict-regex</span><span class="s2">") "</span><span class="nv">gu</span><span class="s2">"~}}{{this.definition.dictionary}}{{~/regexMatch~}}</span>
<a id="__codelineno-1-1276" name="__codelineno-1-1276" href="#__codelineno-1-1276"></a><span class="s2">        {{/set~}}</span>
<a id="__codelineno-1-1277" name="__codelineno-1-1277" href="#__codelineno-1-1277"></a><span class="s2">        {{~! rx-match-grammar-dicts is not empty if a grammar dictionary was found ~}}</span>
<a id="__codelineno-1-1278" name="__codelineno-1-1278" href="#__codelineno-1-1278"></a><span class="s2">        {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-grammar-dicts</span><span class="s2">") "") ~}}</span>
<a id="__codelineno-1-1279" name="__codelineno-1-1279" href="#__codelineno-1-1279"></a><span class="s2">            {{~set "</span><span class="nv">found-grammar-dict</span><span class="s2">" true ~}}</span>
<a id="__codelineno-1-1280" name="__codelineno-1-1280" href="#__codelineno-1-1280"></a><span class="s2">        {{/if~}}</span>
<a id="__codelineno-1-1281" name="__codelineno-1-1281" href="#__codelineno-1-1281"></a>
<a id="__codelineno-1-1282" name="__codelineno-1-1282" href="#__codelineno-1-1282"></a><span class="s2">        {{~#if (get "</span><span class="nv">found-grammar-dict</span><span class="s2">") ~}}</span>
<a id="__codelineno-1-1283" name="__codelineno-1-1283" href="#__codelineno-1-1283"></a><span class="s2">            1</span>
<a id="__codelineno-1-1284" name="__codelineno-1-1284" href="#__codelineno-1-1284"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-1285" name="__codelineno-1-1285" href="#__codelineno-1-1285"></a>
<a id="__codelineno-1-1286" name="__codelineno-1-1286" href="#__codelineno-1-1286"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-1287" name="__codelineno-1-1287" href="#__codelineno-1-1287"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-1288" name="__codelineno-1-1288" href="#__codelineno-1-1288"></a>
<a id="__codelineno-1-1289" name="__codelineno-1-1289" href="#__codelineno-1-1289"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-filled-if-not-grammar-point</span><span class="s2">"}}</span>
<a id="__codelineno-1-1290" name="__codelineno-1-1290" href="#__codelineno-1-1290"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-1291" name="__codelineno-1-1291" href="#__codelineno-1-1291"></a><span class="s2">        {{~#set "</span><span class="nv">filled</span><span class="s2">" ~}}{{&gt; jpmn-filled-if-grammar-point}}{{/set~}}</span>
<a id="__codelineno-1-1292" name="__codelineno-1-1292" href="#__codelineno-1-1292"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">filled</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-1293" name="__codelineno-1-1293" href="#__codelineno-1-1293"></a><span class="s2">            1</span>
<a id="__codelineno-1-1294" name="__codelineno-1-1294" href="#__codelineno-1-1294"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-1295" name="__codelineno-1-1295" href="#__codelineno-1-1295"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-1296" name="__codelineno-1-1296" href="#__codelineno-1-1296"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-1297" name="__codelineno-1-1297" href="#__codelineno-1-1297"></a>
<a id="__codelineno-1-1298" name="__codelineno-1-1298" href="#__codelineno-1-1298"></a>
<a id="__codelineno-1-1299" name="__codelineno-1-1299" href="#__codelineno-1-1299"></a>
<a id="__codelineno-1-1300" name="__codelineno-1-1300" href="#__codelineno-1-1300"></a>
<a id="__codelineno-1-1301" name="__codelineno-1-1301" href="#__codelineno-1-1301"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-filled-if-on-mim</span><span class="s2">"}}</span>
<a id="__codelineno-1-1302" name="__codelineno-1-1302" href="#__codelineno-1-1302"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-1303" name="__codelineno-1-1303" href="#__codelineno-1-1303"></a><span class="s2">        {{~#set "</span><span class="nv">rx-match-on-mim</span><span class="s2">" ~}}</span>
<a id="__codelineno-1-1304" name="__codelineno-1-1304" href="#__codelineno-1-1304"></a><span class="s2">            {{~#regexMatch "</span><span class="nv">(</span><span class="err">,</span> <span class="err">|^</span><span class="nv">)on-mim(</span><span class="err">,</span> <span class="err">|$</span><span class="nv">)</span><span class="s2">" "</span><span class="nv">gu</span><span class="s2">"~}}{{&gt; tags }}{{~/regexMatch~}}</span>
<a id="__codelineno-1-1305" name="__codelineno-1-1305" href="#__codelineno-1-1305"></a><span class="s2">        {{/set~}}</span>
<a id="__codelineno-1-1306" name="__codelineno-1-1306" href="#__codelineno-1-1306"></a>
<a id="__codelineno-1-1307" name="__codelineno-1-1307" href="#__codelineno-1-1307"></a><span class="s2">        {{~#if (op "</span><span class="na">!=</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">rx-match-on-mim</span><span class="s2">") "") ~}}</span>
<a id="__codelineno-1-1308" name="__codelineno-1-1308" href="#__codelineno-1-1308"></a><span class="s2">            1</span>
<a id="__codelineno-1-1309" name="__codelineno-1-1309" href="#__codelineno-1-1309"></a><span class="s2">        {{/if~}}</span>
<a id="__codelineno-1-1310" name="__codelineno-1-1310" href="#__codelineno-1-1310"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-1311" name="__codelineno-1-1311" href="#__codelineno-1-1311"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-1312" name="__codelineno-1-1312" href="#__codelineno-1-1312"></a>
<a id="__codelineno-1-1313" name="__codelineno-1-1313" href="#__codelineno-1-1313"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-filled-if-not-on-mim</span><span class="s2">"}}</span>
<a id="__codelineno-1-1314" name="__codelineno-1-1314" href="#__codelineno-1-1314"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-1315" name="__codelineno-1-1315" href="#__codelineno-1-1315"></a><span class="s2">        {{~#set "</span><span class="nv">filled</span><span class="s2">" ~}}{{&gt; jpmn-filled-if-not-on-mim}}{{/set~}}</span>
<a id="__codelineno-1-1316" name="__codelineno-1-1316" href="#__codelineno-1-1316"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">filled</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-1317" name="__codelineno-1-1317" href="#__codelineno-1-1317"></a><span class="s2">            1</span>
<a id="__codelineno-1-1318" name="__codelineno-1-1318" href="#__codelineno-1-1318"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-1319" name="__codelineno-1-1319" href="#__codelineno-1-1319"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-1320" name="__codelineno-1-1320" href="#__codelineno-1-1320"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-1321" name="__codelineno-1-1321" href="#__codelineno-1-1321"></a>
<a id="__codelineno-1-1322" name="__codelineno-1-1322" href="#__codelineno-1-1322"></a>
<a id="__codelineno-1-1323" name="__codelineno-1-1323" href="#__codelineno-1-1323"></a>
<a id="__codelineno-1-1324" name="__codelineno-1-1324" href="#__codelineno-1-1324"></a>
<a id="__codelineno-1-1325" name="__codelineno-1-1325" href="#__codelineno-1-1325"></a><span class="s2">{{~! my personal settings:</span>
<a id="__codelineno-1-1326" name="__codelineno-1-1326" href="#__codelineno-1-1326"></a><span class="s2">- sentence card if grammar point</span>
<a id="__codelineno-1-1327" name="__codelineno-1-1327" href="#__codelineno-1-1327"></a><span class="s2">- otherwise, if it's on-mim, then hint card</span>
<a id="__codelineno-1-1328" name="__codelineno-1-1328" href="#__codelineno-1-1328"></a><span class="s2">- otherwise, default</span>
<a id="__codelineno-1-1329" name="__codelineno-1-1329" href="#__codelineno-1-1329"></a><span class="s2">~}}</span>
<a id="__codelineno-1-1330" name="__codelineno-1-1330" href="#__codelineno-1-1330"></a>
<a id="__codelineno-1-1331" name="__codelineno-1-1331" href="#__codelineno-1-1331"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-is-sentence-card</span><span class="s2">"}}</span>
<a id="__codelineno-1-1332" name="__codelineno-1-1332" href="#__codelineno-1-1332"></a><span class="s2">    {{~&gt; jpmn-filled-if-grammar-point ~}}</span>
<a id="__codelineno-1-1333" name="__codelineno-1-1333" href="#__codelineno-1-1333"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-1334" name="__codelineno-1-1334" href="#__codelineno-1-1334"></a>
<a id="__codelineno-1-1335" name="__codelineno-1-1335" href="#__codelineno-1-1335"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-is-hint-card</span><span class="s2">"}}</span>
<a id="__codelineno-1-1336" name="__codelineno-1-1336" href="#__codelineno-1-1336"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-1337" name="__codelineno-1-1337" href="#__codelineno-1-1337"></a><span class="s2">        {{~#set "</span><span class="nv">filled</span><span class="s2">" ~}}{{&gt; jpmn-is-sentence-card}}{{/set~}}</span>
<a id="__codelineno-1-1338" name="__codelineno-1-1338" href="#__codelineno-1-1338"></a><span class="s2">        {{~#if (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">filled</span><span class="s2">") "")~}}</span>
<a id="__codelineno-1-1339" name="__codelineno-1-1339" href="#__codelineno-1-1339"></a><span class="s2">            {{~&gt; jpmn-filled-if-on-mim ~}}</span>
<a id="__codelineno-1-1340" name="__codelineno-1-1340" href="#__codelineno-1-1340"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-1341" name="__codelineno-1-1341" href="#__codelineno-1-1341"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-1342" name="__codelineno-1-1342" href="#__codelineno-1-1342"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-1343" name="__codelineno-1-1343" href="#__codelineno-1-1343"></a>
<a id="__codelineno-1-1344" name="__codelineno-1-1344" href="#__codelineno-1-1344"></a><span class="s2">{{#*inline "</span><span class="nv">jpmn-is-click-card</span><span class="s2">"}}</span>
<a id="__codelineno-1-1345" name="__codelineno-1-1345" href="#__codelineno-1-1345"></a><span class="s2">    {{~#scope~}}</span>
<a id="__codelineno-1-1346" name="__codelineno-1-1346" href="#__codelineno-1-1346"></a><span class="s2">        {{~#set "</span><span class="nv">filled1</span><span class="s2">" ~}}{{&gt; jpmn-is-hint-card}}{{/set~}}</span>
<a id="__codelineno-1-1347" name="__codelineno-1-1347" href="#__codelineno-1-1347"></a><span class="s2">        {{~#set "</span><span class="nv">filled2</span><span class="s2">" ~}}{{&gt; jpmn-is-sentence-card}}{{/set~}}</span>
<a id="__codelineno-1-1348" name="__codelineno-1-1348" href="#__codelineno-1-1348"></a><span class="s2">        {{~#if (op "</span><span class="err">&amp;&amp;</span><span class="s2">"</span>
<a id="__codelineno-1-1349" name="__codelineno-1-1349" href="#__codelineno-1-1349"></a><span class="s2">            (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">filled1</span><span class="s2">") "")</span>
<a id="__codelineno-1-1350" name="__codelineno-1-1350" href="#__codelineno-1-1350"></a><span class="s2">            (op "</span><span class="na">==</span><span class="o">=</span><span class="s2">" (get "</span><span class="nv">filled2</span><span class="s2">") "")</span>
<a id="__codelineno-1-1351" name="__codelineno-1-1351" href="#__codelineno-1-1351"></a><span class="s2">        )~}}</span>
<a id="__codelineno-1-1352" name="__codelineno-1-1352" href="#__codelineno-1-1352"></a><span class="s2">            1</span>
<a id="__codelineno-1-1353" name="__codelineno-1-1353" href="#__codelineno-1-1353"></a><span class="s2">        {{~/if~}}</span>
<a id="__codelineno-1-1354" name="__codelineno-1-1354" href="#__codelineno-1-1354"></a><span class="s2">    {{~/scope~}}</span>
<a id="__codelineno-1-1355" name="__codelineno-1-1355" href="#__codelineno-1-1355"></a><span class="s2">{{/inline}}</span>
<a id="__codelineno-1-1356" name="__codelineno-1-1356" href="#__codelineno-1-1356"></a>
<a id="__codelineno-1-1357" name="__codelineno-1-1357" href="#__codelineno-1-1357"></a>
<a id="__codelineno-1-1358" name="__codelineno-1-1358" href="#__codelineno-1-1358"></a>
<a id="__codelineno-1-1359" name="__codelineno-1-1359" href="#__codelineno-1-1359"></a>
<a id="__codelineno-1-1360" name="__codelineno-1-1360" href="#__codelineno-1-1360"></a><span class="s2">{{~! a test to check if your dictionaries are correctly classified. ~}}</span>
<a id="__codelineno-1-1361" name="__codelineno-1-1361" href="#__codelineno-1-1361"></a><span class="s2">{{~! Only meant to be used for debugging purposes, not Anki. ~}}</span>
<a id="__codelineno-1-1362" name="__codelineno-1-1362" href="#__codelineno-1-1362"></a><span class="s2">{{~#*inline "</span><span class="nv">jpmn-test-dict-type</span><span class="err">"</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1363" name="__codelineno-1-1363" href="#__codelineno-1-1363"></a><span class="cp">{{</span><span class="m m-Attribute">~#scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1364" name="__codelineno-1-1364" href="#__codelineno-1-1364"></a><span class="cp">{{</span><span class="m m-Attribute">~#each</span> <span class="nv">definition.definitions</span><span class="m">~</span><span class="cp">}}</span>
<a id="__codelineno-1-1365" name="__codelineno-1-1365" href="#__codelineno-1-1365"></a><span class="x">「</span><span class="cp">{{</span><span class="nv">dictionary</span><span class="cp">}}</span><span class="x">」: </span><span class="cp">{{</span><span class="k">&gt;</span> <span class="nv">jpmn-get-dict-type</span> <span class="err">.</span> <span class="na">dictionaryName</span><span class="o">=</span><span class="nv">dictionary</span><span class="cp">}}</span>
<a id="__codelineno-1-1366" name="__codelineno-1-1366" href="#__codelineno-1-1366"></a><span class="cp">{{</span><span class="m m-Attribute">/each~</span><span class="cp">}}</span>
<a id="__codelineno-1-1367" name="__codelineno-1-1367" href="#__codelineno-1-1367"></a><span class="cp">{{</span><span class="m m-Attribute">~/scope~</span><span class="cp">}}</span>
<a id="__codelineno-1-1368" name="__codelineno-1-1368" href="#__codelineno-1-1368"></a><span class="cp">{{</span><span class="m m-Attribute">~/inline~</span><span class="cp">}}</span>
</code></pre></div>
</details>
</li>
</ol>
<hr>
<h2 id="make-an-example-card">Make an example card!<a class="headerlink" href="#make-an-example-card" title="Permanent link">¶</a></h2>
<p>TODO re-record with renji's texthooker, and show result card</p>
<p>At this point, you should be able to make cards with Yomichan!</p>
<details class="example">
<summary>Click here to show some example Japanese sentences.</summary>
<p class="jp-quote-text">「や、いらっしゃい。ま、毒を食らわば皿までって言うしね。あ、違うか。乗り掛かった船？」</p>
<p class="jp-quote-text">「なによぅ…甲斐甲斐しく会いに来た女に対して、最初に言うセリフがそれ？」</p>
<p class="jp-quote-text">「あの時逃げ出した私の罰…あの時の汚辱は今ここで、全部そそいでやるんだ…」</p>
<p class="jp-quote-text">「貴方なんなんです？なにか、妙に銃口慣れしていますね…若者特有の空威張りという訳でもなさそうですし…」</p>
</details>
<p><a href="../assets/setupyomichan/add_card.gif"><img alt="adding a card with Yomichan" src="../assets/setupyomichan/add_card.gif"></a></p>
<p>Obviously, just Yomichan alone doesn't fill every field.
Notably, the picture and sentence audio is missing.</p>
<p>Outside of that, there are some final settings you can adjust within the Yomichan templates
if the card doesn't look quite right.</p>
<hr>
<h2 id="yomichan-templates-options-summary">Yomichan Templates Options Summary<a class="headerlink" href="#yomichan-templates-options-summary" title="Permanent link">¶</a></h2>
<h3 id="monolingual-definition">Monolingual Definition<a class="headerlink" href="#monolingual-definition" title="Permanent link">¶</a></h3>
<p>If you want the first definition you see (the <code>PrimaryDefinition</code> field) to be monolingual,
change the following line at the top of the templates code:</p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-first-definition-type"</span> <span class="s2">"bilingual"</span> <span class="m">~</span><span class="cp">}}</span>
</code></pre></div>
to
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">"opt-first-definition-type"</span> <span class="s2">"monolingual"</span> <span class="m">~</span><span class="cp">}}</span>
</code></pre></div>
<p>Additionally, a common thing that people want to do with monolingual dictionaries is to remove the first line
of the definition, because it may contain extra info that the user does not want.
See <a href="../definitions/#hiding-the-first-line-of-a-definition">here</a>
to do exactly that.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using monolingual dictionaries, on your first few cards,
please check that your dictionaries are in the expected places.
Extra bilingual definitions should be under <code>Secondary Definition</code>,
and extra monolingual definitions should be under <code>Extra Definitions</code>.</p>
<p>If your dictionaries are ending up in the wrong sections,
then it is likely a problem with how the template code categorizes the dictionaries.
See <a href="../definitions/#dictionary-placement">here</a> for more info.</p>
</div>
<!--

IT WORKS WITH OLD JMDICT!!
THIS SECTION IS NO LONGER NECESSARY!!!

## Legacy JMdict

The newest JMdict Yomichan dictionary, informally known as "JMdict Extra",
contains many things outside of the plain definitions,
including antonyms, example sentences, and alternate forms.
This dictionary can be downloaded
[here](https://github.com/Aquafina-water-bottle/jmdict-english-yomichan).

If you are using JMdict Extra, then nothing has to be done.

However, if you are using a legacy versions of JMdict,
your definitions will export incorrectly (in a non-compact form).

??? example "Compact Legacy JMdict Option <small>(click here)</small>"
    To export legacy JMdict in compact form, change the following option:
    set the following option to `false`:


    <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">&quot;opt-jmdict-list-format&quot;</span> <span class="nv">false</span> <span class="m">~</span><span class="cp">}}</span>
</code></pre></div>




then the exported compact list will not be fully compact.
This is a [known issue](https://github.com/FooSoft/yomichan/issues/2297) with Yomichan's
default handlebars.

However, with the power of custom CSS and handlebars, the issue is fixed in this note type.
To fix it, set `opt-jmdict-list-format` to `true`, i.e.


<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="cp">{{</span><span class="m m-Attribute">~set</span> <span class="s2">&quot;opt-jmdict-list-format&quot;</span> <span class="nv">true</span> <span class="m">~</span><span class="cp">}}</span>
</code></pre></div>


-->
<hr>
<h2 id="enjoy-your-new-one-click-cards">Enjoy your new one-click cards!<a class="headerlink" href="#enjoy-your-new-one-click-cards" title="Permanent link">¶</a></h2>
<p>If you've made it this far, then congratulations!
Most fields of the cards have been automatically filled out, just from Yomichan alone!</p>
<p>This concludes the setup process for creating cards with Yomichan.</p>
<p>From here, you likely fall under one of the two categories below:</p>
<ol>
<li>
<p><strong>I'm new to sentence mining.</strong></p>
<p>If you're new to sentence mining, there are likely some things things
that you would like to set up. These include:</p>
<ol>
<li>Getting the actual text to use Yomichan on.</li>
<li>Getting the pictures and/or sentence audio from the media into the card.</li>
</ol>
<p>Head over to the <a href="../setuptextmedia/">Setup: Text &amp; Media</a> page to see exactly that.</p>
</li>
<li>
<p><strong>I already have a sentence mining workflow.</strong></p>
<p>If you have a workflow already setup,
you may have to do some minor tweaks to your current workflow
to match the new field names.
For example, the exporting sentence audio and picture fields may be different
compared to your previous card.</p>
<p>Other than that, you are completely finished with the setup process!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="../setuptextmedia/#notes-on-various-programs">Setup: Text &amp; Media (Notes on Various Programs)</a>
for specific tips on a select few programs.</p>
<p>TODO update link!</p>
</div>
</li>
</ol></div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">May 16, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "toc.follow", "header.autohide", "navigation.tabs", "navigation.sections", "content.code.annotate", "content.code.copy", "content.action.view"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  </body>
</html>