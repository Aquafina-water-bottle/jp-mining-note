
$bp-enlarge-max-width-backside: 2250px;
$bp-display-sentence-shrink: 1600px;
$bp-display-sentence-remove-newlines: 1300px;
$bp-max-width-backside: 850px;
$bp-tablet-height: 700px;
$bp-combine-picture: 620px;

$font-backup-serif:
          "Noto Serif CJK JP",
          "Noto Serif JP",
          "Noto Serif",
          "Droid Serif",
          "Roboto Slab",
          "IPAPMincho",
          "HanaMinA",
          "HanaMinB",
          serif;

$font-backup-sans:
          "Noto Sans CJK JP",
          "Noto Sans JP",
          "Noto Sans",
          "Source Han Sans JP",
          "IPAPGothic",
          "VL PGothic",
          "Koruri",
          "Hiragino Sans",
          "ヒラギノ角ゴ ProN W3",
          "Hiragino Kaku Gothic ProN",
          "メイリオ",
          "Meiryo",
          "Osaka",
          "MS PGothic"
          "Open Sans",
          "Droid Sans",
          "Ubuntu",
          "Roboto",
          sans-serif;



//$bp-adjust-play-buttons: 400px;

@use "sass:math";


// stolen from mkdocs material
@function px2rem($size, $base: 16px) {
  @if unit($size) == px {
    @if unit($base) == px {
      @return math.div($size, $base) * 1rem;
    } @else {
      @error "Invalid base: #{$base} - unit must be 'px'";
    }
  } @else {
    @error "Invalid size: #{$size} - unit must be 'px'";
  }
}


@mixin common_vars {

  --pa-brightness-reduce: 60%;
  --word-font-size: #{px2rem(80px)};
  --sentence-font-size: #{px2rem(52px)};
  --vertical-sentence-font-size: #{px2rem(35px)};
  --picture-font-size: #{px2rem(40px)}; /* font size if text is used in place of the Picture field */
  //--pa-indicator-word-font-size: #{px2rem(52px)};
  //--pa-indicator-sent-font-size: #{px2rem(45px)};

  --description-font-size: #{px2rem(20px)};
  --description-footer-font-size: #{px2rem(9px)};

  --reading-font-size: #{px2rem(55px)};
  --reading-pitch-font-size: #{px2rem(23px)};
  --reading-bold-pitch-font-size: 0.7em;
  --full-sentence-font-size: #{px2rem(28px)};

  --glossary-font-size: #{px2rem(18px)};
  --glossary-font-size--smaller: #{px2rem(15px)};

  --vertical-display-margin-top: #{px2rem(16px)};
  --vertical-display-header-height-calc: #{px2rem(40px)};

  /* TODO dynamic solution */
  --tooltip-max-width: 600px;
  --tooltip-font-size: #{px2rem(14px)};
  --tooltip-font-size--debug: #{px2rem(12px)};

  /* DO NOT CHANGE --data-* variables */
  --data-dark-mode-accent: #fffd9e;
  --data-light-mode-accent: #4660f1;

  --data-tooltip-source-hover-color: #5f5f5f;

  --data-tooltip-source-accent-color: var(--data-light-mode-accent);
  --data-tooltip-source-accent-hover-color: #6679de;
  /* DO NOT CHANGE THE ABOVE --data-* VARIABLES */

  --zoom: 1;

  --pa-overline-height-above-text: 0px;
  --pa-overline-downstep-padding: 3px;
  --pa-overline-thickness: 2px;
  --pa-overline-downstep-height: 0.4em;
  --pa-overline-downstep-left-offset: 1px;


  --dh-right-image-gap: 35px; /* is also used as a padding to the left for mobile */
  --dh-right-image-max-height: 110px; // NOTE: dynamically gotten with javascript and ignored
  --mobile-border: 0.5rem;

  /* external links */
  --external-links-icon-size: 20px;
  --external-links-icon-font-size: 14px;
  --external-links-gap: 3px;
  --external-links-max-icons-per-row: 5; /* assumes one character or one image per icon */
  --external-links-box-shadow: 1px 1px 2px;

  /* PrimaryDefinitionPicture fields */
  --primary-def-picture-gap: 5px;
  --primary-def-picture-border-radius: 3px;
  --primary-def-picture-max-width: 300px;
  --primary-def-picture-max-height: 150px;
  --primary-def-picture-scale-no-def: 1.3;

  /* footer */
  --mobile-footer-height-size: 70px; /* TODO change dynamically and remove variable */
  --footer-height: calc(var(--mobile-footer-height-size) + (2 * var(--mobile-border)));

  /* folder tab */
  --folder-tab-svg-size: 20px;
  --folder-tab-button-size: 26px;
  --folder-tab-margin-left: 10px;
  --folder-tab-width: 130px;
  --folder-tab-height: 26px;

  /* mobile-popup */
  --mobile-popup-border: 16px;

  /* other */
  --info-circle-settings-svg-size: 16px;
  --bold-font-weight: bold; /* affects full sentence and definitions */

  /* light mode specific */
  --text-color:                 black;
  --text-color--1:              hsla(0, 0%, 50%, 1);
  --text-color--2:              hsla(0, 0%, 60%, 1);
  --text-color--3:              hsla(0, 0%, 60%, 1);
  --text-color--4:              hsla(0, 0%, 83%, 1);

  --text-color-link-hover:      #4646ff;

  /* idea taken from:
   * https://github.com/Ajatt-Tools/AnkiNoteTypes/blob/main/templates/Japanese%20Mined%20Sentences%20(cyphar)/Recognition/back.html
   */
  --text-heiban:                #0a74d0; /* 平板, blue */
  --text-atamadaka:             #d74343; /* 頭高, red */
  --text-nakadaka:              #e8701b; /* 中高, orange */
  --text-odaka:                 #009e1c; /* 尾高, green */
  --text-kifuku:                #7e53c4; /* 起伏, purple */

  --text-tooltips-heiban:       var(--text-heiban);
  --text-tooltips-atamadaka:    #ff3131;
  --text-tooltips-nakadaka:     #ff974d;
  --text-tooltips-odaka:        var(--text-odaka);
  --text-tooltips-kifuku:       var(--text-kifuku);

  --accent:                     var(--data-light-mode-accent);
  --background-darken:          rgba(0, 0, 0, 0.05);
  --tooltip-behind-darken:      rgba(0, 0, 0, 0.15);
  --code-background-darken:     rgba(0, 0, 0, 0.05);
  --tooltip-background-darken:  hsla(0, 0%, 100%, 0.98);;

  --pa-overline-color:          var(--accent);
  --pa-no-pron-color:           #2b94f7;
  --pa-nasal-color:             #f12a2a;

  // previously used to have a shadow as the color didn't stand out well enough
  //--highlight-bold-shadow:      0px 0px 0.7em rgba(64, 81, 181, 0.25);
  //--highlight-bold-shadow:      initial;
  --highlight-bold-color:       var(--accent);

  --external-links-background: #FFFFFF;
  --external-links-box-shadow-color: #464646;
  --similar-words-box-shadow-color: #464646;

  --glossary-image-hover-border: 1px 1px 3px var(--text-color--1);

  --card-description-color:     var(--text-color--4);

  --info-circle-hover-color: var(--data-tooltip-source-hover-color);
  --frequencies-overflow-hover-color: var(--data-tooltip-source-hover-color);

  --info-circle-leech-color: var(--data-tooltip-source-accent-color);
  --info-circle-leech-hover-color: var(--data-tooltip-source-accent-hover-color);
  --info-circle-leech-text-color: var(--info-circle-leech-color);

  --info-circle-tag-bg-color: #eeeeee;

  --info-circle-warning-color: #ff8700;
  --info-circle-warning-hover-color: #ffb341;
  --info-circle-warning-text-color: var(--info-circle-warning-color);

  --info-circle-error-color: #f05c59;
  --info-circle-error-hover-color: #ff8381;
  --info-circle-error-text-color: var(--info-circle-error-color);

  --word-indicator-icon-color: var(--text-color--3);
  --word-indicator-icon-hover-color: var(--data-tooltip-source-hover-color);
  --word-indicator-icon-new-color: var(--accent);
  --word-indicator-icon-new-hover-color: var(--data-tooltip-source-accent-hover-color);

  --pa-indicator-sentence-color: #4cd200;
  --pa-indicator-word-color: var(--data-light-mode-accent);
  --pa-indicator-none-color: #ec3a2d;

  --hybrid-underline-color: black;

  --image-hover-brightness: 85%;
  --icon-click-brightness: 85%;

  /* font families */

  --jp-serif: notoserif, #{$font-backup-serif};
  --jp-sans: notosans, #{$font-backup-sans};
}

@mixin night_mode_vars {
  /* DO NOT CHANGE --data-* variables */
  --data-tooltip-source-hover-color: #bdbdbd;

  --data-tooltip-source-accent-color: var(--data-dark-mode-accent);
  --data-tooltip-source-accent-hover-color: #e5e386;
  /* DO NOT CHANGE THE ABOVE --data-* VARIABLES */


  --text-color:                 white;
  --text-color--1:              hsla(0, 0%, 67.5%, 1);
  --text-color--2:              hsla(0, 0%, 67.5%, 1);
  --text-color--3:              hsla(0, 0%, 50%, 1);
  --text-color--4:              hsla(0, 0%, 34.5%, 1);

  --text-color-link-hover:      #1390dd;

  --text-heiban:                #59b2ff; /* 平板, blue */
  --text-atamadaka:             #ee4b56; /* 頭高, red */
  --text-nakadaka:              #ff9b54; /* 中高, orange */
  --text-odaka:                 #67e47d; /* 尾高, green */
  --text-kifuku:                #af85f4; /* 起伏, purple */

  --text-tooltips-heiban:       var(--text-heiban);
  --text-tooltips-atamadaka:    var(--text-atamadaka);
  --text-tooltips-nakadaka:     var(--text-nakadaka);
  --text-tooltips-odaka:        var(--text-odaka);
  --text-tooltips-kifuku:       var(--text-kifuku);

  --accent:                     var(--data-dark-mode-accent);
  --background-darken:          rgba(0, 0, 0, 0.12);
  --tooltip-behind-darken:      rgba(0, 0, 0, 0.25);
  --code-background-darken:     rgba(0, 0, 0, 0.18);
  --tooltip-background-darken:  rgba(0, 0, 0, 0.9);

  --pa-overline-color:          var(--accent);
  --pa-no-pron-color:           #42a3ff;
  --pa-nasal-color:             #f12a2a;

  //--highlight-bold-shadow:      initial;
  --highlight-bold-color:       var(--accent);

  --external-links-background: none;
  --external-links-box-shadow-color: #000000;
  --similar-words-box-shadow-color: #000000;

  --glossary-image-hover-border: 1px 1px 3px black;

  --card-description-color:     var(--text-color--4);

  --info-circle-hover-color: var(--data-tooltip-source-hover-color);
  --frequencies-overflow-hover-color: var(--data-tooltip-source-hover-color);

  /* slightly different shade of yellow */
  --info-circle-leech-color: var(--data-tooltip-source-accent-color);
  --info-circle-leech-hover-color: var(--data-tooltip-source-accent-hover-color);
  --info-circle-leech-text-color: var(--info-circle-leech-color);

  --info-circle-tag-bg-color: #222222;

  --info-circle-warning-color: #ff8d0d;
  --info-circle-warning-hover-color: #f9c24e;
  --info-circle-warning-text-color: var(--info-circle-warning-hover-color);

  --info-circle-error-color: #f53b39;
  --info-circle-error-hover-color: #fe7776;
  --info-circle-error-text-color: var(--info-circle-error-hover-color);

  --word-indicator-icon-color: var(--text-color--3);
  --word-indicator-icon-hover-color: var(--data-tooltip-source-hover-color);
  --word-indicator-icon-new-color: var(--accent);
  --word-indicator-icon-new-hover-color: var(--data-tooltip-source-accent-hover-color);

  --pa-indicator-sentence-color: #62ff73;
  --pa-indicator-word-color: #34dbef;
  --pa-indicator-none-color: #ff6b66;

  --hybrid-underline-color: white;

  --image-hover-brightness: 80%;
  --icon-click-brightness: 80%;
}


@mixin common {
  /*
   * --------------------
   *  dictionary entries
   * --------------------
   */
  .dict-group__tag-list .dict-group__tag:not(:first-child)::before {
    content: ", ";
  }
  .dict-group__tag-list::before {
    content: "(";
  }
  .dict-group__tag-list::after {
    content: ") ";
  }



  /*
   * -------------------
   *  Word pitch accent
   * -------------------
   */

  /* css classes used by the plugin */
  .downstep {
    color: var(--pa-overline-color);
    position: relative;
    margin-right: var(--pa-overline-downstep-padding);
  }
  .downstep:before {
    content: "";
    width: var(--pa-overline-thickness);
    height: var(--pa-overline-downstep-height);
    background: var(--pa-overline-color);
    position: absolute;
    display: block;
    top: var(--pa-overline-height-above-text);
    left: var(--pa-overline-downstep-left-offset);
  }


  .pitchoverline {
    text-decoration: none !important;
    text-decoration-color: var(--pa-overline-color) !important;
    position: relative;
  }
  .pitchoverline:after {
    content: '';
    // the subtraction is so the two rectangles don't overlap
    // (causes a visible chagnge in brightness when bolded / opacity filter is applied)
    width: calc(100% + var(--pa-overline-downstep-padding) - var(--pa-overline-thickness));
    height: var(--pa-overline-thickness);
    background: var(--pa-overline-color);
    position: absolute;
    top: var(--pa-overline-height-above-text);
    left: 0px;
  }


  .pitchterm {
    white-space: nowrap;
  }


  .nopron {
    color: var(--pa-no-pron-color);
  }
  .nasal {
    color: var(--pa-nasal-color);
  }

  .downstep .downstep-inner {
    display: none;
  }

}


@mixin bold-pitch {

  b {
    --pa-overline-height-above-text: -1px;
    --pa-overline-downstep-padding: 2px;
    --pa-overline-thickness: 1px;
    --pa-overline-downstep-left-offset: 1px;

    font-weight: normal;
    filter: opacity(30%);
    font-size: var(--reading-bold-pitch-font-size);
  }

}


@mixin bold_highlight {
  color: var(--highlight-bold-color);
}


@function maxWidthForXIcons($n) {
  @return calc(var(--external-links-icon-size) * $n + ($n - 1) * var(--external-links-gap));
}

// stolen from discord's inspect element css
$monospace-fonts: Consolas,Andale Mono WT,Andale Mono,Lucida Console,Lucida Sans Typewriter,DejaVu Sans Mono,Bitstream Vera Sans Mono,Liberation Mono,Nimbus Mono L,Monaco,Courier New,Courier,monospace;

